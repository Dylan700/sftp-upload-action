(()=>{var e={9538:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function fulfilled(e){try{step(i.next(e))}catch(e){s(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){s(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.delete_folder=t.is_uploadable=t.parse_ignored=t.parse_uploads=t.main=void 0;const o=n(2186);const f=s(n(1953));const u=s(n(7684));const l={dot:true,matchBase:true};function parse_uploads(e){const t=e.split("\n").filter((e=>e!=""));const n=[];if(t.length===0)throw new Error("No uploads were defined, please ensure you enter destinations to upload your files!");t.forEach((e=>{const[t,i]=e.trim().split("=>");if(!t||!i)return;n.push({from:t.trim(),to:i.trim()})}));return n}t.parse_uploads=parse_uploads;function parse_ignored(e){return e.trim().split("\n").map(Function.prototype.call,String.prototype.trim).filter((e=>e!=""))}t.parse_ignored=parse_ignored;function is_uploadable(e,t){return!t.some((t=>(0,f.default)(e,t,l)))}t.is_uploadable=is_uploadable;function delete_folder(e,t){return i(this,void 0,void 0,(function*(){(0,o.debug)(`Deleting existing files for ${t}...`);try{yield e.rmdir(t,true);(0,o.debug)(`${t} has been deleted.`)}catch(e){(0,o.warning)(`Unable to delete existing files for ${t} before upload. ${e}`)}}))}t.delete_folder=delete_folder;function main(e){return i(this,void 0,void 0,(function*(){try{const t=(0,o.getInput)("server");const n=(0,o.getInput)("username");const i=(0,o.getInput)("password");const s=(0,o.getInput)("passphrase");const f=(0,o.getInput)("key");const l=+(0,o.getInput)("port");const h=(0,o.getBooleanInput)("dry-run");const p=parse_uploads((0,o.getInput)("uploads"));const g=parse_ignored((0,o.getInput)("ignore"));const _=(0,o.getBooleanInput)("delete");(0,o.debug)(`Connecting to ${t} as ${n} on port ${l}`);yield e.connect({host:t,username:n,password:i,port:l,privateKey:f,passphrase:s});const E=(0,u.default)(4);const y=[];if(_&&!h){(0,o.debug)("Deleting folders...");for(const t of p){y.push(E((()=>delete_folder(e,t.to))))}yield Promise.allSettled(y);y.splice(0,y.length)}(0,o.debug)("Preparing upload...");for(const t of p){(0,o.debug)(`Processing ${t.from} to ${t.to}`);y.push(E((()=>e.uploadDir(t.from,t.to,{filter:e=>{if(is_uploadable(e,g)){if(h){console.log(`${e} would have been uploaded`);return false}else{(0,o.debug)(`Uploading ${e}`);return true}}(0,o.debug)(`Skipping ${e}`);return false}}))))}yield Promise.allSettled(y);(0,o.debug)("Upload process complete.");yield e.end();(0,o.debug)("Session ended.")}catch(e){(0,o.setFailed)(e.message)}}))}t.main=main},7351:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){if(i===undefined)i=n;Object.defineProperty(e,i,{enumerable:true,get:function(){return t[n]}})}:function(e,t,n,i){if(i===undefined)i=n;e[i]=t[n]});var s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)if(n!=="default"&&Object.hasOwnProperty.call(e,n))i(t,e,n);s(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.issue=t.issueCommand=void 0;const f=o(n(2037));const u=n(5278);function issueCommand(e,t,n){const i=new Command(e,t,n);process.stdout.write(i.toString()+f.EOL)}t.issueCommand=issueCommand;function issue(e,t=""){issueCommand(e,{},t)}t.issue=issue;const l="::";class Command{constructor(e,t,n){if(!e){e="missing.command"}this.command=e;this.properties=t;this.message=n}toString(){let e=l+this.command;if(this.properties&&Object.keys(this.properties).length>0){e+=" ";let t=true;for(const n in this.properties){if(this.properties.hasOwnProperty(n)){const i=this.properties[n];if(i){if(t){t=false}else{e+=","}e+=`${n}=${escapeProperty(i)}`}}}}e+=`${l}${escapeData(this.message)}`;return e}}function escapeData(e){return u.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function escapeProperty(e){return u.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}},2186:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){if(i===undefined)i=n;Object.defineProperty(e,i,{enumerable:true,get:function(){return t[n]}})}:function(e,t,n,i){if(i===undefined)i=n;e[i]=t[n]});var s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)if(n!=="default"&&Object.hasOwnProperty.call(e,n))i(t,e,n);s(t,e);return t};var f=this&&this.__awaiter||function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function fulfilled(e){try{step(i.next(e))}catch(e){s(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){s(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.getIDToken=t.getState=t.saveState=t.group=t.endGroup=t.startGroup=t.info=t.notice=t.warning=t.error=t.debug=t.isDebug=t.setFailed=t.setCommandEcho=t.setOutput=t.getBooleanInput=t.getMultilineInput=t.getInput=t.addPath=t.setSecret=t.exportVariable=t.ExitCode=void 0;const u=n(7351);const l=n(717);const h=n(5278);const p=o(n(2037));const g=o(n(1017));const _=n(8041);var E;(function(e){e[e["Success"]=0]="Success";e[e["Failure"]=1]="Failure"})(E=t.ExitCode||(t.ExitCode={}));function exportVariable(e,t){const n=h.toCommandValue(t);process.env[e]=n;const i=process.env["GITHUB_ENV"]||"";if(i){return l.issueFileCommand("ENV",l.prepareKeyValueMessage(e,t))}u.issueCommand("set-env",{name:e},n)}t.exportVariable=exportVariable;function setSecret(e){u.issueCommand("add-mask",{},e)}t.setSecret=setSecret;function addPath(e){const t=process.env["GITHUB_PATH"]||"";if(t){l.issueFileCommand("PATH",e)}else{u.issueCommand("add-path",{},e)}process.env["PATH"]=`${e}${g.delimiter}${process.env["PATH"]}`}t.addPath=addPath;function getInput(e,t){const n=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!n){throw new Error(`Input required and not supplied: ${e}`)}if(t&&t.trimWhitespace===false){return n}return n.trim()}t.getInput=getInput;function getMultilineInput(e,t){const n=getInput(e,t).split("\n").filter((e=>e!==""));if(t&&t.trimWhitespace===false){return n}return n.map((e=>e.trim()))}t.getMultilineInput=getMultilineInput;function getBooleanInput(e,t){const n=["true","True","TRUE"];const i=["false","False","FALSE"];const s=getInput(e,t);if(n.includes(s))return true;if(i.includes(s))return false;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${e}\n`+`Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}t.getBooleanInput=getBooleanInput;function setOutput(e,t){const n=process.env["GITHUB_OUTPUT"]||"";if(n){return l.issueFileCommand("OUTPUT",l.prepareKeyValueMessage(e,t))}process.stdout.write(p.EOL);u.issueCommand("set-output",{name:e},h.toCommandValue(t))}t.setOutput=setOutput;function setCommandEcho(e){u.issue("echo",e?"on":"off")}t.setCommandEcho=setCommandEcho;function setFailed(e){process.exitCode=E.Failure;error(e)}t.setFailed=setFailed;function isDebug(){return process.env["RUNNER_DEBUG"]==="1"}t.isDebug=isDebug;function debug(e){u.issueCommand("debug",{},e)}t.debug=debug;function error(e,t={}){u.issueCommand("error",h.toCommandProperties(t),e instanceof Error?e.toString():e)}t.error=error;function warning(e,t={}){u.issueCommand("warning",h.toCommandProperties(t),e instanceof Error?e.toString():e)}t.warning=warning;function notice(e,t={}){u.issueCommand("notice",h.toCommandProperties(t),e instanceof Error?e.toString():e)}t.notice=notice;function info(e){process.stdout.write(e+p.EOL)}t.info=info;function startGroup(e){u.issue("group",e)}t.startGroup=startGroup;function endGroup(){u.issue("endgroup")}t.endGroup=endGroup;function group(e,t){return f(this,void 0,void 0,(function*(){startGroup(e);let n;try{n=yield t()}finally{endGroup()}return n}))}t.group=group;function saveState(e,t){const n=process.env["GITHUB_STATE"]||"";if(n){return l.issueFileCommand("STATE",l.prepareKeyValueMessage(e,t))}u.issueCommand("save-state",{name:e},h.toCommandValue(t))}t.saveState=saveState;function getState(e){return process.env[`STATE_${e}`]||""}t.getState=getState;function getIDToken(e){return f(this,void 0,void 0,(function*(){return yield _.OidcClient.getIDToken(e)}))}t.getIDToken=getIDToken;var y=n(1327);Object.defineProperty(t,"summary",{enumerable:true,get:function(){return y.summary}});var b=n(1327);Object.defineProperty(t,"markdownSummary",{enumerable:true,get:function(){return b.markdownSummary}});var w=n(2981);Object.defineProperty(t,"toPosixPath",{enumerable:true,get:function(){return w.toPosixPath}});Object.defineProperty(t,"toWin32Path",{enumerable:true,get:function(){return w.toWin32Path}});Object.defineProperty(t,"toPlatformPath",{enumerable:true,get:function(){return w.toPlatformPath}})},717:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){if(i===undefined)i=n;Object.defineProperty(e,i,{enumerable:true,get:function(){return t[n]}})}:function(e,t,n,i){if(i===undefined)i=n;e[i]=t[n]});var s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)if(n!=="default"&&Object.hasOwnProperty.call(e,n))i(t,e,n);s(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.prepareKeyValueMessage=t.issueFileCommand=void 0;const f=o(n(7147));const u=o(n(2037));const l=n(5840);const h=n(5278);function issueFileCommand(e,t){const n=process.env[`GITHUB_${e}`];if(!n){throw new Error(`Unable to find environment variable for file command ${e}`)}if(!f.existsSync(n)){throw new Error(`Missing file at path: ${n}`)}f.appendFileSync(n,`${h.toCommandValue(t)}${u.EOL}`,{encoding:"utf8"})}t.issueFileCommand=issueFileCommand;function prepareKeyValueMessage(e,t){const n=`ghadelimiter_${l.v4()}`;const i=h.toCommandValue(t);if(e.includes(n)){throw new Error(`Unexpected input: name should not contain the delimiter "${n}"`)}if(i.includes(n)){throw new Error(`Unexpected input: value should not contain the delimiter "${n}"`)}return`${e}<<${n}${u.EOL}${i}${u.EOL}${n}`}t.prepareKeyValueMessage=prepareKeyValueMessage},8041:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function fulfilled(e){try{step(i.next(e))}catch(e){s(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){s(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.OidcClient=void 0;const s=n(6255);const o=n(5526);const f=n(2186);class OidcClient{static createHttpClient(e=true,t=10){const n={allowRetries:e,maxRetries:t};return new s.HttpClient("actions/oidc-client",[new o.BearerCredentialHandler(OidcClient.getRequestToken())],n)}static getRequestToken(){const e=process.env["ACTIONS_ID_TOKEN_REQUEST_TOKEN"];if(!e){throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable")}return e}static getIDTokenUrl(){const e=process.env["ACTIONS_ID_TOKEN_REQUEST_URL"];if(!e){throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable")}return e}static getCall(e){var t;return i(this,void 0,void 0,(function*(){const n=OidcClient.createHttpClient();const i=yield n.getJson(e).catch((e=>{throw new Error(`Failed to get ID Token. \n \n        Error Code : ${e.statusCode}\n \n        Error Message: ${e.result.message}`)}));const s=(t=i.result)===null||t===void 0?void 0:t.value;if(!s){throw new Error("Response json body do not have ID Token field")}return s}))}static getIDToken(e){return i(this,void 0,void 0,(function*(){try{let t=OidcClient.getIDTokenUrl();if(e){const n=encodeURIComponent(e);t=`${t}&audience=${n}`}f.debug(`ID token url is ${t}`);const n=yield OidcClient.getCall(t);f.setSecret(n);return n}catch(e){throw new Error(`Error message: ${e.message}`)}}))}}t.OidcClient=OidcClient},2981:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){if(i===undefined)i=n;Object.defineProperty(e,i,{enumerable:true,get:function(){return t[n]}})}:function(e,t,n,i){if(i===undefined)i=n;e[i]=t[n]});var s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)if(n!=="default"&&Object.hasOwnProperty.call(e,n))i(t,e,n);s(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.toPlatformPath=t.toWin32Path=t.toPosixPath=void 0;const f=o(n(1017));function toPosixPath(e){return e.replace(/[\\]/g,"/")}t.toPosixPath=toPosixPath;function toWin32Path(e){return e.replace(/[/]/g,"\\")}t.toWin32Path=toWin32Path;function toPlatformPath(e){return e.replace(/[/\\]/g,f.sep)}t.toPlatformPath=toPlatformPath},1327:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function fulfilled(e){try{step(i.next(e))}catch(e){s(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){s(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.summary=t.markdownSummary=t.SUMMARY_DOCS_URL=t.SUMMARY_ENV_VAR=void 0;const s=n(2037);const o=n(7147);const{access:f,appendFile:u,writeFile:l}=o.promises;t.SUMMARY_ENV_VAR="GITHUB_STEP_SUMMARY";t.SUMMARY_DOCS_URL="https://docs.github.com/actions/using-workflows/workflow-commands-for-github-actions#adding-a-job-summary";class Summary{constructor(){this._buffer=""}filePath(){return i(this,void 0,void 0,(function*(){if(this._filePath){return this._filePath}const e=process.env[t.SUMMARY_ENV_VAR];if(!e){throw new Error(`Unable to find environment variable for $${t.SUMMARY_ENV_VAR}. Check if your runtime environment supports job summaries.`)}try{yield f(e,o.constants.R_OK|o.constants.W_OK)}catch(t){throw new Error(`Unable to access summary file: '${e}'. Check if the file has correct read/write permissions.`)}this._filePath=e;return this._filePath}))}wrap(e,t,n={}){const i=Object.entries(n).map((([e,t])=>` ${e}="${t}"`)).join("");if(!t){return`<${e}${i}>`}return`<${e}${i}>${t}</${e}>`}write(e){return i(this,void 0,void 0,(function*(){const t=!!(e===null||e===void 0?void 0:e.overwrite);const n=yield this.filePath();const i=t?l:u;yield i(n,this._buffer,{encoding:"utf8"});return this.emptyBuffer()}))}clear(){return i(this,void 0,void 0,(function*(){return this.emptyBuffer().write({overwrite:true})}))}stringify(){return this._buffer}isEmptyBuffer(){return this._buffer.length===0}emptyBuffer(){this._buffer="";return this}addRaw(e,t=false){this._buffer+=e;return t?this.addEOL():this}addEOL(){return this.addRaw(s.EOL)}addCodeBlock(e,t){const n=Object.assign({},t&&{lang:t});const i=this.wrap("pre",this.wrap("code",e),n);return this.addRaw(i).addEOL()}addList(e,t=false){const n=t?"ol":"ul";const i=e.map((e=>this.wrap("li",e))).join("");const s=this.wrap(n,i);return this.addRaw(s).addEOL()}addTable(e){const t=e.map((e=>{const t=e.map((e=>{if(typeof e==="string"){return this.wrap("td",e)}const{header:t,data:n,colspan:i,rowspan:s}=e;const o=t?"th":"td";const f=Object.assign(Object.assign({},i&&{colspan:i}),s&&{rowspan:s});return this.wrap(o,n,f)})).join("");return this.wrap("tr",t)})).join("");const n=this.wrap("table",t);return this.addRaw(n).addEOL()}addDetails(e,t){const n=this.wrap("details",this.wrap("summary",e)+t);return this.addRaw(n).addEOL()}addImage(e,t,n){const{width:i,height:s}=n||{};const o=Object.assign(Object.assign({},i&&{width:i}),s&&{height:s});const f=this.wrap("img",null,Object.assign({src:e,alt:t},o));return this.addRaw(f).addEOL()}addHeading(e,t){const n=`h${t}`;const i=["h1","h2","h3","h4","h5","h6"].includes(n)?n:"h1";const s=this.wrap(i,e);return this.addRaw(s).addEOL()}addSeparator(){const e=this.wrap("hr",null);return this.addRaw(e).addEOL()}addBreak(){const e=this.wrap("br",null);return this.addRaw(e).addEOL()}addQuote(e,t){const n=Object.assign({},t&&{cite:t});const i=this.wrap("blockquote",e,n);return this.addRaw(i).addEOL()}addLink(e,t){const n=this.wrap("a",e,{href:t});return this.addRaw(n).addEOL()}}const h=new Summary;t.markdownSummary=h;t.summary=h},5278:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.toCommandProperties=t.toCommandValue=void 0;function toCommandValue(e){if(e===null||e===undefined){return""}else if(typeof e==="string"||e instanceof String){return e}return JSON.stringify(e)}t.toCommandValue=toCommandValue;function toCommandProperties(e){if(!Object.keys(e).length){return{}}return{title:e.title,file:e.file,line:e.startLine,endLine:e.endLine,col:e.startColumn,endColumn:e.endColumn}}t.toCommandProperties=toCommandProperties},5526:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function fulfilled(e){try{step(i.next(e))}catch(e){s(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){s(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.PersonalAccessTokenCredentialHandler=t.BearerCredentialHandler=t.BasicCredentialHandler=void 0;class BasicCredentialHandler{constructor(e,t){this.username=e;this.password=t}prepareRequest(e){if(!e.headers){throw Error("The request has no headers")}e.headers["Authorization"]=`Basic ${Buffer.from(`${this.username}:${this.password}`).toString("base64")}`}canHandleAuthentication(){return false}handleAuthentication(){return n(this,void 0,void 0,(function*(){throw new Error("not implemented")}))}}t.BasicCredentialHandler=BasicCredentialHandler;class BearerCredentialHandler{constructor(e){this.token=e}prepareRequest(e){if(!e.headers){throw Error("The request has no headers")}e.headers["Authorization"]=`Bearer ${this.token}`}canHandleAuthentication(){return false}handleAuthentication(){return n(this,void 0,void 0,(function*(){throw new Error("not implemented")}))}}t.BearerCredentialHandler=BearerCredentialHandler;class PersonalAccessTokenCredentialHandler{constructor(e){this.token=e}prepareRequest(e){if(!e.headers){throw Error("The request has no headers")}e.headers["Authorization"]=`Basic ${Buffer.from(`PAT:${this.token}`).toString("base64")}`}canHandleAuthentication(){return false}handleAuthentication(){return n(this,void 0,void 0,(function*(){throw new Error("not implemented")}))}}t.PersonalAccessTokenCredentialHandler=PersonalAccessTokenCredentialHandler},6255:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){if(i===undefined)i=n;Object.defineProperty(e,i,{enumerable:true,get:function(){return t[n]}})}:function(e,t,n,i){if(i===undefined)i=n;e[i]=t[n]});var s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)if(n!=="default"&&Object.hasOwnProperty.call(e,n))i(t,e,n);s(t,e);return t};var f=this&&this.__awaiter||function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function fulfilled(e){try{step(i.next(e))}catch(e){s(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){s(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.HttpClient=t.isHttps=t.HttpClientResponse=t.HttpClientError=t.getProxyUrl=t.MediaTypes=t.Headers=t.HttpCodes=void 0;const u=o(n(3685));const l=o(n(5687));const h=o(n(9835));const p=o(n(4294));var g;(function(e){e[e["OK"]=200]="OK";e[e["MultipleChoices"]=300]="MultipleChoices";e[e["MovedPermanently"]=301]="MovedPermanently";e[e["ResourceMoved"]=302]="ResourceMoved";e[e["SeeOther"]=303]="SeeOther";e[e["NotModified"]=304]="NotModified";e[e["UseProxy"]=305]="UseProxy";e[e["SwitchProxy"]=306]="SwitchProxy";e[e["TemporaryRedirect"]=307]="TemporaryRedirect";e[e["PermanentRedirect"]=308]="PermanentRedirect";e[e["BadRequest"]=400]="BadRequest";e[e["Unauthorized"]=401]="Unauthorized";e[e["PaymentRequired"]=402]="PaymentRequired";e[e["Forbidden"]=403]="Forbidden";e[e["NotFound"]=404]="NotFound";e[e["MethodNotAllowed"]=405]="MethodNotAllowed";e[e["NotAcceptable"]=406]="NotAcceptable";e[e["ProxyAuthenticationRequired"]=407]="ProxyAuthenticationRequired";e[e["RequestTimeout"]=408]="RequestTimeout";e[e["Conflict"]=409]="Conflict";e[e["Gone"]=410]="Gone";e[e["TooManyRequests"]=429]="TooManyRequests";e[e["InternalServerError"]=500]="InternalServerError";e[e["NotImplemented"]=501]="NotImplemented";e[e["BadGateway"]=502]="BadGateway";e[e["ServiceUnavailable"]=503]="ServiceUnavailable";e[e["GatewayTimeout"]=504]="GatewayTimeout"})(g=t.HttpCodes||(t.HttpCodes={}));var _;(function(e){e["Accept"]="accept";e["ContentType"]="content-type"})(_=t.Headers||(t.Headers={}));var E;(function(e){e["ApplicationJson"]="application/json"})(E=t.MediaTypes||(t.MediaTypes={}));function getProxyUrl(e){const t=h.getProxyUrl(new URL(e));return t?t.href:""}t.getProxyUrl=getProxyUrl;const y=[g.MovedPermanently,g.ResourceMoved,g.SeeOther,g.TemporaryRedirect,g.PermanentRedirect];const b=[g.BadGateway,g.ServiceUnavailable,g.GatewayTimeout];const w=["OPTIONS","GET","DELETE","HEAD"];const I=10;const C=5;class HttpClientError extends Error{constructor(e,t){super(e);this.name="HttpClientError";this.statusCode=t;Object.setPrototypeOf(this,HttpClientError.prototype)}}t.HttpClientError=HttpClientError;class HttpClientResponse{constructor(e){this.message=e}readBody(){return f(this,void 0,void 0,(function*(){return new Promise((e=>f(this,void 0,void 0,(function*(){let t=Buffer.alloc(0);this.message.on("data",(e=>{t=Buffer.concat([t,e])}));this.message.on("end",(()=>{e(t.toString())}))}))))}))}}t.HttpClientResponse=HttpClientResponse;function isHttps(e){const t=new URL(e);return t.protocol==="https:"}t.isHttps=isHttps;class HttpClient{constructor(e,t,n){this._ignoreSslError=false;this._allowRedirects=true;this._allowRedirectDowngrade=false;this._maxRedirects=50;this._allowRetries=false;this._maxRetries=1;this._keepAlive=false;this._disposed=false;this.userAgent=e;this.handlers=t||[];this.requestOptions=n;if(n){if(n.ignoreSslError!=null){this._ignoreSslError=n.ignoreSslError}this._socketTimeout=n.socketTimeout;if(n.allowRedirects!=null){this._allowRedirects=n.allowRedirects}if(n.allowRedirectDowngrade!=null){this._allowRedirectDowngrade=n.allowRedirectDowngrade}if(n.maxRedirects!=null){this._maxRedirects=Math.max(n.maxRedirects,0)}if(n.keepAlive!=null){this._keepAlive=n.keepAlive}if(n.allowRetries!=null){this._allowRetries=n.allowRetries}if(n.maxRetries!=null){this._maxRetries=n.maxRetries}}}options(e,t){return f(this,void 0,void 0,(function*(){return this.request("OPTIONS",e,null,t||{})}))}get(e,t){return f(this,void 0,void 0,(function*(){return this.request("GET",e,null,t||{})}))}del(e,t){return f(this,void 0,void 0,(function*(){return this.request("DELETE",e,null,t||{})}))}post(e,t,n){return f(this,void 0,void 0,(function*(){return this.request("POST",e,t,n||{})}))}patch(e,t,n){return f(this,void 0,void 0,(function*(){return this.request("PATCH",e,t,n||{})}))}put(e,t,n){return f(this,void 0,void 0,(function*(){return this.request("PUT",e,t,n||{})}))}head(e,t){return f(this,void 0,void 0,(function*(){return this.request("HEAD",e,null,t||{})}))}sendStream(e,t,n,i){return f(this,void 0,void 0,(function*(){return this.request(e,t,n,i)}))}getJson(e,t={}){return f(this,void 0,void 0,(function*(){t[_.Accept]=this._getExistingOrDefaultHeader(t,_.Accept,E.ApplicationJson);const n=yield this.get(e,t);return this._processResponse(n,this.requestOptions)}))}postJson(e,t,n={}){return f(this,void 0,void 0,(function*(){const i=JSON.stringify(t,null,2);n[_.Accept]=this._getExistingOrDefaultHeader(n,_.Accept,E.ApplicationJson);n[_.ContentType]=this._getExistingOrDefaultHeader(n,_.ContentType,E.ApplicationJson);const s=yield this.post(e,i,n);return this._processResponse(s,this.requestOptions)}))}putJson(e,t,n={}){return f(this,void 0,void 0,(function*(){const i=JSON.stringify(t,null,2);n[_.Accept]=this._getExistingOrDefaultHeader(n,_.Accept,E.ApplicationJson);n[_.ContentType]=this._getExistingOrDefaultHeader(n,_.ContentType,E.ApplicationJson);const s=yield this.put(e,i,n);return this._processResponse(s,this.requestOptions)}))}patchJson(e,t,n={}){return f(this,void 0,void 0,(function*(){const i=JSON.stringify(t,null,2);n[_.Accept]=this._getExistingOrDefaultHeader(n,_.Accept,E.ApplicationJson);n[_.ContentType]=this._getExistingOrDefaultHeader(n,_.ContentType,E.ApplicationJson);const s=yield this.patch(e,i,n);return this._processResponse(s,this.requestOptions)}))}request(e,t,n,i){return f(this,void 0,void 0,(function*(){if(this._disposed){throw new Error("Client has already been disposed.")}const s=new URL(t);let o=this._prepareRequest(e,s,i);const f=this._allowRetries&&w.includes(e)?this._maxRetries+1:1;let u=0;let l;do{l=yield this.requestRaw(o,n);if(l&&l.message&&l.message.statusCode===g.Unauthorized){let e;for(const t of this.handlers){if(t.canHandleAuthentication(l)){e=t;break}}if(e){return e.handleAuthentication(this,o,n)}else{return l}}let t=this._maxRedirects;while(l.message.statusCode&&y.includes(l.message.statusCode)&&this._allowRedirects&&t>0){const f=l.message.headers["location"];if(!f){break}const u=new URL(f);if(s.protocol==="https:"&&s.protocol!==u.protocol&&!this._allowRedirectDowngrade){throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.")}yield l.readBody();if(u.hostname!==s.hostname){for(const e in i){if(e.toLowerCase()==="authorization"){delete i[e]}}}o=this._prepareRequest(e,u,i);l=yield this.requestRaw(o,n);t--}if(!l.message.statusCode||!b.includes(l.message.statusCode)){return l}u+=1;if(u<f){yield l.readBody();yield this._performExponentialBackoff(u)}}while(u<f);return l}))}dispose(){if(this._agent){this._agent.destroy()}this._disposed=true}requestRaw(e,t){return f(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{function callbackForResult(e,t){if(e){i(e)}else if(!t){i(new Error("Unknown error"))}else{n(t)}}this.requestRawWithCallback(e,t,callbackForResult)}))}))}requestRawWithCallback(e,t,n){if(typeof t==="string"){if(!e.options.headers){e.options.headers={}}e.options.headers["Content-Length"]=Buffer.byteLength(t,"utf8")}let i=false;function handleResult(e,t){if(!i){i=true;n(e,t)}}const s=e.httpModule.request(e.options,(e=>{const t=new HttpClientResponse(e);handleResult(undefined,t)}));let o;s.on("socket",(e=>{o=e}));s.setTimeout(this._socketTimeout||3*6e4,(()=>{if(o){o.end()}handleResult(new Error(`Request timeout: ${e.options.path}`))}));s.on("error",(function(e){handleResult(e)}));if(t&&typeof t==="string"){s.write(t,"utf8")}if(t&&typeof t!=="string"){t.on("close",(function(){s.end()}));t.pipe(s)}else{s.end()}}getAgent(e){const t=new URL(e);return this._getAgent(t)}_prepareRequest(e,t,n){const i={};i.parsedUrl=t;const s=i.parsedUrl.protocol==="https:";i.httpModule=s?l:u;const o=s?443:80;i.options={};i.options.host=i.parsedUrl.hostname;i.options.port=i.parsedUrl.port?parseInt(i.parsedUrl.port):o;i.options.path=(i.parsedUrl.pathname||"")+(i.parsedUrl.search||"");i.options.method=e;i.options.headers=this._mergeHeaders(n);if(this.userAgent!=null){i.options.headers["user-agent"]=this.userAgent}i.options.agent=this._getAgent(i.parsedUrl);if(this.handlers){for(const e of this.handlers){e.prepareRequest(i.options)}}return i}_mergeHeaders(e){if(this.requestOptions&&this.requestOptions.headers){return Object.assign({},lowercaseKeys(this.requestOptions.headers),lowercaseKeys(e||{}))}return lowercaseKeys(e||{})}_getExistingOrDefaultHeader(e,t,n){let i;if(this.requestOptions&&this.requestOptions.headers){i=lowercaseKeys(this.requestOptions.headers)[t]}return e[t]||i||n}_getAgent(e){let t;const n=h.getProxyUrl(e);const i=n&&n.hostname;if(this._keepAlive&&i){t=this._proxyAgent}if(this._keepAlive&&!i){t=this._agent}if(t){return t}const s=e.protocol==="https:";let o=100;if(this.requestOptions){o=this.requestOptions.maxSockets||u.globalAgent.maxSockets}if(n&&n.hostname){const e={maxSockets:o,keepAlive:this._keepAlive,proxy:Object.assign(Object.assign({},(n.username||n.password)&&{proxyAuth:`${n.username}:${n.password}`}),{host:n.hostname,port:n.port})};let i;const f=n.protocol==="https:";if(s){i=f?p.httpsOverHttps:p.httpsOverHttp}else{i=f?p.httpOverHttps:p.httpOverHttp}t=i(e);this._proxyAgent=t}if(this._keepAlive&&!t){const e={keepAlive:this._keepAlive,maxSockets:o};t=s?new l.Agent(e):new u.Agent(e);this._agent=t}if(!t){t=s?l.globalAgent:u.globalAgent}if(s&&this._ignoreSslError){t.options=Object.assign(t.options||{},{rejectUnauthorized:false})}return t}_performExponentialBackoff(e){return f(this,void 0,void 0,(function*(){e=Math.min(I,e);const t=C*Math.pow(2,e);return new Promise((e=>setTimeout((()=>e()),t)))}))}_processResponse(e,t){return f(this,void 0,void 0,(function*(){return new Promise(((n,i)=>f(this,void 0,void 0,(function*(){const s=e.message.statusCode||0;const o={statusCode:s,result:null,headers:{}};if(s===g.NotFound){n(o)}function dateTimeDeserializer(e,t){if(typeof t==="string"){const e=new Date(t);if(!isNaN(e.valueOf())){return e}}return t}let f;let u;try{u=yield e.readBody();if(u&&u.length>0){if(t&&t.deserializeDates){f=JSON.parse(u,dateTimeDeserializer)}else{f=JSON.parse(u)}o.result=f}o.headers=e.message.headers}catch(e){}if(s>299){let e;if(f&&f.message){e=f.message}else if(u&&u.length>0){e=u}else{e=`Failed request: (${s})`}const t=new HttpClientError(e,s);t.result=o.result;i(t)}else{n(o)}}))))}))}}t.HttpClient=HttpClient;const lowercaseKeys=e=>Object.keys(e).reduce(((t,n)=>(t[n.toLowerCase()]=e[n],t)),{})},9835:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.checkBypass=t.getProxyUrl=void 0;function getProxyUrl(e){const t=e.protocol==="https:";if(checkBypass(e)){return undefined}const n=(()=>{if(t){return process.env["https_proxy"]||process.env["HTTPS_PROXY"]}else{return process.env["http_proxy"]||process.env["HTTP_PROXY"]}})();if(n){return new URL(n)}else{return undefined}}t.getProxyUrl=getProxyUrl;function checkBypass(e){if(!e.hostname){return false}const t=process.env["no_proxy"]||process.env["NO_PROXY"]||"";if(!t){return false}let n;if(e.port){n=Number(e.port)}else if(e.protocol==="http:"){n=80}else if(e.protocol==="https:"){n=443}const i=[e.hostname.toUpperCase()];if(typeof n==="number"){i.push(`${i[0]}:${n}`)}for(const e of t.split(",").map((e=>e.trim().toUpperCase())).filter((e=>e))){if(i.some((t=>t===e))){return true}}return false}t.checkBypass=checkBypass},9348:e=>{e.exports={newInvalidAsn1Error:function(e){var t=new Error;t.name="InvalidAsn1Error";t.message=e||"";return t}}},194:(e,t,n)=>{var i=n(9348);var s=n(2473);var o=n(290);var f=n(3200);e.exports={Reader:o,Writer:f};for(var u in s){if(s.hasOwnProperty(u))e.exports[u]=s[u]}for(var l in i){if(i.hasOwnProperty(l))e.exports[l]=i[l]}},290:(e,t,n)=>{var i=n(9491);var s=n(5118).Buffer;var o=n(2473);var f=n(9348);var u=f.newInvalidAsn1Error;function Reader(e){if(!e||!s.isBuffer(e))throw new TypeError("data must be a node Buffer");this._buf=e;this._size=e.length;this._len=0;this._offset=0}Object.defineProperty(Reader.prototype,"length",{enumerable:true,get:function(){return this._len}});Object.defineProperty(Reader.prototype,"offset",{enumerable:true,get:function(){return this._offset}});Object.defineProperty(Reader.prototype,"remain",{get:function(){return this._size-this._offset}});Object.defineProperty(Reader.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}});Reader.prototype.readByte=function(e){if(this._size-this._offset<1)return null;var t=this._buf[this._offset]&255;if(!e)this._offset+=1;return t};Reader.prototype.peek=function(){return this.readByte(true)};Reader.prototype.readLength=function(e){if(e===undefined)e=this._offset;if(e>=this._size)return null;var t=this._buf[e++]&255;if(t===null)return null;if((t&128)===128){t&=127;if(t===0)throw u("Indefinite length not supported");if(t>4)throw u("encoding too long");if(this._size-e<t)return null;this._len=0;for(var n=0;n<t;n++)this._len=(this._len<<8)+(this._buf[e++]&255)}else{this._len=t}return e};Reader.prototype.readSequence=function(e){var t=this.peek();if(t===null)return null;if(e!==undefined&&e!==t)throw u("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var n=this.readLength(this._offset+1);if(n===null)return null;this._offset=n;return t};Reader.prototype.readInt=function(){return this._readTag(o.Integer)};Reader.prototype.readBoolean=function(){return this._readTag(o.Boolean)===0?false:true};Reader.prototype.readEnumeration=function(){return this._readTag(o.Enumeration)};Reader.prototype.readString=function(e,t){if(!e)e=o.OctetString;var n=this.peek();if(n===null)return null;if(n!==e)throw u("Expected 0x"+e.toString(16)+": got 0x"+n.toString(16));var i=this.readLength(this._offset+1);if(i===null)return null;if(this.length>this._size-i)return null;this._offset=i;if(this.length===0)return t?s.alloc(0):"";var f=this._buf.slice(this._offset,this._offset+this.length);this._offset+=this.length;return t?f:f.toString("utf8")};Reader.prototype.readOID=function(e){if(!e)e=o.OID;var t=this.readString(e,true);if(t===null)return null;var n=[];var i=0;for(var s=0;s<t.length;s++){var f=t[s]&255;i<<=7;i+=f&127;if((f&128)===0){n.push(i);i=0}}i=n.shift();n.unshift(i%40);n.unshift(i/40>>0);return n.join(".")};Reader.prototype._readTag=function(e){i.ok(e!==undefined);var t=this.peek();if(t===null)return null;if(t!==e)throw u("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var n=this.readLength(this._offset+1);if(n===null)return null;if(this.length>4)throw u("Integer too long: "+this.length);if(this.length>this._size-n)return null;this._offset=n;var s=this._buf[this._offset];var o=0;for(var f=0;f<this.length;f++){o<<=8;o|=this._buf[this._offset++]&255}if((s&128)===128&&f!==4)o-=1<<f*8;return o>>0};e.exports=Reader},2473:e=>{e.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}},3200:(e,t,n)=>{var i=n(9491);var s=n(5118).Buffer;var o=n(2473);var f=n(9348);var u=f.newInvalidAsn1Error;var l={size:1024,growthFactor:8};function merge(e,t){i.ok(e);i.equal(typeof e,"object");i.ok(t);i.equal(typeof t,"object");var n=Object.getOwnPropertyNames(e);n.forEach((function(n){if(t[n])return;var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i)}));return t}function Writer(e){e=merge(l,e||{});this._buf=s.alloc(e.size||1024);this._size=this._buf.length;this._offset=0;this._options=e;this._seq=[]}Object.defineProperty(Writer.prototype,"buffer",{get:function(){if(this._seq.length)throw u(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}});Writer.prototype.writeByte=function(e){if(typeof e!=="number")throw new TypeError("argument must be a Number");this._ensure(1);this._buf[this._offset++]=e};Writer.prototype.writeInt=function(e,t){if(typeof e!=="number")throw new TypeError("argument must be a Number");if(typeof t!=="number")t=o.Integer;var n=4;while(((e&4286578688)===0||(e&4286578688)===4286578688>>0)&&n>1){n--;e<<=8}if(n>4)throw u("BER ints cannot be > 0xffffffff");this._ensure(2+n);this._buf[this._offset++]=t;this._buf[this._offset++]=n;while(n-- >0){this._buf[this._offset++]=(e&4278190080)>>>24;e<<=8}};Writer.prototype.writeNull=function(){this.writeByte(o.Null);this.writeByte(0)};Writer.prototype.writeEnumeration=function(e,t){if(typeof e!=="number")throw new TypeError("argument must be a Number");if(typeof t!=="number")t=o.Enumeration;return this.writeInt(e,t)};Writer.prototype.writeBoolean=function(e,t){if(typeof e!=="boolean")throw new TypeError("argument must be a Boolean");if(typeof t!=="number")t=o.Boolean;this._ensure(3);this._buf[this._offset++]=t;this._buf[this._offset++]=1;this._buf[this._offset++]=e?255:0};Writer.prototype.writeString=function(e,t){if(typeof e!=="string")throw new TypeError("argument must be a string (was: "+typeof e+")");if(typeof t!=="number")t=o.OctetString;var n=s.byteLength(e);this.writeByte(t);this.writeLength(n);if(n){this._ensure(n);this._buf.write(e,this._offset);this._offset+=n}};Writer.prototype.writeBuffer=function(e,t){if(typeof t!=="number")throw new TypeError("tag must be a number");if(!s.isBuffer(e))throw new TypeError("argument must be a buffer");this.writeByte(t);this.writeLength(e.length);this._ensure(e.length);e.copy(this._buf,this._offset,0,e.length);this._offset+=e.length};Writer.prototype.writeStringArray=function(e){if(!e instanceof Array)throw new TypeError("argument must be an Array[String]");var t=this;e.forEach((function(e){t.writeString(e)}))};Writer.prototype.writeOID=function(e,t){if(typeof e!=="string")throw new TypeError("argument must be a string");if(typeof t!=="number")t=o.OID;if(!/^([0-9]+\.){3,}[0-9]+$/.test(e))throw new Error("argument is not a valid OID string");function encodeOctet(e,t){if(t<128){e.push(t)}else if(t<16384){e.push(t>>>7|128);e.push(t&127)}else if(t<2097152){e.push(t>>>14|128);e.push((t>>>7|128)&255);e.push(t&127)}else if(t<268435456){e.push(t>>>21|128);e.push((t>>>14|128)&255);e.push((t>>>7|128)&255);e.push(t&127)}else{e.push((t>>>28|128)&255);e.push((t>>>21|128)&255);e.push((t>>>14|128)&255);e.push((t>>>7|128)&255);e.push(t&127)}}var n=e.split(".");var i=[];i.push(parseInt(n[0],10)*40+parseInt(n[1],10));n.slice(2).forEach((function(e){encodeOctet(i,parseInt(e,10))}));var s=this;this._ensure(2+i.length);this.writeByte(t);this.writeLength(i.length);i.forEach((function(e){s.writeByte(e)}))};Writer.prototype.writeLength=function(e){if(typeof e!=="number")throw new TypeError("argument must be a Number");this._ensure(4);if(e<=127){this._buf[this._offset++]=e}else if(e<=255){this._buf[this._offset++]=129;this._buf[this._offset++]=e}else if(e<=65535){this._buf[this._offset++]=130;this._buf[this._offset++]=e>>8;this._buf[this._offset++]=e}else if(e<=16777215){this._buf[this._offset++]=131;this._buf[this._offset++]=e>>16;this._buf[this._offset++]=e>>8;this._buf[this._offset++]=e}else{throw u("Length too long (> 4 bytes)")}};Writer.prototype.startSequence=function(e){if(typeof e!=="number")e=o.Sequence|o.Constructor;this.writeByte(e);this._seq.push(this._offset);this._ensure(3);this._offset+=3};Writer.prototype.endSequence=function(){var e=this._seq.pop();var t=e+3;var n=this._offset-t;if(n<=127){this._shift(t,n,-2);this._buf[e]=n}else if(n<=255){this._shift(t,n,-1);this._buf[e]=129;this._buf[e+1]=n}else if(n<=65535){this._buf[e]=130;this._buf[e+1]=n>>8;this._buf[e+2]=n}else if(n<=16777215){this._shift(t,n,1);this._buf[e]=131;this._buf[e+1]=n>>16;this._buf[e+2]=n>>8;this._buf[e+3]=n}else{throw u("Sequence too long")}};Writer.prototype._shift=function(e,t,n){i.ok(e!==undefined);i.ok(t!==undefined);i.ok(n);this._buf.copy(this._buf,e+n,e,e+t);this._offset+=n};Writer.prototype._ensure=function(e){i.ok(e);if(this._size-this._offset<e){var t=this._size*this._options.growthFactor;if(t-this._offset<e)t+=e;var n=s.alloc(t);this._buf.copy(n,0,0,this._offset);this._buf=n;this._size=t}};e.exports=Writer},970:(e,t,n)=>{var i=n(194);e.exports={Ber:i,BerReader:i.Reader,BerWriter:i.Writer}},9417:e=>{"use strict";e.exports=balanced;function balanced(e,t,n){if(e instanceof RegExp)e=maybeMatch(e,n);if(t instanceof RegExp)t=maybeMatch(t,n);var i=range(e,t,n);return i&&{start:i[0],end:i[1],pre:n.slice(0,i[0]),body:n.slice(i[0]+e.length,i[1]),post:n.slice(i[1]+t.length)}}function maybeMatch(e,t){var n=t.match(e);return n?n[0]:null}balanced.range=range;function range(e,t,n){var i,s,o,f,u;var l=n.indexOf(e);var h=n.indexOf(t,l+1);var p=l;if(l>=0&&h>0){if(e===t){return[l,h]}i=[];o=n.length;while(p>=0&&!u){if(p==l){i.push(p);l=n.indexOf(e,p+1)}else if(i.length==1){u=[i.pop(),h]}else{s=i.pop();if(s<o){o=s;f=h}h=n.indexOf(t,p+1)}p=l<h&&l>=0?l:h}if(i.length){u=[o,f]}}return u}},5447:(e,t,n)=>{"use strict";var i=n(8729).lowlevel.crypto_hash;var s=0;var Blowfish=function(){this.S=[new Uint32Array([3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946]),new Uint32Array([1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055]),new Uint32Array([3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504]),new Uint32Array([976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462])];this.P=new Uint32Array([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731])};function F(e,t,n){return(e[0][t[n+3]]+e[1][t[n+2]]^e[2][t[n+1]])+e[3][t[n]]}Blowfish.prototype.encipher=function(e,t){if(t===undefined){t=new Uint8Array(e.buffer);if(e.byteOffset!==0)t=t.subarray(e.byteOffset)}e[0]^=this.P[0];for(var n=1;n<16;n+=2){e[1]^=F(this.S,t,0)^this.P[n];e[0]^=F(this.S,t,4)^this.P[n+1]}var i=e[0];e[0]=e[1]^this.P[17];e[1]=i};Blowfish.prototype.decipher=function(e){var t=new Uint8Array(e.buffer);if(e.byteOffset!==0)t=t.subarray(e.byteOffset);e[0]^=this.P[17];for(var n=16;n>0;n-=2){e[1]^=F(this.S,t,0)^this.P[n];e[0]^=F(this.S,t,4)^this.P[n-1]}var i=e[0];e[0]=e[1]^this.P[0];e[1]=i};function stream2word(e,t){var n,i=0;for(n=0;n<4;n++,s++){if(s>=t)s=0;i=i<<8|e[s]}return i}Blowfish.prototype.expand0state=function(e,t){var n=new Uint32Array(2),i,o;var f=new Uint8Array(n.buffer);for(i=0,s=0;i<18;i++){this.P[i]^=stream2word(e,t)}s=0;for(i=0;i<18;i+=2){this.encipher(n,f);this.P[i]=n[0];this.P[i+1]=n[1]}for(i=0;i<4;i++){for(o=0;o<256;o+=2){this.encipher(n,f);this.S[i][o]=n[0];this.S[i][o+1]=n[1]}}};Blowfish.prototype.expandstate=function(e,t,n,i){var o=new Uint32Array(2),f,u;for(f=0,s=0;f<18;f++){this.P[f]^=stream2word(n,i)}for(f=0,s=0;f<18;f+=2){o[0]^=stream2word(e,t);o[1]^=stream2word(e,t);this.encipher(o);this.P[f]=o[0];this.P[f+1]=o[1]}for(f=0;f<4;f++){for(u=0;u<256;u+=2){o[0]^=stream2word(e,t);o[1]^=stream2word(e,t);this.encipher(o);this.S[f][u]=o[0];this.S[f][u+1]=o[1]}}s=0};Blowfish.prototype.enc=function(e,t){for(var n=0;n<t;n++){this.encipher(e.subarray(n*2))}};Blowfish.prototype.dec=function(e,t){for(var n=0;n<t;n++){this.decipher(e.subarray(n*2))}};var o=8,f=32;function bcrypt_hash(e,t,n){var i=new Blowfish,s=new Uint32Array(o),f,u=new Uint8Array([79,120,121,99,104,114,111,109,97,116,105,99,66,108,111,119,102,105,115,104,83,119,97,116,68,121,110,97,109,105,116,101]);i.expandstate(t,64,e,64);for(f=0;f<64;f++){i.expand0state(t,64);i.expand0state(e,64)}for(f=0;f<o;f++)s[f]=stream2word(u,u.byteLength);for(f=0;f<64;f++)i.enc(s,s.byteLength/8);for(f=0;f<o;f++){n[4*f+3]=s[f]>>>24;n[4*f+2]=s[f]>>>16;n[4*f+1]=s[f]>>>8;n[4*f+0]=s[f]}}function bcrypt_pbkdf(e,t,n,s,o,u,l){var h=new Uint8Array(64),p=new Uint8Array(64),g=new Uint8Array(f),_=new Uint8Array(f),E=new Uint8Array(s+4),y,b,w,I,C,v,k=u;if(l<1)return-1;if(t===0||s===0||u===0||u>g.byteLength*g.byteLength||s>1<<20)return-1;I=Math.floor((u+g.byteLength-1)/g.byteLength);w=Math.floor((u+I-1)/I);for(y=0;y<s;y++)E[y]=n[y];i(h,e,t);for(v=1;u>0;v++){E[s+0]=v>>>24;E[s+1]=v>>>16;E[s+2]=v>>>8;E[s+3]=v;i(p,E,s+4);bcrypt_hash(h,p,_);for(y=g.byteLength;y--;)g[y]=_[y];for(y=1;y<l;y++){i(p,_,_.byteLength);bcrypt_hash(h,p,_);for(b=0;b<g.byteLength;b++)g[b]^=_[b]}w=Math.min(w,u);for(y=0;y<w;y++){C=y*I+(v-1);if(C>=k)break;o[C]=g[y]}u-=y}return 0}e.exports={BLOCKS:o,HASHSIZE:f,hash:bcrypt_hash,pbkdf:bcrypt_pbkdf}},3717:(e,t,n)=>{var i=n(9417);e.exports=expandTop;var s="\0SLASH"+Math.random()+"\0";var o="\0OPEN"+Math.random()+"\0";var f="\0CLOSE"+Math.random()+"\0";var u="\0COMMA"+Math.random()+"\0";var l="\0PERIOD"+Math.random()+"\0";function numeric(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function escapeBraces(e){return e.split("\\\\").join(s).split("\\{").join(o).split("\\}").join(f).split("\\,").join(u).split("\\.").join(l)}function unescapeBraces(e){return e.split(s).join("\\").split(o).join("{").split(f).join("}").split(u).join(",").split(l).join(".")}function parseCommaParts(e){if(!e)return[""];var t=[];var n=i("{","}",e);if(!n)return e.split(",");var s=n.pre;var o=n.body;var f=n.post;var u=s.split(",");u[u.length-1]+="{"+o+"}";var l=parseCommaParts(f);if(f.length){u[u.length-1]+=l.shift();u.push.apply(u,l)}t.push.apply(t,u);return t}function expandTop(e){if(!e)return[];if(e.substr(0,2)==="{}"){e="\\{\\}"+e.substr(2)}return expand(escapeBraces(e),true).map(unescapeBraces)}function embrace(e){return"{"+e+"}"}function isPadded(e){return/^-?0\d/.test(e)}function lte(e,t){return e<=t}function gte(e,t){return e>=t}function expand(e,t){var n=[];var s=i("{","}",e);if(!s)return[e];var o=s.pre;var u=s.post.length?expand(s.post,false):[""];if(/\$$/.test(s.pre)){for(var l=0;l<u.length;l++){var h=o+"{"+s.body+"}"+u[l];n.push(h)}}else{var p=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(s.body);var g=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(s.body);var _=p||g;var E=s.body.indexOf(",")>=0;if(!_&&!E){if(s.post.match(/,.*\}/)){e=s.pre+"{"+s.body+f+s.post;return expand(e)}return[e]}var y;if(_){y=s.body.split(/\.\./)}else{y=parseCommaParts(s.body);if(y.length===1){y=expand(y[0],false).map(embrace);if(y.length===1){return u.map((function(e){return s.pre+y[0]+e}))}}}var b;if(_){var w=numeric(y[0]);var I=numeric(y[1]);var C=Math.max(y[0].length,y[1].length);var v=y.length==3?Math.abs(numeric(y[2])):1;var k=lte;var R=I<w;if(R){v*=-1;k=gte}var B=y.some(isPadded);b=[];for(var T=w;k(T,I);T+=v){var O;if(g){O=String.fromCharCode(T);if(O==="\\")O=""}else{O=String(T);if(B){var P=C-O.length;if(P>0){var L=new Array(P+1).join("0");if(T<0)O="-"+L+O.slice(1);else O=L+O}}}b.push(O)}}else{b=[];for(var U=0;U<y.length;U++){b.push.apply(b,expand(y[U],false))}}for(var U=0;U<b.length;U++){for(var l=0;l<u.length;l++){var h=o+b[U]+u[l];if(!t||_||h)n.push(h)}}}return n}},3018:e=>{var t=Object.prototype.toString;var n=typeof Buffer!=="undefined"&&typeof Buffer.alloc==="function"&&typeof Buffer.allocUnsafe==="function"&&typeof Buffer.from==="function";function isArrayBuffer(e){return t.call(e).slice(8,-1)==="ArrayBuffer"}function fromArrayBuffer(e,t,i){t>>>=0;var s=e.byteLength-t;if(s<0){throw new RangeError("'offset' is out of bounds")}if(i===undefined){i=s}else{i>>>=0;if(i>s){throw new RangeError("'length' is out of bounds")}}return n?Buffer.from(e.slice(t,t+i)):new Buffer(new Uint8Array(e.slice(t,t+i)))}function fromString(e,t){if(typeof t!=="string"||t===""){t="utf8"}if(!Buffer.isEncoding(t)){throw new TypeError('"encoding" must be a valid string encoding')}return n?Buffer.from(e,t):new Buffer(e,t)}function bufferFrom(e,t,i){if(typeof e==="number"){throw new TypeError('"value" argument must not be a number')}if(isArrayBuffer(e)){return fromArrayBuffer(e,t,i)}if(typeof e==="string"){return fromString(e,t)}return n?Buffer.from(e):new Buffer(e)}e.exports=bufferFrom},5107:(e,t,n)=>{var i=n(1642).Writable;var s=n(4124);var o=n(3018);if(typeof Uint8Array==="undefined"){var f=n(5027).U2}else{var f=Uint8Array}function ConcatStream(e,t){if(!(this instanceof ConcatStream))return new ConcatStream(e,t);if(typeof e==="function"){t=e;e={}}if(!e)e={};var n=e.encoding;var s=false;if(!n){s=true}else{n=String(n).toLowerCase();if(n==="u8"||n==="uint8"){n="uint8array"}}i.call(this,{objectMode:true});this.encoding=n;this.shouldInferEncoding=s;if(t)this.on("finish",(function(){t(this.getBody())}));this.body=[]}e.exports=ConcatStream;s(ConcatStream,i);ConcatStream.prototype._write=function(e,t,n){this.body.push(e);n()};ConcatStream.prototype.inferEncoding=function(e){var t=e===undefined?this.body[0]:e;if(Buffer.isBuffer(t))return"buffer";if(typeof Uint8Array!=="undefined"&&t instanceof Uint8Array)return"uint8array";if(Array.isArray(t))return"array";if(typeof t==="string")return"string";if(Object.prototype.toString.call(t)==="[object Object]")return"object";return"buffer"};ConcatStream.prototype.getBody=function(){if(!this.encoding&&this.body.length===0)return[];if(this.shouldInferEncoding)this.encoding=this.inferEncoding();if(this.encoding==="array")return arrayConcat(this.body);if(this.encoding==="string")return stringConcat(this.body);if(this.encoding==="buffer")return bufferConcat(this.body);if(this.encoding==="uint8array")return u8Concat(this.body);return this.body};var u=Array.isArray||function(e){return Object.prototype.toString.call(e)=="[object Array]"};function isArrayish(e){return/Array\]$/.test(Object.prototype.toString.call(e))}function isBufferish(e){return typeof e==="string"||isArrayish(e)||e&&typeof e.subarray==="function"}function stringConcat(e){var t=[];var n=false;for(var i=0;i<e.length;i++){var s=e[i];if(typeof s==="string"){t.push(s)}else if(Buffer.isBuffer(s)){t.push(s)}else if(isBufferish(s)){t.push(o(s))}else{t.push(o(String(s)))}}if(Buffer.isBuffer(e[0])){t=Buffer.concat(t);t=t.toString("utf8")}else{t=t.join("")}return t}function bufferConcat(e){var t=[];for(var n=0;n<e.length;n++){var i=e[n];if(Buffer.isBuffer(i)){t.push(i)}else if(isBufferish(i)){t.push(o(i))}else{t.push(o(String(i)))}}return Buffer.concat(t)}function arrayConcat(e){var t=[];for(var n=0;n<e.length;n++){t.push.apply(t,e[n])}return t}function u8Concat(e){var t=0;for(var n=0;n<e.length;n++){if(typeof e[n]==="string"){e[n]=o(e[n])}t+=e[n].length}var i=new f(t);for(var n=0,s=0;n<e.length;n++){var u=e[n];for(var l=0;l<u.length;l++){i[s++]=u[l]}}return i}},4137:(e,t,n)=>{"use strict";const i=n(4240);e.exports=i.getCPUInfo},2997:e=>{"use strict";function assign(e,t){for(const n in t){Object.defineProperty(e,n,{value:t[n],enumerable:true,configurable:true})}return e}function createError(e,t,n){if(!e||typeof e==="string"){throw new TypeError("Please pass an Error to err-code")}if(!n){n={}}if(typeof t==="object"){n=t;t=undefined}if(t!=null){n.code=t}try{return assign(e,n)}catch(t){n.message=e.message;n.stack=e.stack;const ErrClass=function(){};ErrClass.prototype=Object.create(Object.getPrototypeOf(e));return assign(new ErrClass,n)}}e.exports=createError},4124:(e,t,n)=>{try{var i=n(3837);if(typeof i.inherits!=="function")throw"";e.exports=i.inherits}catch(t){e.exports=n(8544)}},8544:e=>{if(typeof Object.create==="function"){e.exports=function inherits(e,t){if(t){e.super_=t;e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}})}}}else{e.exports=function inherits(e,t){if(t){e.super_=t;var TempCtor=function(){};TempCtor.prototype=t.prototype;e.prototype=new TempCtor;e.prototype.constructor=e}}}},7684:(e,t,n)=>{"use strict";const i=n(5185);const pLimit=e=>{if(!((Number.isInteger(e)||e===Infinity)&&e>0)){throw new TypeError("Expected `concurrency` to be a number from 1 and up")}const t=new i;let n=0;const next=()=>{n--;if(t.size>0){t.dequeue()()}};const run=async(e,t,...i)=>{n++;const s=(async()=>e(...i))();t(s);try{await s}catch{}next()};const enqueue=(i,s,...o)=>{t.enqueue(run.bind(null,i,s,...o));(async()=>{await Promise.resolve();if(n<e&&t.size>0){t.dequeue()()}})()};const generator=(e,...t)=>new Promise((n=>{enqueue(e,n,...t)}));Object.defineProperties(generator,{activeCount:{get:()=>n},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear()}}});return generator};e.exports=pLimit},4742:(e,t,n)=>{"use strict";var i=n(2997);var s=n(4347);var o=Object.prototype.hasOwnProperty;function isRetryError(e){return e&&e.code==="EPROMISERETRY"&&o.call(e,"retried")}function promiseRetry(e,t){var n;var o;if(typeof e==="object"&&typeof t==="function"){n=t;t=e;e=n}o=s.operation(t);return new Promise((function(t,n){o.attempt((function(s){Promise.resolve().then((function(){return e((function(e){if(isRetryError(e)){e=e.retried}throw i(new Error("Retrying"),"EPROMISERETRY",{retried:e})}),s)})).then(t,(function(e){if(isRetryError(e)){e=e.retried;if(o.retry(e||new Error)){return}}n(e)}))}))}))}e.exports=promiseRetry},7214:e=>{"use strict";const t={};function createErrorType(e,n,i){if(!i){i=Error}function getMessage(e,t,i){if(typeof n==="string"){return n}else{return n(e,t,i)}}class NodeError extends i{constructor(e,t,n){super(getMessage(e,t,n))}}NodeError.prototype.name=i.name;NodeError.prototype.code=e;t[e]=NodeError}function oneOf(e,t){if(Array.isArray(e)){const n=e.length;e=e.map((e=>String(e)));if(n>2){return`one of ${t} ${e.slice(0,n-1).join(", ")}, or `+e[n-1]}else if(n===2){return`one of ${t} ${e[0]} or ${e[1]}`}else{return`of ${t} ${e[0]}`}}else{return`of ${t} ${String(e)}`}}function startsWith(e,t,n){return e.substr(!n||n<0?0:+n,t.length)===t}function endsWith(e,t,n){if(n===undefined||n>e.length){n=e.length}return e.substring(n-t.length,n)===t}function includes(e,t,n){if(typeof n!=="number"){n=0}if(n+t.length>e.length){return false}else{return e.indexOf(t,n)!==-1}}createErrorType("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError);createErrorType("ERR_INVALID_ARG_TYPE",(function(e,t,n){let i;if(typeof t==="string"&&startsWith(t,"not ")){i="must not be";t=t.replace(/^not /,"")}else{i="must be"}let s;if(endsWith(e," argument")){s=`The ${e} ${i} ${oneOf(t,"type")}`}else{const n=includes(e,".")?"property":"argument";s=`The "${e}" ${n} ${i} ${oneOf(t,"type")}`}s+=`. Received type ${typeof n}`;return s}),TypeError);createErrorType("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");createErrorType("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"}));createErrorType("ERR_STREAM_PREMATURE_CLOSE","Premature close");createErrorType("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"}));createErrorType("ERR_MULTIPLE_CALLBACK","Callback called multiple times");createErrorType("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");createErrorType("ERR_STREAM_WRITE_AFTER_END","write after end");createErrorType("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);createErrorType("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError);createErrorType("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");e.exports.q=t},1359:(e,t,n)=>{"use strict";var i=Object.keys||function(e){var t=[];for(var n in e){t.push(n)}return t};e.exports=Duplex;var s=n(1433);var o=n(6993);n(4124)(Duplex,s);{var f=i(o.prototype);for(var u=0;u<f.length;u++){var l=f[u];if(!Duplex.prototype[l])Duplex.prototype[l]=o.prototype[l]}}function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);s.call(this,e);o.call(this,e);this.allowHalfOpen=true;if(e){if(e.readable===false)this.readable=false;if(e.writable===false)this.writable=false;if(e.allowHalfOpen===false){this.allowHalfOpen=false;this.once("end",onend)}}}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:false,get:function get(){return this._writableState.highWaterMark}});Object.defineProperty(Duplex.prototype,"writableBuffer",{enumerable:false,get:function get(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(Duplex.prototype,"writableLength",{enumerable:false,get:function get(){return this._writableState.length}});function onend(){if(this._writableState.ended)return;process.nextTick(onEndNT,this)}function onEndNT(e){e.end()}Object.defineProperty(Duplex.prototype,"destroyed",{enumerable:false,get:function get(){if(this._readableState===undefined||this._writableState===undefined){return false}return this._readableState.destroyed&&this._writableState.destroyed},set:function set(e){if(this._readableState===undefined||this._writableState===undefined){return}this._readableState.destroyed=e;this._writableState.destroyed=e}})},1542:(e,t,n)=>{"use strict";e.exports=PassThrough;var i=n(4415);n(4124)(PassThrough,i);function PassThrough(e){if(!(this instanceof PassThrough))return new PassThrough(e);i.call(this,e)}PassThrough.prototype._transform=function(e,t,n){n(null,e)}},1433:(e,t,n)=>{"use strict";e.exports=Readable;var i;Readable.ReadableState=ReadableState;var s=n(2361).EventEmitter;var o=function EElistenerCount(e,t){return e.listeners(t).length};var f=n(2387);var u=n(4300).Buffer;var l=global.Uint8Array||function(){};function _uint8ArrayToBuffer(e){return u.from(e)}function _isUint8Array(e){return u.isBuffer(e)||e instanceof l}var h=n(3837);var p;if(h&&h.debuglog){p=h.debuglog("stream")}else{p=function debug(){}}var g=n(6522);var _=n(7049);var E=n(9948),y=E.getHighWaterMark;var b=n(7214).q,w=b.ERR_INVALID_ARG_TYPE,I=b.ERR_STREAM_PUSH_AFTER_EOF,C=b.ERR_METHOD_NOT_IMPLEMENTED,v=b.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;var k;var R;var B;n(4124)(Readable,f);var T=_.errorOrDestroy;var O=["error","close","destroy","pause","resume"];function prependListener(e,t,n){if(typeof e.prependListener==="function")return e.prependListener(t,n);if(!e._events||!e._events[t])e.on(t,n);else if(Array.isArray(e._events[t]))e._events[t].unshift(n);else e._events[t]=[n,e._events[t]]}function ReadableState(e,t,s){i=i||n(1359);e=e||{};if(typeof s!=="boolean")s=t instanceof i;this.objectMode=!!e.objectMode;if(s)this.objectMode=this.objectMode||!!e.readableObjectMode;this.highWaterMark=y(this,e,"readableHighWaterMark",s);this.buffer=new g;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.paused=true;this.emitClose=e.emitClose!==false;this.autoDestroy=!!e.autoDestroy;this.destroyed=false;this.defaultEncoding=e.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(e.encoding){if(!k)k=n(4841).s;this.decoder=new k(e.encoding);this.encoding=e.encoding}}function Readable(e){i=i||n(1359);if(!(this instanceof Readable))return new Readable(e);var t=this instanceof i;this._readableState=new ReadableState(e,this,t);this.readable=true;if(e){if(typeof e.read==="function")this._read=e.read;if(typeof e.destroy==="function")this._destroy=e.destroy}f.call(this)}Object.defineProperty(Readable.prototype,"destroyed",{enumerable:false,get:function get(){if(this._readableState===undefined){return false}return this._readableState.destroyed},set:function set(e){if(!this._readableState){return}this._readableState.destroyed=e}});Readable.prototype.destroy=_.destroy;Readable.prototype._undestroy=_.undestroy;Readable.prototype._destroy=function(e,t){t(e)};Readable.prototype.push=function(e,t){var n=this._readableState;var i;if(!n.objectMode){if(typeof e==="string"){t=t||n.defaultEncoding;if(t!==n.encoding){e=u.from(e,t);t=""}i=true}}else{i=true}return readableAddChunk(this,e,t,false,i)};Readable.prototype.unshift=function(e){return readableAddChunk(this,e,null,true,false)};function readableAddChunk(e,t,n,i,s){p("readableAddChunk",t);var o=e._readableState;if(t===null){o.reading=false;onEofChunk(e,o)}else{var f;if(!s)f=chunkInvalid(o,t);if(f){T(e,f)}else if(o.objectMode||t&&t.length>0){if(typeof t!=="string"&&!o.objectMode&&Object.getPrototypeOf(t)!==u.prototype){t=_uint8ArrayToBuffer(t)}if(i){if(o.endEmitted)T(e,new v);else addChunk(e,o,t,true)}else if(o.ended){T(e,new I)}else if(o.destroyed){return false}else{o.reading=false;if(o.decoder&&!n){t=o.decoder.write(t);if(o.objectMode||t.length!==0)addChunk(e,o,t,false);else maybeReadMore(e,o)}else{addChunk(e,o,t,false)}}}else if(!i){o.reading=false;maybeReadMore(e,o)}}return!o.ended&&(o.length<o.highWaterMark||o.length===0)}function addChunk(e,t,n,i){if(t.flowing&&t.length===0&&!t.sync){t.awaitDrain=0;e.emit("data",n)}else{t.length+=t.objectMode?1:n.length;if(i)t.buffer.unshift(n);else t.buffer.push(n);if(t.needReadable)emitReadable(e)}maybeReadMore(e,t)}function chunkInvalid(e,t){var n;if(!_isUint8Array(t)&&typeof t!=="string"&&t!==undefined&&!e.objectMode){n=new w("chunk",["string","Buffer","Uint8Array"],t)}return n}Readable.prototype.isPaused=function(){return this._readableState.flowing===false};Readable.prototype.setEncoding=function(e){if(!k)k=n(4841).s;var t=new k(e);this._readableState.decoder=t;this._readableState.encoding=this._readableState.decoder.encoding;var i=this._readableState.buffer.head;var s="";while(i!==null){s+=t.write(i.data);i=i.next}this._readableState.buffer.clear();if(s!=="")this._readableState.buffer.push(s);this._readableState.length=s.length;return this};var P=1073741824;function computeNewHighWaterMark(e){if(e>=P){e=P}else{e--;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;e++}return e}function howMuchToRead(e,t){if(e<=0||t.length===0&&t.ended)return 0;if(t.objectMode)return 1;if(e!==e){if(t.flowing&&t.length)return t.buffer.head.data.length;else return t.length}if(e>t.highWaterMark)t.highWaterMark=computeNewHighWaterMark(e);if(e<=t.length)return e;if(!t.ended){t.needReadable=true;return 0}return t.length}Readable.prototype.read=function(e){p("read",e);e=parseInt(e,10);var t=this._readableState;var n=e;if(e!==0)t.emittedReadable=false;if(e===0&&t.needReadable&&((t.highWaterMark!==0?t.length>=t.highWaterMark:t.length>0)||t.ended)){p("read: emitReadable",t.length,t.ended);if(t.length===0&&t.ended)endReadable(this);else emitReadable(this);return null}e=howMuchToRead(e,t);if(e===0&&t.ended){if(t.length===0)endReadable(this);return null}var i=t.needReadable;p("need readable",i);if(t.length===0||t.length-e<t.highWaterMark){i=true;p("length less than watermark",i)}if(t.ended||t.reading){i=false;p("reading or ended",i)}else if(i){p("do read");t.reading=true;t.sync=true;if(t.length===0)t.needReadable=true;this._read(t.highWaterMark);t.sync=false;if(!t.reading)e=howMuchToRead(n,t)}var s;if(e>0)s=fromList(e,t);else s=null;if(s===null){t.needReadable=t.length<=t.highWaterMark;e=0}else{t.length-=e;t.awaitDrain=0}if(t.length===0){if(!t.ended)t.needReadable=true;if(n!==e&&t.ended)endReadable(this)}if(s!==null)this.emit("data",s);return s};function onEofChunk(e,t){p("onEofChunk");if(t.ended)return;if(t.decoder){var n=t.decoder.end();if(n&&n.length){t.buffer.push(n);t.length+=t.objectMode?1:n.length}}t.ended=true;if(t.sync){emitReadable(e)}else{t.needReadable=false;if(!t.emittedReadable){t.emittedReadable=true;emitReadable_(e)}}}function emitReadable(e){var t=e._readableState;p("emitReadable",t.needReadable,t.emittedReadable);t.needReadable=false;if(!t.emittedReadable){p("emitReadable",t.flowing);t.emittedReadable=true;process.nextTick(emitReadable_,e)}}function emitReadable_(e){var t=e._readableState;p("emitReadable_",t.destroyed,t.length,t.ended);if(!t.destroyed&&(t.length||t.ended)){e.emit("readable");t.emittedReadable=false}t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark;flow(e)}function maybeReadMore(e,t){if(!t.readingMore){t.readingMore=true;process.nextTick(maybeReadMore_,e,t)}}function maybeReadMore_(e,t){while(!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&t.length===0)){var n=t.length;p("maybeReadMore read 0");e.read(0);if(n===t.length)break}t.readingMore=false}Readable.prototype._read=function(e){T(this,new C("_read()"))};Readable.prototype.pipe=function(e,t){var n=this;var i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e);break}i.pipesCount+=1;p("pipe count=%d opts=%j",i.pipesCount,t);var s=(!t||t.end!==false)&&e!==process.stdout&&e!==process.stderr;var f=s?onend:unpipe;if(i.endEmitted)process.nextTick(f);else n.once("end",f);e.on("unpipe",onunpipe);function onunpipe(e,t){p("onunpipe");if(e===n){if(t&&t.hasUnpiped===false){t.hasUnpiped=true;cleanup()}}}function onend(){p("onend");e.end()}var u=pipeOnDrain(n);e.on("drain",u);var l=false;function cleanup(){p("cleanup");e.removeListener("close",onclose);e.removeListener("finish",onfinish);e.removeListener("drain",u);e.removeListener("error",onerror);e.removeListener("unpipe",onunpipe);n.removeListener("end",onend);n.removeListener("end",unpipe);n.removeListener("data",ondata);l=true;if(i.awaitDrain&&(!e._writableState||e._writableState.needDrain))u()}n.on("data",ondata);function ondata(t){p("ondata");var s=e.write(t);p("dest.write",s);if(s===false){if((i.pipesCount===1&&i.pipes===e||i.pipesCount>1&&indexOf(i.pipes,e)!==-1)&&!l){p("false write response, pause",i.awaitDrain);i.awaitDrain++}n.pause()}}function onerror(t){p("onerror",t);unpipe();e.removeListener("error",onerror);if(o(e,"error")===0)T(e,t)}prependListener(e,"error",onerror);function onclose(){e.removeListener("finish",onfinish);unpipe()}e.once("close",onclose);function onfinish(){p("onfinish");e.removeListener("close",onclose);unpipe()}e.once("finish",onfinish);function unpipe(){p("unpipe");n.unpipe(e)}e.emit("pipe",n);if(!i.flowing){p("pipe resume");n.resume()}return e};function pipeOnDrain(e){return function pipeOnDrainFunctionResult(){var t=e._readableState;p("pipeOnDrain",t.awaitDrain);if(t.awaitDrain)t.awaitDrain--;if(t.awaitDrain===0&&o(e,"data")){t.flowing=true;flow(e)}}}Readable.prototype.unpipe=function(e){var t=this._readableState;var n={hasUnpiped:false};if(t.pipesCount===0)return this;if(t.pipesCount===1){if(e&&e!==t.pipes)return this;if(!e)e=t.pipes;t.pipes=null;t.pipesCount=0;t.flowing=false;if(e)e.emit("unpipe",this,n);return this}if(!e){var i=t.pipes;var s=t.pipesCount;t.pipes=null;t.pipesCount=0;t.flowing=false;for(var o=0;o<s;o++){i[o].emit("unpipe",this,{hasUnpiped:false})}return this}var f=indexOf(t.pipes,e);if(f===-1)return this;t.pipes.splice(f,1);t.pipesCount-=1;if(t.pipesCount===1)t.pipes=t.pipes[0];e.emit("unpipe",this,n);return this};Readable.prototype.on=function(e,t){var n=f.prototype.on.call(this,e,t);var i=this._readableState;if(e==="data"){i.readableListening=this.listenerCount("readable")>0;if(i.flowing!==false)this.resume()}else if(e==="readable"){if(!i.endEmitted&&!i.readableListening){i.readableListening=i.needReadable=true;i.flowing=false;i.emittedReadable=false;p("on readable",i.length,i.reading);if(i.length){emitReadable(this)}else if(!i.reading){process.nextTick(nReadingNextTick,this)}}}return n};Readable.prototype.addListener=Readable.prototype.on;Readable.prototype.removeListener=function(e,t){var n=f.prototype.removeListener.call(this,e,t);if(e==="readable"){process.nextTick(updateReadableListening,this)}return n};Readable.prototype.removeAllListeners=function(e){var t=f.prototype.removeAllListeners.apply(this,arguments);if(e==="readable"||e===undefined){process.nextTick(updateReadableListening,this)}return t};function updateReadableListening(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0;if(t.resumeScheduled&&!t.paused){t.flowing=true}else if(e.listenerCount("data")>0){e.resume()}}function nReadingNextTick(e){p("readable nexttick read 0");e.read(0)}Readable.prototype.resume=function(){var e=this._readableState;if(!e.flowing){p("resume");e.flowing=!e.readableListening;resume(this,e)}e.paused=false;return this};function resume(e,t){if(!t.resumeScheduled){t.resumeScheduled=true;process.nextTick(resume_,e,t)}}function resume_(e,t){p("resume",t.reading);if(!t.reading){e.read(0)}t.resumeScheduled=false;e.emit("resume");flow(e);if(t.flowing&&!t.reading)e.read(0)}Readable.prototype.pause=function(){p("call pause flowing=%j",this._readableState.flowing);if(this._readableState.flowing!==false){p("pause");this._readableState.flowing=false;this.emit("pause")}this._readableState.paused=true;return this};function flow(e){var t=e._readableState;p("flow",t.flowing);while(t.flowing&&e.read()!==null){}}Readable.prototype.wrap=function(e){var t=this;var n=this._readableState;var i=false;e.on("end",(function(){p("wrapped end");if(n.decoder&&!n.ended){var e=n.decoder.end();if(e&&e.length)t.push(e)}t.push(null)}));e.on("data",(function(s){p("wrapped data");if(n.decoder)s=n.decoder.write(s);if(n.objectMode&&(s===null||s===undefined))return;else if(!n.objectMode&&(!s||!s.length))return;var o=t.push(s);if(!o){i=true;e.pause()}}));for(var s in e){if(this[s]===undefined&&typeof e[s]==="function"){this[s]=function methodWrap(t){return function methodWrapReturnFunction(){return e[t].apply(e,arguments)}}(s)}}for(var o=0;o<O.length;o++){e.on(O[o],this.emit.bind(this,O[o]))}this._read=function(t){p("wrapped _read",t);if(i){i=false;e.resume()}};return this};if(typeof Symbol==="function"){Readable.prototype[Symbol.asyncIterator]=function(){if(R===undefined){R=n(3306)}return R(this)}}Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:false,get:function get(){return this._readableState.highWaterMark}});Object.defineProperty(Readable.prototype,"readableBuffer",{enumerable:false,get:function get(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Readable.prototype,"readableFlowing",{enumerable:false,get:function get(){return this._readableState.flowing},set:function set(e){if(this._readableState){this._readableState.flowing=e}}});Readable._fromList=fromList;Object.defineProperty(Readable.prototype,"readableLength",{enumerable:false,get:function get(){return this._readableState.length}});function fromList(e,t){if(t.length===0)return null;var n;if(t.objectMode)n=t.buffer.shift();else if(!e||e>=t.length){if(t.decoder)n=t.buffer.join("");else if(t.buffer.length===1)n=t.buffer.first();else n=t.buffer.concat(t.length);t.buffer.clear()}else{n=t.buffer.consume(e,t.decoder)}return n}function endReadable(e){var t=e._readableState;p("endReadable",t.endEmitted);if(!t.endEmitted){t.ended=true;process.nextTick(endReadableNT,t,e)}}function endReadableNT(e,t){p("endReadableNT",e.endEmitted,e.length);if(!e.endEmitted&&e.length===0){e.endEmitted=true;t.readable=false;t.emit("end");if(e.autoDestroy){var n=t._writableState;if(!n||n.autoDestroy&&n.finished){t.destroy()}}}}if(typeof Symbol==="function"){Readable.from=function(e,t){if(B===undefined){B=n(9082)}return B(Readable,e,t)}}function indexOf(e,t){for(var n=0,i=e.length;n<i;n++){if(e[n]===t)return n}return-1}},4415:(e,t,n)=>{"use strict";e.exports=Transform;var i=n(7214).q,s=i.ERR_METHOD_NOT_IMPLEMENTED,o=i.ERR_MULTIPLE_CALLBACK,f=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,u=i.ERR_TRANSFORM_WITH_LENGTH_0;var l=n(1359);n(4124)(Transform,l);function afterTransform(e,t){var n=this._transformState;n.transforming=false;var i=n.writecb;if(i===null){return this.emit("error",new o)}n.writechunk=null;n.writecb=null;if(t!=null)this.push(t);i(e);var s=this._readableState;s.reading=false;if(s.needReadable||s.length<s.highWaterMark){this._read(s.highWaterMark)}}function Transform(e){if(!(this instanceof Transform))return new Transform(e);l.call(this,e);this._transformState={afterTransform:afterTransform.bind(this),needTransform:false,transforming:false,writecb:null,writechunk:null,writeencoding:null};this._readableState.needReadable=true;this._readableState.sync=false;if(e){if(typeof e.transform==="function")this._transform=e.transform;if(typeof e.flush==="function")this._flush=e.flush}this.on("prefinish",prefinish)}function prefinish(){var e=this;if(typeof this._flush==="function"&&!this._readableState.destroyed){this._flush((function(t,n){done(e,t,n)}))}else{done(this,null,null)}}Transform.prototype.push=function(e,t){this._transformState.needTransform=false;return l.prototype.push.call(this,e,t)};Transform.prototype._transform=function(e,t,n){n(new s("_transform()"))};Transform.prototype._write=function(e,t,n){var i=this._transformState;i.writecb=n;i.writechunk=e;i.writeencoding=t;if(!i.transforming){var s=this._readableState;if(i.needTransform||s.needReadable||s.length<s.highWaterMark)this._read(s.highWaterMark)}};Transform.prototype._read=function(e){var t=this._transformState;if(t.writechunk!==null&&!t.transforming){t.transforming=true;this._transform(t.writechunk,t.writeencoding,t.afterTransform)}else{t.needTransform=true}};Transform.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))};function done(e,t,n){if(t)return e.emit("error",t);if(n!=null)e.push(n);if(e._writableState.length)throw new u;if(e._transformState.transforming)throw new f;return e.push(null)}},6993:(e,t,n)=>{"use strict";e.exports=Writable;function WriteReq(e,t,n){this.chunk=e;this.encoding=t;this.callback=n;this.next=null}function CorkedRequest(e){var t=this;this.next=null;this.entry=null;this.finish=function(){onCorkedFinish(t,e)}}var i;Writable.WritableState=WritableState;var s={deprecate:n(7127)};var o=n(2387);var f=n(4300).Buffer;var u=global.Uint8Array||function(){};function _uint8ArrayToBuffer(e){return f.from(e)}function _isUint8Array(e){return f.isBuffer(e)||e instanceof u}var l=n(7049);var h=n(9948),p=h.getHighWaterMark;var g=n(7214).q,_=g.ERR_INVALID_ARG_TYPE,E=g.ERR_METHOD_NOT_IMPLEMENTED,y=g.ERR_MULTIPLE_CALLBACK,b=g.ERR_STREAM_CANNOT_PIPE,w=g.ERR_STREAM_DESTROYED,I=g.ERR_STREAM_NULL_VALUES,C=g.ERR_STREAM_WRITE_AFTER_END,v=g.ERR_UNKNOWN_ENCODING;var k=l.errorOrDestroy;n(4124)(Writable,o);function nop(){}function WritableState(e,t,s){i=i||n(1359);e=e||{};if(typeof s!=="boolean")s=t instanceof i;this.objectMode=!!e.objectMode;if(s)this.objectMode=this.objectMode||!!e.writableObjectMode;this.highWaterMark=p(this,e,"writableHighWaterMark",s);this.finalCalled=false;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;this.destroyed=false;var o=e.decodeStrings===false;this.decodeStrings=!o;this.defaultEncoding=e.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(e){onwrite(t,e)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.emitClose=e.emitClose!==false;this.autoDestroy=!!e.autoDestroy;this.bufferedRequestCount=0;this.corkedRequestsFree=new CorkedRequest(this)}WritableState.prototype.getBuffer=function getBuffer(){var e=this.bufferedRequest;var t=[];while(e){t.push(e);e=e.next}return t};(function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:s.deprecate((function writableStateBufferGetter(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}})();var R;if(typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"){R=Function.prototype[Symbol.hasInstance];Object.defineProperty(Writable,Symbol.hasInstance,{value:function value(e){if(R.call(this,e))return true;if(this!==Writable)return false;return e&&e._writableState instanceof WritableState}})}else{R=function realHasInstance(e){return e instanceof this}}function Writable(e){i=i||n(1359);var t=this instanceof i;if(!t&&!R.call(Writable,this))return new Writable(e);this._writableState=new WritableState(e,this,t);this.writable=true;if(e){if(typeof e.write==="function")this._write=e.write;if(typeof e.writev==="function")this._writev=e.writev;if(typeof e.destroy==="function")this._destroy=e.destroy;if(typeof e.final==="function")this._final=e.final}o.call(this)}Writable.prototype.pipe=function(){k(this,new b)};function writeAfterEnd(e,t){var n=new C;k(e,n);process.nextTick(t,n)}function validChunk(e,t,n,i){var s;if(n===null){s=new I}else if(typeof n!=="string"&&!t.objectMode){s=new _("chunk",["string","Buffer"],n)}if(s){k(e,s);process.nextTick(i,s);return false}return true}Writable.prototype.write=function(e,t,n){var i=this._writableState;var s=false;var o=!i.objectMode&&_isUint8Array(e);if(o&&!f.isBuffer(e)){e=_uint8ArrayToBuffer(e)}if(typeof t==="function"){n=t;t=null}if(o)t="buffer";else if(!t)t=i.defaultEncoding;if(typeof n!=="function")n=nop;if(i.ending)writeAfterEnd(this,n);else if(o||validChunk(this,i,e,n)){i.pendingcb++;s=writeOrBuffer(this,i,o,e,t,n)}return s};Writable.prototype.cork=function(){this._writableState.corked++};Writable.prototype.uncork=function(){var e=this._writableState;if(e.corked){e.corked--;if(!e.writing&&!e.corked&&!e.bufferProcessing&&e.bufferedRequest)clearBuffer(this,e)}};Writable.prototype.setDefaultEncoding=function setDefaultEncoding(e){if(typeof e==="string")e=e.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new v(e);this._writableState.defaultEncoding=e;return this};Object.defineProperty(Writable.prototype,"writableBuffer",{enumerable:false,get:function get(){return this._writableState&&this._writableState.getBuffer()}});function decodeChunk(e,t,n){if(!e.objectMode&&e.decodeStrings!==false&&typeof t==="string"){t=f.from(t,n)}return t}Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:false,get:function get(){return this._writableState.highWaterMark}});function writeOrBuffer(e,t,n,i,s,o){if(!n){var f=decodeChunk(t,i,s);if(i!==f){n=true;s="buffer";i=f}}var u=t.objectMode?1:i.length;t.length+=u;var l=t.length<t.highWaterMark;if(!l)t.needDrain=true;if(t.writing||t.corked){var h=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:s,isBuf:n,callback:o,next:null};if(h){h.next=t.lastBufferedRequest}else{t.bufferedRequest=t.lastBufferedRequest}t.bufferedRequestCount+=1}else{doWrite(e,t,false,u,i,s,o)}return l}function doWrite(e,t,n,i,s,o,f){t.writelen=i;t.writecb=f;t.writing=true;t.sync=true;if(t.destroyed)t.onwrite(new w("write"));else if(n)e._writev(s,t.onwrite);else e._write(s,o,t.onwrite);t.sync=false}function onwriteError(e,t,n,i,s){--t.pendingcb;if(n){process.nextTick(s,i);process.nextTick(finishMaybe,e,t);e._writableState.errorEmitted=true;k(e,i)}else{s(i);e._writableState.errorEmitted=true;k(e,i);finishMaybe(e,t)}}function onwriteStateUpdate(e){e.writing=false;e.writecb=null;e.length-=e.writelen;e.writelen=0}function onwrite(e,t){var n=e._writableState;var i=n.sync;var s=n.writecb;if(typeof s!=="function")throw new y;onwriteStateUpdate(n);if(t)onwriteError(e,n,i,t,s);else{var o=needFinish(n)||e.destroyed;if(!o&&!n.corked&&!n.bufferProcessing&&n.bufferedRequest){clearBuffer(e,n)}if(i){process.nextTick(afterWrite,e,n,o,s)}else{afterWrite(e,n,o,s)}}}function afterWrite(e,t,n,i){if(!n)onwriteDrain(e,t);t.pendingcb--;i();finishMaybe(e,t)}function onwriteDrain(e,t){if(t.length===0&&t.needDrain){t.needDrain=false;e.emit("drain")}}function clearBuffer(e,t){t.bufferProcessing=true;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount;var s=new Array(i);var o=t.corkedRequestsFree;o.entry=n;var f=0;var u=true;while(n){s[f]=n;if(!n.isBuf)u=false;n=n.next;f+=1}s.allBuffers=u;doWrite(e,t,true,t.length,s,"",o.finish);t.pendingcb++;t.lastBufferedRequest=null;if(o.next){t.corkedRequestsFree=o.next;o.next=null}else{t.corkedRequestsFree=new CorkedRequest(t)}t.bufferedRequestCount=0}else{while(n){var l=n.chunk;var h=n.encoding;var p=n.callback;var g=t.objectMode?1:l.length;doWrite(e,t,false,g,l,h,p);n=n.next;t.bufferedRequestCount--;if(t.writing){break}}if(n===null)t.lastBufferedRequest=null}t.bufferedRequest=n;t.bufferProcessing=false}Writable.prototype._write=function(e,t,n){n(new E("_write()"))};Writable.prototype._writev=null;Writable.prototype.end=function(e,t,n){var i=this._writableState;if(typeof e==="function"){n=e;e=null;t=null}else if(typeof t==="function"){n=t;t=null}if(e!==null&&e!==undefined)this.write(e,t);if(i.corked){i.corked=1;this.uncork()}if(!i.ending)endWritable(this,i,n);return this};Object.defineProperty(Writable.prototype,"writableLength",{enumerable:false,get:function get(){return this._writableState.length}});function needFinish(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function callFinal(e,t){e._final((function(n){t.pendingcb--;if(n){k(e,n)}t.prefinished=true;e.emit("prefinish");finishMaybe(e,t)}))}function prefinish(e,t){if(!t.prefinished&&!t.finalCalled){if(typeof e._final==="function"&&!t.destroyed){t.pendingcb++;t.finalCalled=true;process.nextTick(callFinal,e,t)}else{t.prefinished=true;e.emit("prefinish")}}}function finishMaybe(e,t){var n=needFinish(t);if(n){prefinish(e,t);if(t.pendingcb===0){t.finished=true;e.emit("finish");if(t.autoDestroy){var i=e._readableState;if(!i||i.autoDestroy&&i.endEmitted){e.destroy()}}}}return n}function endWritable(e,t,n){t.ending=true;finishMaybe(e,t);if(n){if(t.finished)process.nextTick(n);else e.once("finish",n)}t.ended=true;e.writable=false}function onCorkedFinish(e,t,n){var i=e.entry;e.entry=null;while(i){var s=i.callback;t.pendingcb--;s(n);i=i.next}t.corkedRequestsFree.next=e}Object.defineProperty(Writable.prototype,"destroyed",{enumerable:false,get:function get(){if(this._writableState===undefined){return false}return this._writableState.destroyed},set:function set(e){if(!this._writableState){return}this._writableState.destroyed=e}});Writable.prototype.destroy=l.destroy;Writable.prototype._undestroy=l.undestroy;Writable.prototype._destroy=function(e,t){t(e)}},3306:(e,t,n)=>{"use strict";var i;function _defineProperty(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}var s=n(6080);var o=Symbol("lastResolve");var f=Symbol("lastReject");var u=Symbol("error");var l=Symbol("ended");var h=Symbol("lastPromise");var p=Symbol("handlePromise");var g=Symbol("stream");function createIterResult(e,t){return{value:e,done:t}}function readAndResolve(e){var t=e[o];if(t!==null){var n=e[g].read();if(n!==null){e[h]=null;e[o]=null;e[f]=null;t(createIterResult(n,false))}}}function onReadable(e){process.nextTick(readAndResolve,e)}function wrapForNext(e,t){return function(n,i){e.then((function(){if(t[l]){n(createIterResult(undefined,true));return}t[p](n,i)}),i)}}var _=Object.getPrototypeOf((function(){}));var E=Object.setPrototypeOf((i={get stream(){return this[g]},next:function next(){var e=this;var t=this[u];if(t!==null){return Promise.reject(t)}if(this[l]){return Promise.resolve(createIterResult(undefined,true))}if(this[g].destroyed){return new Promise((function(t,n){process.nextTick((function(){if(e[u]){n(e[u])}else{t(createIterResult(undefined,true))}}))}))}var n=this[h];var i;if(n){i=new Promise(wrapForNext(n,this))}else{var s=this[g].read();if(s!==null){return Promise.resolve(createIterResult(s,false))}i=new Promise(this[p])}this[h]=i;return i}},_defineProperty(i,Symbol.asyncIterator,(function(){return this})),_defineProperty(i,"return",(function _return(){var e=this;return new Promise((function(t,n){e[g].destroy(null,(function(e){if(e){n(e);return}t(createIterResult(undefined,true))}))}))})),i),_);var y=function createReadableStreamAsyncIterator(e){var t;var n=Object.create(E,(t={},_defineProperty(t,g,{value:e,writable:true}),_defineProperty(t,o,{value:null,writable:true}),_defineProperty(t,f,{value:null,writable:true}),_defineProperty(t,u,{value:null,writable:true}),_defineProperty(t,l,{value:e._readableState.endEmitted,writable:true}),_defineProperty(t,p,{value:function value(e,t){var i=n[g].read();if(i){n[h]=null;n[o]=null;n[f]=null;e(createIterResult(i,false))}else{n[o]=e;n[f]=t}},writable:true}),t));n[h]=null;s(e,(function(e){if(e&&e.code!=="ERR_STREAM_PREMATURE_CLOSE"){var t=n[f];if(t!==null){n[h]=null;n[o]=null;n[f]=null;t(e)}n[u]=e;return}var i=n[o];if(i!==null){n[h]=null;n[o]=null;n[f]=null;i(createIterResult(undefined,true))}n[l]=true}));e.on("readable",onReadable.bind(null,n));return n};e.exports=y},6522:(e,t,n)=>{"use strict";function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);if(t)i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}));n.push.apply(n,i)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};if(t%2){ownKeys(Object(n),true).forEach((function(t){_defineProperty(e,t,n[t])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(n))}else{ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}}return e}function _defineProperty(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){if(t)_defineProperties(e.prototype,t);if(n)_defineProperties(e,n);return e}var i=n(4300),s=i.Buffer;var o=n(3837),f=o.inspect;var u=f&&f.custom||"inspect";function copyBuffer(e,t,n){s.prototype.copy.call(e,t,n)}e.exports=function(){function BufferList(){_classCallCheck(this,BufferList);this.head=null;this.tail=null;this.length=0}_createClass(BufferList,[{key:"push",value:function push(e){var t={data:e,next:null};if(this.length>0)this.tail.next=t;else this.head=t;this.tail=t;++this.length}},{key:"unshift",value:function unshift(e){var t={data:e,next:this.head};if(this.length===0)this.tail=t;this.head=t;++this.length}},{key:"shift",value:function shift(){if(this.length===0)return;var e=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return e}},{key:"clear",value:function clear(){this.head=this.tail=null;this.length=0}},{key:"join",value:function join(e){if(this.length===0)return"";var t=this.head;var n=""+t.data;while(t=t.next){n+=e+t.data}return n}},{key:"concat",value:function concat(e){if(this.length===0)return s.alloc(0);var t=s.allocUnsafe(e>>>0);var n=this.head;var i=0;while(n){copyBuffer(n.data,t,i);i+=n.data.length;n=n.next}return t}},{key:"consume",value:function consume(e,t){var n;if(e<this.head.data.length){n=this.head.data.slice(0,e);this.head.data=this.head.data.slice(e)}else if(e===this.head.data.length){n=this.shift()}else{n=t?this._getString(e):this._getBuffer(e)}return n}},{key:"first",value:function first(){return this.head.data}},{key:"_getString",value:function _getString(e){var t=this.head;var n=1;var i=t.data;e-=i.length;while(t=t.next){var s=t.data;var o=e>s.length?s.length:e;if(o===s.length)i+=s;else i+=s.slice(0,e);e-=o;if(e===0){if(o===s.length){++n;if(t.next)this.head=t.next;else this.head=this.tail=null}else{this.head=t;t.data=s.slice(o)}break}++n}this.length-=n;return i}},{key:"_getBuffer",value:function _getBuffer(e){var t=s.allocUnsafe(e);var n=this.head;var i=1;n.data.copy(t);e-=n.data.length;while(n=n.next){var o=n.data;var f=e>o.length?o.length:e;o.copy(t,t.length-e,0,f);e-=f;if(e===0){if(f===o.length){++i;if(n.next)this.head=n.next;else this.head=this.tail=null}else{this.head=n;n.data=o.slice(f)}break}++i}this.length-=i;return t}},{key:u,value:function value(e,t){return f(this,_objectSpread({},t,{depth:0,customInspect:false}))}}]);return BufferList}()},7049:e=>{"use strict";function destroy(e,t){var n=this;var i=this._readableState&&this._readableState.destroyed;var s=this._writableState&&this._writableState.destroyed;if(i||s){if(t){t(e)}else if(e){if(!this._writableState){process.nextTick(emitErrorNT,this,e)}else if(!this._writableState.errorEmitted){this._writableState.errorEmitted=true;process.nextTick(emitErrorNT,this,e)}}return this}if(this._readableState){this._readableState.destroyed=true}if(this._writableState){this._writableState.destroyed=true}this._destroy(e||null,(function(e){if(!t&&e){if(!n._writableState){process.nextTick(emitErrorAndCloseNT,n,e)}else if(!n._writableState.errorEmitted){n._writableState.errorEmitted=true;process.nextTick(emitErrorAndCloseNT,n,e)}else{process.nextTick(emitCloseNT,n)}}else if(t){process.nextTick(emitCloseNT,n);t(e)}else{process.nextTick(emitCloseNT,n)}}));return this}function emitErrorAndCloseNT(e,t){emitErrorNT(e,t);emitCloseNT(e)}function emitCloseNT(e){if(e._writableState&&!e._writableState.emitClose)return;if(e._readableState&&!e._readableState.emitClose)return;e.emit("close")}function undestroy(){if(this._readableState){this._readableState.destroyed=false;this._readableState.reading=false;this._readableState.ended=false;this._readableState.endEmitted=false}if(this._writableState){this._writableState.destroyed=false;this._writableState.ended=false;this._writableState.ending=false;this._writableState.finalCalled=false;this._writableState.prefinished=false;this._writableState.finished=false;this._writableState.errorEmitted=false}}function emitErrorNT(e,t){e.emit("error",t)}function errorOrDestroy(e,t){var n=e._readableState;var i=e._writableState;if(n&&n.autoDestroy||i&&i.autoDestroy)e.destroy(t);else e.emit("error",t)}e.exports={destroy:destroy,undestroy:undestroy,errorOrDestroy:errorOrDestroy}},6080:(e,t,n)=>{"use strict";var i=n(7214).q.ERR_STREAM_PREMATURE_CLOSE;function once(e){var t=false;return function(){if(t)return;t=true;for(var n=arguments.length,i=new Array(n),s=0;s<n;s++){i[s]=arguments[s]}e.apply(this,i)}}function noop(){}function isRequest(e){return e.setHeader&&typeof e.abort==="function"}function eos(e,t,n){if(typeof t==="function")return eos(e,null,t);if(!t)t={};n=once(n||noop);var s=t.readable||t.readable!==false&&e.readable;var o=t.writable||t.writable!==false&&e.writable;var f=function onlegacyfinish(){if(!e.writable)l()};var u=e._writableState&&e._writableState.finished;var l=function onfinish(){o=false;u=true;if(!s)n.call(e)};var h=e._readableState&&e._readableState.endEmitted;var p=function onend(){s=false;h=true;if(!o)n.call(e)};var g=function onerror(t){n.call(e,t)};var _=function onclose(){var t;if(s&&!h){if(!e._readableState||!e._readableState.ended)t=new i;return n.call(e,t)}if(o&&!u){if(!e._writableState||!e._writableState.ended)t=new i;return n.call(e,t)}};var E=function onrequest(){e.req.on("finish",l)};if(isRequest(e)){e.on("complete",l);e.on("abort",_);if(e.req)E();else e.on("request",E)}else if(o&&!e._writableState){e.on("end",f);e.on("close",f)}e.on("end",p);e.on("finish",l);if(t.error!==false)e.on("error",g);e.on("close",_);return function(){e.removeListener("complete",l);e.removeListener("abort",_);e.removeListener("request",E);if(e.req)e.req.removeListener("finish",l);e.removeListener("end",f);e.removeListener("close",f);e.removeListener("finish",l);e.removeListener("end",p);e.removeListener("error",g);e.removeListener("close",_)}}e.exports=eos},9082:(e,t,n)=>{"use strict";function asyncGeneratorStep(e,t,n,i,s,o,f){try{var u=e[o](f);var l=u.value}catch(e){n(e);return}if(u.done){t(l)}else{Promise.resolve(l).then(i,s)}}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(i,s){var o=e.apply(t,n);function _next(e){asyncGeneratorStep(o,i,s,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(o,i,s,_next,_throw,"throw",e)}_next(undefined)}))}}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);if(t)i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}));n.push.apply(n,i)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};if(t%2){ownKeys(Object(n),true).forEach((function(t){_defineProperty(e,t,n[t])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(n))}else{ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}}return e}function _defineProperty(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}var i=n(7214).q.ERR_INVALID_ARG_TYPE;function from(e,t,n){var s;if(t&&typeof t.next==="function"){s=t}else if(t&&t[Symbol.asyncIterator])s=t[Symbol.asyncIterator]();else if(t&&t[Symbol.iterator])s=t[Symbol.iterator]();else throw new i("iterable",["Iterable"],t);var o=new e(_objectSpread({objectMode:true},n));var f=false;o._read=function(){if(!f){f=true;next()}};function next(){return _next2.apply(this,arguments)}function _next2(){_next2=_asyncToGenerator((function*(){try{var e=yield s.next(),t=e.value,n=e.done;if(n){o.push(null)}else if(o.push(yield t)){next()}else{f=false}}catch(e){o.destroy(e)}}));return _next2.apply(this,arguments)}return o}e.exports=from},6989:(e,t,n)=>{"use strict";var i;function once(e){var t=false;return function(){if(t)return;t=true;e.apply(void 0,arguments)}}var s=n(7214).q,o=s.ERR_MISSING_ARGS,f=s.ERR_STREAM_DESTROYED;function noop(e){if(e)throw e}function isRequest(e){return e.setHeader&&typeof e.abort==="function"}function destroyer(e,t,s,o){o=once(o);var u=false;e.on("close",(function(){u=true}));if(i===undefined)i=n(6080);i(e,{readable:t,writable:s},(function(e){if(e)return o(e);u=true;o()}));var l=false;return function(t){if(u)return;if(l)return;l=true;if(isRequest(e))return e.abort();if(typeof e.destroy==="function")return e.destroy();o(t||new f("pipe"))}}function call(e){e()}function pipe(e,t){return e.pipe(t)}function popCallback(e){if(!e.length)return noop;if(typeof e[e.length-1]!=="function")return noop;return e.pop()}function pipeline(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++){t[n]=arguments[n]}var i=popCallback(t);if(Array.isArray(t[0]))t=t[0];if(t.length<2){throw new o("streams")}var s;var f=t.map((function(e,n){var o=n<t.length-1;var u=n>0;return destroyer(e,o,u,(function(e){if(!s)s=e;if(e)f.forEach(call);if(o)return;f.forEach(call);i(s)}))}));return t.reduce(pipe)}e.exports=pipeline},9948:(e,t,n)=>{"use strict";var i=n(7214).q.ERR_INVALID_OPT_VALUE;function highWaterMarkFrom(e,t,n){return e.highWaterMark!=null?e.highWaterMark:t?e[n]:null}function getHighWaterMark(e,t,n,s){var o=highWaterMarkFrom(t,s,n);if(o!=null){if(!(isFinite(o)&&Math.floor(o)===o)||o<0){var f=s?n:"highWaterMark";throw new i(f,o)}return Math.floor(o)}return e.objectMode?16:16*1024}e.exports={getHighWaterMark:getHighWaterMark}},2387:(e,t,n)=>{e.exports=n(2781)},1642:(e,t,n)=>{var i=n(2781);if(process.env.READABLE_STREAM==="disable"&&i){e.exports=i.Readable;Object.assign(e.exports,i);e.exports.Stream=i}else{t=e.exports=n(1433);t.Stream=i||t;t.Readable=t;t.Writable=n(6993);t.Duplex=n(1359);t.Transform=n(4415);t.PassThrough=n(1542);t.finished=n(6080);t.pipeline=n(6989)}},4347:(e,t,n)=>{e.exports=n(6244)},6244:(e,t,n)=>{var i=n(5369);t.operation=function(e){var n=t.timeouts(e);return new i(n,{forever:e&&e.forever,unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})};t.timeouts=function(e){if(e instanceof Array){return[].concat(e)}var t={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:Infinity,randomize:false};for(var n in e){t[n]=e[n]}if(t.minTimeout>t.maxTimeout){throw new Error("minTimeout is greater than maxTimeout")}var i=[];for(var s=0;s<t.retries;s++){i.push(this.createTimeout(s,t))}if(e&&e.forever&&!i.length){i.push(this.createTimeout(s,t))}i.sort((function(e,t){return e-t}));return i};t.createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1;var i=Math.round(n*t.minTimeout*Math.pow(t.factor,e));i=Math.min(i,t.maxTimeout);return i};t.wrap=function(e,n,i){if(n instanceof Array){i=n;n=null}if(!i){i=[];for(var s in e){if(typeof e[s]==="function"){i.push(s)}}}for(var o=0;o<i.length;o++){var f=i[o];var u=e[f];e[f]=function retryWrapper(i){var s=t.operation(n);var o=Array.prototype.slice.call(arguments,1);var f=o.pop();o.push((function(e){if(s.retry(e)){return}if(e){arguments[0]=s.mainError()}f.apply(this,arguments)}));s.attempt((function(){i.apply(e,o)}))}.bind(e,u);e[f].options=n}}},5369:e=>{function RetryOperation(e,t){if(typeof t==="boolean"){t={forever:t}}this._originalTimeouts=JSON.parse(JSON.stringify(e));this._timeouts=e;this._options=t||{};this._maxRetryTime=t&&t.maxRetryTime||Infinity;this._fn=null;this._errors=[];this._attempts=1;this._operationTimeout=null;this._operationTimeoutCb=null;this._timeout=null;this._operationStart=null;if(this._options.forever){this._cachedTimeouts=this._timeouts.slice(0)}}e.exports=RetryOperation;RetryOperation.prototype.reset=function(){this._attempts=1;this._timeouts=this._originalTimeouts};RetryOperation.prototype.stop=function(){if(this._timeout){clearTimeout(this._timeout)}this._timeouts=[];this._cachedTimeouts=null};RetryOperation.prototype.retry=function(e){if(this._timeout){clearTimeout(this._timeout)}if(!e){return false}var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime){this._errors.unshift(new Error("RetryOperation timeout occurred"));return false}this._errors.push(e);var n=this._timeouts.shift();if(n===undefined){if(this._cachedTimeouts){this._errors.splice(this._errors.length-1,this._errors.length);this._timeouts=this._cachedTimeouts.slice(0);n=this._timeouts.shift()}else{return false}}var i=this;var s=setTimeout((function(){i._attempts++;if(i._operationTimeoutCb){i._timeout=setTimeout((function(){i._operationTimeoutCb(i._attempts)}),i._operationTimeout);if(i._options.unref){i._timeout.unref()}}i._fn(i._attempts)}),n);if(this._options.unref){s.unref()}return true};RetryOperation.prototype.attempt=function(e,t){this._fn=e;if(t){if(t.timeout){this._operationTimeout=t.timeout}if(t.cb){this._operationTimeoutCb=t.cb}}var n=this;if(this._operationTimeoutCb){this._timeout=setTimeout((function(){n._operationTimeoutCb()}),n._operationTimeout)}this._operationStart=(new Date).getTime();this._fn(this._attempts)};RetryOperation.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated");this.attempt(e)};RetryOperation.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated");this.attempt(e)};RetryOperation.prototype.start=RetryOperation.prototype.try;RetryOperation.prototype.errors=function(){return this._errors};RetryOperation.prototype.attempts=function(){return this._attempts};RetryOperation.prototype.mainError=function(){if(this._errors.length===0){return null}var e={};var t=null;var n=0;for(var i=0;i<this._errors.length;i++){var s=this._errors[i];var o=s.message;var f=(e[o]||0)+1;e[o]=f;if(f>=n){t=s;n=f}}return t}},1867:(e,t,n)=>{
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var i=n(4300);var s=i.Buffer;function copyProps(e,t){for(var n in e){t[n]=e[n]}}if(s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow){e.exports=i}else{copyProps(i,t);t.Buffer=SafeBuffer}function SafeBuffer(e,t,n){return s(e,t,n)}SafeBuffer.prototype=Object.create(s.prototype);copyProps(s,SafeBuffer);SafeBuffer.from=function(e,t,n){if(typeof e==="number"){throw new TypeError("Argument must not be a number")}return s(e,t,n)};SafeBuffer.alloc=function(e,t,n){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}var i=s(e);if(t!==undefined){if(typeof n==="string"){i.fill(t,n)}else{i.fill(t)}}else{i.fill(0)}return i};SafeBuffer.allocUnsafe=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return s(e)};SafeBuffer.allocUnsafeSlow=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return i.SlowBuffer(e)}},5118:(e,t,n)=>{"use strict";var i=n(4300);var s=i.Buffer;var o={};var f;for(f in i){if(!i.hasOwnProperty(f))continue;if(f==="SlowBuffer"||f==="Buffer")continue;o[f]=i[f]}var u=o.Buffer={};for(f in s){if(!s.hasOwnProperty(f))continue;if(f==="allocUnsafe"||f==="allocUnsafeSlow")continue;u[f]=s[f]}o.Buffer.prototype=s.prototype;if(!u.from||u.from===Uint8Array.from){u.from=function(e,t,n){if(typeof e==="number"){throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e)}if(e&&typeof e.length==="undefined"){throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}return s(e,t,n)}}if(!u.alloc){u.alloc=function(e,t,n){if(typeof e!=="number"){throw new TypeError('The "size" argument must be of type number. Received type '+typeof e)}if(e<0||e>=2*(1<<30)){throw new RangeError('The value "'+e+'" is invalid for option "size"')}var i=s(e);if(!t||t.length===0){i.fill(0)}else if(typeof n==="string"){i.fill(t,n)}else{i.fill(t)}return i}}if(!o.kStringMaxLength){try{o.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(e){}}if(!o.constants){o.constants={MAX_LENGTH:o.kMaxLength};if(o.kStringMaxLength){o.constants.MAX_STRING_LENGTH=o.kStringMaxLength}}e.exports=o},3232:e=>{const t={generic:"ERR_GENERIC_CLIENT",connect:"ERR_NOT_CONNECTED",badPath:"ERR_BAD_PATH",permission:"EACCES",notexist:"ENOENT",notdir:"ENOTDIR",badAuth:"ERR_BAD_AUTH"};const n={writeFile:1,readFile:2,writeDir:3,readDir:4,readObj:5,writeObj:6};e.exports={errorCode:t,targetType:n}},7551:(e,t,n)=>{"use strict";const{Client:i}=n(5869);const s=n(7147);const o=n(5107);const f=n(4742);const{join:u,parse:l}=n(1017);const{addTempListeners:h,removeTempListeners:p,haveConnection:g,normalizeRemotePath:_,localExists:E,haveLocalAccess:y,haveLocalCreate:b}=n(9432);const{errorCode:w}=n(3232);class SftpClient{constructor(e){this.version="9.0.4";this.client=new i;this.sftp=undefined;this.clientName=e?e:"sftp";this.endCalled=false;this.errorHandled=false;this.closeHandled=false;this.endHandled=false;this.remotePathSep="/";this.remotePlatform="unix";this.debug=undefined;this.client.on("close",(()=>{if(this.endCalled||this.errorHandled||this.closeHandled){this.debugMsg("Global: Ignoring handled close event")}else{this.debugMsg("Global: Handling unexpected close event");this.sftp=undefined}}));this.client.on("end",(()=>{if(this.endCalled||this.errorHandled||this.endHandled){this.debugMsg("Global: Ignoring hanlded end event")}else{this.debugMsg("Global: Handling unexpected end event");this.sftp=undefined}}));this.client.on("error",(e=>{if(this.endCalled||this.errorHandled){this.debugMsg(`Global: Ignoring handled error: ${e.message}`)}else{this.debugMsg(`Global; Handling unexpected error; ${e.message}`);this.sftp=undefined;console.log(`ssh2-sftp-client: Unexpected error: ${e.message}. Error code: ${e.code}`)}}))}debugMsg(e,t){if(this.debug){if(t){this.debug(`CLIENT[${this.clientName}]: ${e} ${JSON.stringify(t,null," ")}`)}else{this.debug(`CLIENT[${this.clientName}]: ${e}`)}}}fmtError(e,t="sftp",n,i){let s="";let o="";const f=i?` after ${i} ${i>1?"attempts":"attempt"}`:"";if(e===undefined){s=`${t}: Undefined error - probably a bug!`;o=w.generic}else if(typeof e==="string"){s=`${t}: ${e}${f}`;o=n?n:w.generic}else if(e.custom){s=`${t}->${e.message}${f}`;o=e.code}else{switch(e.code){case"ENOTFOUND":s=`${t}: Address lookup failed for host${f}`;break;case"ECONNREFUSED":s=`${t}: Remote host refused connection${f}`;break;case"ECONNRESET":s=`${t}: Remote host has reset the connection: ${e.message}${f}`;break;default:s=`${t}: ${e.message}${f}`}o=e.code?e.code:w.generic}const u=new Error(s);u.code=o;u.custom=true;this.debugMsg(`${u.message} (${u.code})`);return u}on(e,t){this.client.prependListener(e,t)}removeListener(e,t){this.client.removeListener(e,t)}_resetEventFlags(){this.closeHandled=false;this.endHandled=false;this.errorHandled=false}getConnection(e){let t,n;return new Promise(((i,s)=>{n=h(this,"getConnection",s);t=()=>{this.debugMsg("getConnection ready listener: got connection - promise resolved");i(true)};this.on("ready",t);try{this.client.connect(e)}catch(e){this.debugMsg(`getConnection: ${e.message}`);s(e)}})).finally((()=>{this.removeListener("ready",t);p(this,n,"getConnection")}))}getSftpChannel(){return new Promise(((e,t)=>{this.client.sftp(((n,i)=>{if(n){t(this.fmtError(n,"getSftpChannel",n.code))}else{this.debugMsg("getSftpChannel: SFTP channel established");this.sftp=i;e(i)}}))}))}async connect(e){let t;try{t=h(this,"connect");if(e.debug){this.debug=e.debug;this.debugMsg("connect: Debugging turned on");this.debugMsg(`ssh2-sftp-client Version: ${this.version} `,process.versions)}if(this.sftp){throw this.fmtError("An existing SFTP connection is already defined","connect",w.connect)}const n={retries:e.retries??1,factor:e.factor??2,minTimeout:e.retry_minTimeout??25e3};await f(n,(async(t,n)=>{try{this.debugMsg(`connect: Connect attempt ${n}`);await this.getConnection(e)}catch(e){switch(e.code){case"ENOTFOUND":case"ECONNREFUSED":case"ERR_SOCKET_BAD_PORT":throw e;case undefined:{if(e.message.endsWith("All configured authentication methods failed")||e.message.startsWith("Cannot parse privateKey")){throw e}t(e);break}default:t(e)}}}));const i=await this.getSftpChannel();return i}catch(e){this.end();throw e.custom?e:this.fmtError(e,"connect")}finally{p(this,t,"connect")}}_realPath(e){return new Promise(((t,n)=>{this.debugMsg(`_realPath -> ${e}`);this.sftp.realpath(e,((i,s)=>{if(i){if(i.code===2){this.debugMsg('_realPath <- ""');t("")}else{n(this.fmtError(`${i.message} ${e}`,"realPath",i.code))}}this.debugMsg(`_realPath <- ${s}`);t(s)}))}))}async realPath(e){let t;try{t=h(this,"realPath");g(this,"realPath");return await this._realPath(e)}catch(t){throw t.custom?t:this.fmtError(`${t.message} ${e}`,"realPath",t.code)}finally{p(this,t,"realPath")}}cwd(){return this.realPath(".")}_stat(e){return new Promise(((t,n)=>{this.debugMsg(`_stat: ${e}`);this.sftp.stat(e,((i,s)=>{if(i){if(i.code===2||i.code===4){n(this.fmtError(`No such file: ${e}`,"_stat",w.notexist))}else{n(this.fmtError(`${i.message} ${e}`,"_stat",i.code))}}else{const e={mode:s.mode,uid:s.uid,gid:s.gid,size:s.size,accessTime:s.atime*1e3,modifyTime:s.mtime*1e3,isDirectory:s.isDirectory(),isFile:s.isFile(),isBlockDevice:s.isBlockDevice(),isCharacterDevice:s.isCharacterDevice(),isSymbolicLink:s.isSymbolicLink(),isFIFO:s.isFIFO(),isSocket:s.isSocket()};this.debugMsg("_stat: stats <- ",e);t(e)}}))}))}async stat(e){let t;try{t=h(this,"stat");g(this,"stat");const n=await _(this,e);return await this._stat(n)}catch(e){throw e.custom?e:this.fmtError(e,"stat",e.code)}finally{p(this,t,"stat")}}async _exists(e){try{const t=await _(this,e);this.debugMsg(`exists: ${e} -> ${t}`);const n=await this._stat(t);this.debugMsg("exists: <- ",n);if(n.isDirectory){this.debugMsg(`exists: ${e} = d`);return"d"}if(n.isSymbolicLink){this.debugMsg(`exists: ${e} = l`);return"l"}if(n.isFile){this.debugMsg(`exists: ${e} = -`);return"-"}this.debugMsg(`exists: ${e} = false`);return false}catch(t){if(t.code===w.notexist){this.debugMsg(`exists: ${e} = false errorCode = ${t.code}`);return false}throw t.custom?t:this.fmtError(t.message,"exists",t.code)}}async exists(e){let t;try{t=h(this,"exists");g(this,"exists");if(e==="."){return"d"}return await this._exists(e)}catch(e){throw e.custom?e:this.fmtError(e,"exists",e.code)}finally{p(this,t,"exists")}}_list(e,t){return new Promise(((n,i)=>{this.sftp.readdir(e,((s,o)=>{if(s){i(this.fmtError(`${s.message} ${e}`,"list",s.code))}else{const e=/-/gi;const i=o.map((t=>({type:t.longname.slice(0,1),name:t.filename,size:t.attrs.size,modifyTime:t.attrs.mtime*1e3,accessTime:t.attrs.atime*1e3,rights:{user:t.longname.slice(1,4).replace(e,""),group:t.longname.slice(4,7).replace(e,""),other:t.longname.slice(7,10).replace(e,"")},owner:t.attrs.uid,group:t.attrs.gid,longname:t.longname})));if(t){n(i.filter((e=>t(e))))}else{n(i)}}}))}))}async list(e,t){let n;try{n=h(this,"list");g(this,"list");return await this._list(e,t)}catch(t){throw t.custom?t:this.fmtError(`${t.message} ${e}`,"list",t.code)}finally{p(this,n,"list")}}_get(e,t,n){let i,f;return new Promise(((u,l)=>{n={...n,readStreamOptions:{autoClose:true},writeStreamOptions:{autoClose:true},pipeOptions:{end:true}};i=this.sftp.createReadStream(e,n.readStreamOptions);i.once("error",(n=>{if(t&&typeof t!=="string"&&!t.destroyed){t.destroy()}l(this.fmtError(`${n.message} ${e}`,"_get",n.code))}));if(t===undefined){this.debugMsg("get resolving buffer of data");f=o((e=>{u(e)}))}else if(typeof t==="string"){this.debugMsg("get returning local file");const e=b(t);if(!e.status){l(this.fmtError(`Bad path: ${t}: ${e.details}`,"get",e.code));return}else{f=s.createWriteStream(t,n.writeStreamOptions)}}else{this.debugMsg("get: returning data into supplied stream");f=t}f.once("error",(e=>{l(this.fmtError(`${e.message} ${typeof t==="string"?t:"<stream>"}`,"get",e.code))}));i.once("end",(()=>{if(typeof t==="string"){this.debugMsg("get: resolving with dst filename");u(t)}else if(t!==undefined){this.debugMsg("get: resolving with writer stream object");u(f)}}));i.pipe(f,n.pipeOptions)}))}async get(e,t,n){let i;try{i=h(this,"get");g(this,"get");return await this._get(e,t,n)}catch(t){throw t.custom?t:this.fmtError(`${t.message} ${e}`,"get",t.code)}finally{p(this,i,"get")}}_fastGet(e,t,n){return new Promise(((i,s)=>{this.sftp.fastGet(e,t,n,(n=>{if(n){s(this.fmtError(`${n.message} Remote: ${e} Local: ${t}`))}i(`${e} was successfully download to ${t}!`)}))}))}async fastGet(e,t,n){let i;try{i=h(this,"fastGet");g(this,"fastGet");const s=await this.exists(e);if(s!=="-"){const t=`${!s?"No such file ":"Not a regular file"} ${e}`;throw this.fmtError(t,"fastGet",w.badPath)}const o=b(t);if(!o.status){throw this.fmtError(`Bad path: ${t}: ${o.details}`,"fastGet",w.badPath)}return await this._fastGet(e,t,n)}catch(e){throw this.fmtError(e,"fastGet")}finally{p(this,i,"fastGet")}}_fastPut(e,t,n){return new Promise(((i,s)=>{this.sftp.fastPut(e,t,n,(n=>{if(n){s(this.fmtError(`${n.message} Local: ${e} Remote: ${t}`,"fastPut",n.code))}i(`${e} was successfully uploaded to ${t}!`)}))}))}async fastPut(e,t,n){let i;try{i=h(this,"fastPut");this.debugMsg(`fastPut -> local ${e} remote ${t}`);g(this,"fastPut");const s=y(e);if(!s.status){throw this.fmtError(`Bad path: ${e}: ${s.details}`,"fastPut",s.code)}else if(s.status&&E(e)==="d"){throw this.fmtError(`Bad path: ${e} not a regular file`,"fastgPut",w.badPath)}return await this._fastPut(e,t,n)}catch(e){throw e.custom?e:this.fmtError(e.message,"fastPut",e.code)}finally{p(this,i,"fastPut")}}_put(e,t,n){let i,o;return new Promise(((f,u)=>{n={...n,readStreamOptions:{autoClose:true},writeStreamOptions:{autoClose:true},pipeOptions:{end:true}};i=this.sftp.createWriteStream(t,n.writeStreamOptions);i.once("error",(e=>{u(this.fmtError(`${e.message} ${t}`,"put",e.code))}));i.once("close",(()=>{f(`Uploaded data stream to ${t}`)}));if(e instanceof Buffer){this.debugMsg("put source is a buffer");i.end(e)}else{o=typeof e==="string"?s.createReadStream(e,n.readStreamOptions):e;o.once("error",(t=>{u(this.fmtError(`${t.message} ${typeof e==="string"?e:"<stream>"}`,"_put",t.code))}));o.pipe(i,n.pipeOptions)}}))}async put(e,t,n){let i;try{i=h(this,"put");g(this,"put");if(typeof e==="string"){const t=y(e);if(!t.status){throw this.fmtError(`Bad path: ${e} ${t.details}`,"put",t.code)}}return await this._put(e,t,n)}catch(e){throw e.custom?e:this.fmtError(e.message,"put",e.code)}finally{p(this,i,"put")}}_append(e,t,n){return new Promise(((i,s)=>{this.debugMsg(`append -> remote: ${t} `,n);n.flags="a";const o=this.sftp.createWriteStream(t,n);o.on("error",(e=>{s(this.fmtError(`${e.message} ${t}`,"append",e.code))}));o.on("close",(()=>{i(`Appended data to ${t}`)}));if(e instanceof Buffer){o.write(e);o.end()}else{e.pipe(o)}}))}async append(e,t,n={}){let i;try{i=h(this,"append");if(typeof e==="string"){throw this.fmtError("Cannot append one file to another","append",w.badPath)}g(this,"append");const s=await this.exists(t);if(s&&s==="d"){throw this.fmtError(`Bad path: ${t}: cannot append to a directory`,"append",w.badPath)}await this._append(e,t,n)}catch(e){throw e.custom?e:this.fmtError(e.message,"append",e.code)}finally{p(this,i,"append")}}_doMkdir(e){return new Promise(((t,n)=>{this.sftp.mkdir(e,(i=>{if(i){if(i.code===4){n(this.fmtError(`Bad path: ${e} permission denied`,"_doMkdir",w.badPath))}else if(i.code===2){n(this.fmtError(`Bad path: ${e} parent not a directory or not exist`,"_doMkdir",w.badPath))}else{n(this.fmtError(`${i.message} ${e}`,"_doMkdir",i.code))}}else{t(`${e} directory created`)}}))}))}async _mkdir(e,t){try{const n=await _(this,e);const i=await this.exists(n);if(i&&i!=="d"){throw this.fmtError(`Bad path: ${n} already exists as a file`,"_mkdir",w.badPath)}else if(i){return`${n} already exists`}if(!t){return await this._doMkdir(n)}const s=l(n).dir;if(s){const e=await this.exists(s);if(!e){await this._mkdir(s,true)}else if(e!=="d"){throw this.fmtError(`Bad path: ${s} not a directory`,"_mkdir",w.badPath)}}return await this._doMkdir(n)}catch(t){throw t.custom?t:this.fmtError(`${t.message} ${e}`,"_mkdir",t.code)}}async mkdir(e,t=false){let n;try{n=h(this,"_mkdir");g(this,"mkdir");return await this._mkdir(e,t)}catch(e){throw this.fmtError(`${e.message}`,"mkdir",e.code)}finally{p(this,n,"append")}}async rmdir(e,t=false){const _rmdir=e=>new Promise(((t,n)=>{this.debugMsg(`rmdir -> ${e}`);this.sftp.rmdir(e,(i=>{if(i){n(this.fmtError(`${i.message} ${e}`,"rmdir",i.code))}t("Successfully removed directory")}))}));const _dormdir=async(e,t)=>{try{if(t){const t=await this.list(e);if(t.length){const n=t.filter((e=>e.type!=="d"));const i=t.filter((e=>e.type==="d"));this.debugMsg("rmdir contents (files): ",n);this.debugMsg("rmdir contents (dirs): ",i);for(const t of i){await _dormdir(`${e}${this.remotePathSep}${t.name}`,true)}const s=[];for(const t of n){s.push(this._delete(`${e}${this.remotePathSep}${t.name}`))}await Promise.all(s)}}return await _rmdir(e)}catch(e){throw e.custom?e:this.fmtError(e,"_dormdir",e.code)}};let n;try{n=h(this,"rmdir");g(this,"rmdir");const i=await _(this,e);const s=await this.exists(i);if(s&&s!=="d"){throw this.fmtError(`Bad path: ${i} not a directory`,"rmdir",w.badPath)}else if(!s){throw this.fmtError(`Bad path: ${i} No such file`,"rmdir",w.badPath)}else{return await _dormdir(i,t)}}catch(e){throw e.custom?e:this.fmtError(e.message,"rmdir",e.code)}finally{p(this,n,"rmdir")}}_delete(e,t){return new Promise(((n,i)=>{this.sftp.unlink(e,(s=>{if(s){if(t&&s.code===2){n(`Successfully deleted ${e}`)}else{i(this.fmtError(`${s.message} ${e}`,"delete",s.code))}}n(`Successfully deleted ${e}`)}))}))}async delete(e,t=false){let n;try{n=h(this,"delete");g(this,"delete");return await this._delete(e,t)}catch(e){throw e.custom?e:this.fmtError(e.message,"delete",e.code)}finally{p(this,n,"delete")}}_rename(e,t){return new Promise(((n,i)=>{this.sftp.rename(e,t,(s=>{if(s){i(this.fmtError(`${s.message} From: ${e} To: ${t}`,"_rename",s.code))}n(`Successfully renamed ${e} to ${t}`)}))}))}async rename(e,t){let n;try{n=h(this,"rename");g(this,"rename");return await this._rename(e,t)}catch(n){throw n.custom?n:this.fmtError(`${n.message} ${e} ${t}`,"rename",n.code)}finally{p(this,n,"rename")}}_posixRename(e,t){return new Promise(((n,i)=>{this.sftp.ext_openssh_rename(e,t,(s=>{if(s){i(this.fmtError(`${s.message} From: ${e} To: ${t}`,"_posixRename",s.code))}n(`Successful POSIX rename ${e} to ${t}`)}))}))}async posixRename(e,t){let n;try{n=h(this,"posixRename");g(this,"posixRename");return await this._posixRename(e,t)}catch(n){throw n.custom?n:this.fmtError(`${n.message} ${e} ${t}`,"posixRename",n.code)}finally{p(this,n,"posixRename")}}_chmod(e,t){return new Promise(((n,i)=>{this.sftp.chmod(e,t,(t=>{if(t){i(this.fmtError(`${t.message} ${e}`,"_chmod",t.code))}n("Successfully change file mode")}))}))}async chmod(e,t){let n;try{n=h(this,"chmod");g(this,"chmod");return await this._chmod(e,t)}catch(t){throw t.custom?t:this.fmtError(`${t.message} ${e}`,"chmod",t.code)}finally{p(this,n,"chmod")}}async _uploadDir(e,t,n){try{const i=await _(this,t);this.debugMsg(`uploadDir <- SRC = ${e} DST = ${i}`);const o=E(e);if(!o){throw this.fmtError(`Bad path: ${e} not exist`,"_uploadDir",w.badPath)}if(o!=="d"){throw this.fmtError(`Bad path: ${e}: not a directory`,"_uploadDir",w.badPath)}const f=await this.exists(i);if(f&&f!=="d"){throw this.fmtError(`Bad path ${i} Not a directory`,"_uploadDir",w.badPath)}if(!f){await this._mkdir(i,true)}let l=s.readdirSync(e,{encoding:"utf8",withFileTypes:true});if(n?.filter){l=l.filter((t=>n.filter(u(e,t.name),t.isDirectory())))}let h=[];for(const t of l){const s=u(e,t.name);const o=`${i}${this.remotePathSep}${t.name}`;if(t.isDirectory()){await this.uploadDir(s,o,n)}else if(t.isFile()){if(n?.useFastput){h.push(this._fastPut(s,o))}else{h.push(this._put(s,o))}this.client.emit("upload",{source:s,destination:o})}else{this.debugMsg(`uploadDir: File ignored: ${t.name} not a regular file`)}await Promise.all(h)}return`${e} uploaded to ${i}`}catch(t){throw t.custom?t:this.fmtError(`${t.message} ${e}`,"_uploadDir",t.code)}}async uploadDir(e,t,n){let i;try{i=h(this,"uploadDir");this.debugMsg(`uploadDir -> SRC = ${e} DST = ${t}`);g(this,"uploadDir");return await this._uploadDir(e,t,n)}catch(e){throw e.custom?e:this.fmtError(e,"uploadDir")}finally{p(this,i,"chmod")}}async _downloadDir(e,t,n){try{let i=await this._list(e);if(n?.filter){i=i.filter((t=>n.filter(`${e}${this.remotePathSep}${t.name}`,t.type==="d"?true:false)))}const o=b(t);if(!o.status&&o.details==="permission denied"){throw this.fmtError(`Bad path: ${t}: ${o.details}`,"downloadDir",o.code)}else if(o.status&&!o.type){s.mkdirSync(t,{recursive:true})}else if(o.status&&o.type!=="d"){throw this.fmtError(`Bad path: ${t}: not a directory`,"downloadDir",w.badPath)}let f=[];for(const s of i){const i=`${e}${this.remotePathSep}${s.name}`;const o=u(t,s.name);if(s.type==="d"){await this._downloadDir(i,o,n)}else if(s.type==="-"){if(n?.useFasget){f.push(this._fastGet(i,o))}else{f.push(this._get(i,o))}this.client.emit("download",{source:i,destination:o})}else{this.debugMsg(`downloadDir: File ignored: ${s.name} not regular file`)}}await Promise.all(f);return`${e} downloaded to ${t}`}catch(t){throw t.custom?t:this.fmtError(`${t.message} ${e}`,"_downloadDir",t.code)}}async downloadDir(e,t,n){let i;try{i=h(this,"downloadDir");g(this,"downloadDir");return await this._downloadDir(e,t,n)}catch(e){throw e.custom?e:this.fmtError(e,"downloadDir",e.code)}finally{p(this,i,"downloadDir")}}createReadStream(e,t){let n;try{n=h(this,"createReadStream");g(this,"createReadStream");const i=this.sftp.createReadStream(e,t);return i}catch(e){throw e.custom?e:this.fmtError(e.message,"createReadStream",e.code)}finally{p(this,n,"createReadStreame")}}createWriteStream(e,t){let n;try{n=h(this,"createWriteStream");g(this,"createWriteStream");const i=this.sftp.createWriteStream(e,t);return i}catch(e){throw e.custom?e:this.fmtError(e.message,"createWriteStream",e.code)}finally{p(this,n,"createWriteStream")}}_rcopy(e,t){return new Promise(((n,i)=>{const s=this.sftp.createWriteStream(t);const o=this.sftp.createReadStream(e);s.on("error",(e=>{i(this.fmtError(`${e.message} ${t}`,"_rcopy"))}));o.on("error",(t=>{i(this.fmtError(`${t.message} ${e}`,"_rcopy"))}));s.on("close",(()=>{n(`${e} copied to ${t}`)}));o.pipe(s)}))}async rcopy(e,t){let n;try{n=h(this,"rcopy");g(this,"rcopy");const i=await _(this,e);const s=await this.exists(i);if(!s){throw this.fmtError(`Source does not exist ${i}`,"rcopy",w.badPath)}if(s!=="-"){throw this.fmtError(`Source not a file ${i}`,"rcopy",w.badPath)}const o=await _(this,t);const f=await this.exists(o);if(f){throw this.fmtError(`Destination already exists ${o}`,"rcopy",w.badPath)}return this._rcopy(i,o)}catch(e){throw e.custom?e:this.fmtError(e,"rcopy")}finally{p(this,n,"rcopy")}}end(){let e,t;return new Promise(((n,i)=>{t=h(this,"end",i);this.endCalled=true;e=()=>{this.sftp=undefined;this.debugMsg("end: Connection closed");n(true)};this.on("close",e);if(this.client.sftp){this.client.end()}else{this.debugMsg("end: Called when no connection active");n(true)}})).finally((()=>{p(this,t,"end");this.removeListener("close",e);this.endCalled=false}))}}e.exports=SftpClient},9432:(e,t,n)=>{const i=n(7147);const s=n(1017);const{errorCode:o}=n(3232);function errorListener(e,t,n){const fn=i=>{if(e.endCalled||e.errorHandled){e.debugMsg(`${t} errorListener - ignoring handled error`);return}e.errorHandled=true;const s=new Error(`${t}: ${i.message}`);s.code=i.code;if(n){n(s)}else{throw s}};return fn}function endListener(e,t,n){const fn=function(){e.sftp=undefined;if(e.endCalled||e.endHandled||e.errorHandled){e.debugMsg(`${t} endListener - ignoring handled error`);return}e.endHandled=true;e.debugMsg(`${t} Unexpected end event - ignoring`)};return fn}function closeListener(e,t,n){const fn=function(){e.sftp=undefined;if(e.endCalled||e.closeHandled||e.errorHandled||e.endHandled){e.debugMsg(`${t} closeListener - ignoring handled error`);return}e.closeHandled=true;e.debugMsg(`${t} Unexpected close event raised - ignoring`)};return fn}function addTempListeners(e,t,n){const i={end:endListener(e,t,n),close:closeListener(e,t,n),error:errorListener(e,t,n)};e.on("end",i.end);e.on("close",i.close);e.on("error",i.error);e._resetEventFlags();return i}function removeTempListeners(e,t,n){try{e.removeListener("end",t.end);e.removeListener("close",t.close);e.removeListener("error",t.error)}catch(e){throw new Error(`${n}: Error removing temp listeners: ${e.message}`)}}function localExists(e){const t=i.statSync(e,{throwIfNoEntry:false});if(!t){return false}else if(t.isDirectory()){return"d"}else if(t.isFile()){return"-"}else{const t=new Error(`Bad path: ${e}: target must be a file or directory`);t.code=o.badPath;throw t}}function haveLocalAccess(e,t="r"){const n=i.constants.F_OK|t==="w"?i.constants.W_OK:i.constants.R_OK;try{i.accessSync(e,n);const t=localExists(e);return{status:true,type:t,details:"access OK",code:0}}catch(t){switch(t.errno){case-2:return{status:false,type:null,details:"not exist",code:-2};case-13:return{status:false,type:localExists(e),details:"permission denied",code:-13};case-20:return{status:false,type:null,details:"parent not a directory"};default:return{status:false,type:null,details:t.message}}}}function haveLocalCreate(e){const{status:t,details:n,type:i}=haveLocalAccess(e,"w");if(!t&&n==="permission denied"){return{status:t,details:n,type:i}}else if(!t){const t=s.dirname(e);const n=haveLocalAccess(t,"w");if(n.status&&n.type!=="d"){return{status:false,details:`${t}: not a directory`,type:null}}else if(!n.status){return{status:n.status,details:`${t}: ${n.details}`,type:null}}else{return{status:true,details:"access OK",type:null,code:0}}}return{status:t,details:n,type:i}}async function normalizeRemotePath(e,t){try{if(t.startsWith("..")){const n=await e.realPath("..");return n+e.remotePathSep+t.slice(3)}else if(t.startsWith(".")){const n=await e.realPath(".");return n+e.remotePathSep+t.slice(2)}return t}catch(e){throw new Error(`normalizeRemotePath: ${e.message}`)}}function haveConnection(e,t,n){if(!e.sftp){const e=new Error(`${t}: No SFTP connection available`);e.code=o.connect;if(n){n(e);return false}else{throw e}}return true}function sleep(e){return new Promise(((t,n)=>{try{setTimeout((()=>{t(true)}),e)}catch(e){n(e)}}))}e.exports={errorListener:errorListener,endListener:endListener,closeListener:closeListener,addTempListeners:addTempListeners,removeTempListeners:removeTempListeners,haveLocalAccess:haveLocalAccess,haveLocalCreate:haveLocalCreate,normalizeRemotePath:normalizeRemotePath,localExists:localExists,haveConnection:haveConnection,sleep:sleep}},3204:(e,t,n)=>{"use strict";const{Duplex:i,Readable:s,Writable:o}=n(2781);const{CHANNEL_EXTENDED_DATATYPE:{STDERR:f}}=n(6832);const{bufferSlice:u}=n(9475);const l=32*1024;const h=2*1024*1024;const p=h/2;class ClientStderr extends s{constructor(e,t){super(t);this._channel=e}_read(e){if(this._channel._waitChanDrain){this._channel._waitChanDrain=false;if(this._channel.incoming.window<=p)windowAdjust(this._channel)}}}class ServerStderr extends o{constructor(e){super({highWaterMark:h});this._channel=e}_write(e,t,n){const i=this._channel;const s=i._client._protocol;const o=i.outgoing;const l=o.packetSize;const h=o.id;let p=o.window;const g=e.length;let _=0;if(o.state!=="open")return;while(g-_>0&&p>0){let t=g-_;if(t>p)t=p;if(t>l)t=l;if(_===0&&t===g)s.channelExtData(h,e,f);else s.channelExtData(h,u(e,_,_+t),f);_+=t;p-=t}o.window=p;if(g-_>0){if(p===0)i._waitWindow=true;if(_>0)i._chunkErr=u(e,_,g);else i._chunkErr=e;i._chunkcbErr=n;return}n()}}class Channel extends i{constructor(e,t,n){const i={highWaterMark:h,allowHalfOpen:!n||n&&n.allowHalfOpen!==false,emitClose:false};super(i);this.allowHalfOpen=i.allowHalfOpen;const s=!!(n&&n.server);this.server=s;this.type=t.type;this.subtype=undefined;this.incoming=t.incoming;this.outgoing=t.outgoing;this._callbacks=[];this._client=e;this._hasX11=false;this._exit={code:undefined,signal:undefined,dump:undefined,desc:undefined};this.stdin=this.stdout=this;if(s)this.stderr=new ServerStderr(this);else this.stderr=new ClientStderr(this,i);this._waitWindow=false;this._waitChanDrain=false;this._chunk=undefined;this._chunkcb=undefined;this._chunkErr=undefined;this._chunkcbErr=undefined;this.on("finish",onFinish).on("prefinish",onFinish);this.on("end",onEnd).on("close",onEnd)}_read(e){if(this._waitChanDrain){this._waitChanDrain=false;if(this.incoming.window<=p)windowAdjust(this)}}_write(e,t,n){const i=this._client._protocol;const s=this.outgoing;const o=s.packetSize;const f=s.id;let l=s.window;const h=e.length;let p=0;if(s.state!=="open")return;while(h-p>0&&l>0){let t=h-p;if(t>l)t=l;if(t>o)t=o;if(p===0&&t===h)i.channelData(f,e);else i.channelData(f,u(e,p,p+t));p+=t;l-=t}s.window=l;if(h-p>0){if(l===0)this._waitWindow=true;if(p>0)this._chunk=u(e,p,h);else this._chunk=e;this._chunkcb=n;return}n()}eof(){if(this.outgoing.state==="open"){this.outgoing.state="eof";this._client._protocol.channelEOF(this.outgoing.id)}}close(){if(this.outgoing.state==="open"||this.outgoing.state==="eof"){this.outgoing.state="closing";this._client._protocol.channelClose(this.outgoing.id)}}destroy(){this.end();this.close();return this}setWindow(e,t,n,i){if(this.server)throw new Error("Client-only method called in server mode");if(this.type==="session"&&(this.subtype==="shell"||this.subtype==="exec")&&this.writable&&this.outgoing.state==="open"){this._client._protocol.windowChange(this.outgoing.id,e,t,n,i)}}signal(e){if(this.server)throw new Error("Client-only method called in server mode");if(this.type==="session"&&this.writable&&this.outgoing.state==="open"){this._client._protocol.signal(this.outgoing.id,e)}}exit(e,t,n){if(!this.server)throw new Error("Server-only method called in client mode");if(this.type==="session"&&this.writable&&this.outgoing.state==="open"){if(typeof e==="number"){this._client._protocol.exitStatus(this.outgoing.id,e)}else{this._client._protocol.exitSignal(this.outgoing.id,e,t,n)}}}}function onFinish(){this.eof();if(this.server||!this.allowHalfOpen)this.close();this.writable=false}function onEnd(){this.readable=false}function windowAdjust(e){if(e.outgoing.state==="closed")return;const t=h-e.incoming.window;if(t<=0)return;e.incoming.window+=t;e._client._protocol.channelWindowAdjust(e.outgoing.id,t)}e.exports={Channel:Channel,MAX_WINDOW:h,PACKET_SIZE:l,windowAdjust:windowAdjust,WINDOW_THRESHOLD:p}},9054:(e,t,n)=>{"use strict";const{Socket:i}=n(1808);const{Duplex:s}=n(2781);const{resolve:o}=n(1017);const{readFile:f}=n(7147);const{execFile:u,spawn:l}=n(2081);const{isParsedKey:h,parseKey:p}=n(2218);const{makeBufferParser:g,readUInt32BE:_,writeUInt32BE:E,writeUInt32LE:y}=n(9475);function once(e){let t=false;return(...n)=>{if(t)return;t=true;e(...n)}}function concat(e,t){const n=Buffer.allocUnsafe(e.length+t.length);e.copy(n,0);t.copy(n,e.length);return n}function noop(){}const b=Buffer.alloc(0);const w=g();class BaseAgent{getIdentities(e){e(new Error("Missing getIdentities() implementation"))}sign(e,t,n,i){if(typeof n==="function")i=n;i(new Error("Missing sign() implementation"))}}class OpenSSHAgent extends BaseAgent{constructor(e){super();this.socketPath=e}getStream(e){e=once(e);const t=new i;t.on("connect",(()=>{e(null,t)}));t.on("close",onFail).on("end",onFail).on("error",onFail);t.connect(this.socketPath);function onFail(){try{t.destroy()}catch{}e(new Error("Failed to connect to agent"))}}getIdentities(e){e=once(e);this.getStream(((t,n)=>{function onFail(t){if(n){try{n.destroy()}catch{}}if(!t)t=new Error("Failed to retrieve identities from agent");e(t)}if(t)return onFail(t);const i=new k(true);i.on("error",onFail);i.pipe(n).pipe(i);n.on("close",onFail).on("end",onFail).on("error",onFail);i.getIdentities(((t,i)=>{if(t)return onFail(t);try{n.destroy()}catch{}e(null,i)}))}))}sign(e,t,n,i){if(typeof n==="function"){i=n;n=undefined}else if(typeof n!=="object"||n===null){n=undefined}i=once(i);this.getStream(((s,o)=>{function onFail(e){if(o){try{o.destroy()}catch{}}if(!e)e=new Error("Failed to sign data with agent");i(e)}if(s)return onFail(s);const f=new k(true);f.on("error",onFail);f.pipe(o).pipe(f);o.on("close",onFail).on("end",onFail).on("error",onFail);f.sign(e,t,n,((e,t)=>{if(e)return onFail(e);try{o.destroy()}catch{}i(null,t)}))}))}}const I=(()=>{const e=10;const t=11;const i=12;const o=13;const f=14;const u=15;const h=n.ab+"pagent.exe";const p={[e]:new Error("Invalid pagent.exe arguments"),[t]:new Error("Pageant is not running"),[i]:new Error("pagent.exe could not create an mmap"),[o]:new Error("pagent.exe could not set mode for stdin"),[f]:new Error("pagent.exe could not set mode for stdout"),[u]:new Error("pagent.exe did not get expected input payload")};function destroy(e){e.buffer=null;if(e.proc){e.proc.kill();e.proc=undefined}}class PageantSocket extends s{constructor(){super();this.proc=undefined;this.buffer=null}_read(e){}_write(e,t,i){if(this.buffer===null){this.buffer=e}else{const t=Buffer.allocUnsafe(this.buffer.length+e.length);this.buffer.copy(t,0);e.copy(t,this.buffer.length);this.buffer=t}if(this.buffer.length<4)return i();const s=_(this.buffer,0);if(this.buffer.length-4<s)return i();e=this.buffer.slice(0,4+s);if(this.buffer.length>4+s)return i(new Error("Unexpected multiple agent requests"));this.buffer=null;let o;const f=this.proc=l(n.ab+"pagent.exe",[e.length]);f.stdout.on("data",(e=>{this.push(e)}));f.on("error",(e=>{o=e;i(o)}));f.on("close",(e=>{this.proc=undefined;if(!o){if(o=p[e])return i(o);i()}}));f.stdin.end(e)}_final(e){destroy(this);e()}_destroy(e,t){destroy(this);t()}}return class PageantAgent extends OpenSSHAgent{getStream(e){e(null,new PageantSocket)}}})();const C=(()=>{const e=/^!<socket >(\d+) s ([A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8})/;return class CygwinAgent extends OpenSSHAgent{getStream(t){t=once(t);let n=this.socketPath;let s=false;f(n,(function readCygsocket(o,l){if(o){if(s)return t(new Error("Invalid cygwin unix socket path"));u("cygpath",["-w",n],((e,i,o)=>{if(e||i.length===0)return t(new Error("Invalid cygwin unix socket path"));s=true;n=i.toString().replace(/[\r\n]/g,"");f(n,readCygsocket)}));return}const h=e.exec(l.toString("ascii"));if(!h)return t(new Error("Malformed cygwin unix socket file"));let p;let g=0;let E=false;const b=[];let w;let I=Buffer.alloc(12);const C=parseInt(h[1],10);const v=h[2].replace(/-/g,"");const k=Buffer.allocUnsafe(16);for(let e=0,t=0;t<32;++e,t+=2)k[e]=parseInt(v.substring(t,t+2),16);for(let e=0;e<16;e+=4)y(k,_(k,e),e);tryConnect();function _onconnect(){g=0;p="secret";w.write(k)}function _ondata(e){g+=e.length;if(p==="secret"){if(g===16){g=0;p="creds";w.write(I)}return}if(p==="creds"){if(!E)b.push(e);if(g===12){w.removeListener("connect",_onconnect);w.removeListener("data",_ondata);w.removeListener("error",onFail);w.removeListener("end",onFail);w.removeListener("close",onFail);if(E)return t(null,w);E=true;I=Buffer.concat(b);y(I,process.pid,0);w.on("error",(()=>{}));w.destroy();tryConnect()}}}function onFail(){t(new Error("Problem negotiating cygwin unix socket security"))}function tryConnect(){w=new i;w.on("connect",_onconnect);w.on("data",_ondata);w.on("error",onFail);w.on("end",onFail);w.on("close",onFail);w.connect(C)}}))}}})();const v=/^[/\\][/\\]\.[/\\]pipe[/\\].+/;function createAgent(e){if(process.platform==="win32"&&!v.test(e)){return e==="pageant"?new I:new C(e)}return new OpenSSHAgent(e)}const k=(()=>{const e=11;const t=13;const n=5;const i=12;const o=14;const f=1<<1;const u=1<<2;const l=0;const g=1;function processResponses(e){let t;while(e[v].length){const n=e[v][0][I];if(n===undefined)break;e[v].shift();t=e.push(n)}return t}const y=Symbol("Inbound Request Type");const I=Symbol("Inbound Request Response");const C=Symbol("Inbound Request Context");class AgentInboundRequest{constructor(e,t){this[y]=e;this[I]=undefined;this[C]=t}hasResponded(){return this[I]!==undefined}getType(){return this[y]}getContext(){return this[C]}}function respond(e,t,n){t[I]=n;return processResponses(e)}function cleanup(e){e[R]=null;if(e[k]===l){const t=e[v];if(t&&t.length){e[v]=[];for(const e of t)e.cb(new Error("No reply from server"))}}try{e.end()}catch{}setImmediate((()=>{if(!e[O])e.emit("end");if(!e[T])e.emit("close")}))}function onClose(){this[T]=true}function onEnd(){this[O]=true}const v=Symbol("Requests");const k=Symbol("Agent Protocol Role");const R=Symbol("Agent Protocol Buffer");const B=Symbol("Agent Protocol Current Message Length");const T=Symbol("Agent Protocol Closed");const O=Symbol("Agent Protocol Ended");return class AgentProtocol extends s{constructor(e){super({autoDestroy:true,emitClose:false});this[k]=e?l:g;this[v]=[];this[R]=null;this[B]=-1;this.once("end",onEnd);this.once("close",onClose)}_read(e){}_write(s,h,g){if(this[R]===null)this[R]=s;else this[R]=concat(this[R],s);let E=this[R];let y=E.length;let b=0;while(b<y){if(y<5)break;if(this[B]===-1)this[B]=_(E,b);if(y<4+this[B])break;const s=E[b+=4];++b;if(this[k]===l){if(this[v].length===0)return g(new Error("Received unexpected message from server"));const f=this[v].shift();switch(s){case n:f.cb(new Error("Agent responded with failure"));break;case i:{if(f.type!==e)return g(new Error("Agent responded with wrong message type"));w.init(E,b);const t=w.readUInt32BE();if(t===undefined){w.clear();return g(new Error("Malformed agent response"))}const n=[];for(let e=0;e<t;++e){let e=w.readString();if(e===undefined){w.clear();return g(new Error("Malformed agent response"))}const t=w.readString(true);if(t===undefined){w.clear();return g(new Error("Malformed agent response"))}e=p(e);if(e instanceof Error)continue;e.comment=e.comment||t;n.push(e)}b=w.pos();w.clear();f.cb(null,n);break}case o:{if(f.type!==t)return g(new Error("Agent responded with wrong message type"));w.init(E,b);let e=w.readString();b=w.pos();w.clear();if(e===undefined)return g(new Error("Malformed agent response"));w.init(e,0);w.readString(true);e=w.readString();w.clear();if(e===undefined)return g(new Error("Malformed OpenSSH signature format"));f.cb(null,e);break}default:return g(new Error("Agent responded with unsupported message type"))}}else{switch(s){case e:{const e=new AgentInboundRequest(s);this[v].push(e);this.emit("identities",e);break}case t:{w.init(E,b);let e=w.readString();const t=w.readString();const n=w.readUInt32BE();b=w.pos();w.clear();if(n===undefined){const e=new AgentInboundRequest(s);this[v].push(e);return this.failureReply(e)}e=p(e);if(e instanceof Error){const e=new AgentInboundRequest(s);this[v].push(e);return this.failureReply(e)}const i={hash:undefined};let o;if(e.type==="ssh-rsa"){if(n&f){o="rsa-sha2-256";i.hash="sha256"}else if(n&u){o="rsa-sha2-512";i.hash="sha512"}}if(o===undefined)o=e.type;const l=new AgentInboundRequest(s,o);this[v].push(l);this.emit("sign",l,e,t,i);break}default:{const e=new AgentInboundRequest(s);this[v].push(e);this.failureReply(e)}}}this[B]=-1;if(b===y){this[R]=null;break}else{this[R]=E=E.slice(b);y=E.length;b=0}}g()}_destroy(e,t){cleanup(this);t()}_final(e){cleanup(this);e()}sign(e,n,i,s){if(this[k]!==l)throw new Error("Client-only method called with server role");if(typeof i==="function"){s=i;i=undefined}else if(typeof i!=="object"||i===null){i=undefined}let o=0;e=p(e);if(e instanceof Error)throw new Error("Invalid public key argument");if(e.type==="ssh-rsa"&&i){switch(i.hash){case"sha256":o=f;break;case"sha512":o=u;break}}e=e.getPublicSSH();const h=t;const g=e.length;const _=n.length;let y=0;const b=Buffer.allocUnsafe(4+1+4+g+4+_+4);E(b,b.length-4,y);b[y+=4]=h;E(b,g,++y);e.copy(b,y+=4);E(b,_,y+=g);n.copy(b,y+=4);E(b,o,y+=_);if(typeof s!=="function")s=noop;this[v].push({type:h,cb:s});return this.push(b)}getIdentities(t){if(this[k]!==l)throw new Error("Client-only method called with server role");const n=e;let i=0;const s=Buffer.allocUnsafe(4+1);E(s,s.length-4,i);s[i+=4]=n;if(typeof t!=="function")t=noop;this[v].push({type:n,cb:t});return this.push(s)}failureReply(e){if(this[k]!==g)throw new Error("Server-only method called with client role");if(!(e instanceof AgentInboundRequest))throw new Error("Wrong request argument");if(e.hasResponded())return true;let t=0;const i=Buffer.allocUnsafe(4+1);E(i,i.length-4,t);i[t+=4]=n;return respond(this,e,i)}getIdentitiesReply(t,n){if(this[k]!==g)throw new Error("Server-only method called with client role");if(!(t instanceof AgentInboundRequest))throw new Error("Wrong request argument");if(t.hasResponded())return true;if(t.getType()!==e)throw new Error("Invalid response to request");if(!Array.isArray(n))throw new Error("Keys argument must be an array");let s=4;const o=[];for(let e=0;e<n.length;++e){const t=n[e];if(typeof t!=="object"||t===null)throw new Error(`Invalid key entry: ${t}`);let i;let f;if(h(t)){i=t}else if(h(t.pubKey)){i=t.pubKey}else{if(typeof t.pubKey!=="object"||t.pubKey===null)continue;({pubKey:i,comment:f}=t.pubKey);i=p(i);if(i instanceof Error)continue}f=i.comment||f;i=i.getPublicSSH();s+=4+i.length;if(f&&typeof f==="string")f=Buffer.from(f);else if(!Buffer.isBuffer(f))f=b;s+=4+f.length;o.push({pubKey:i,comment:f})}let f=0;const u=Buffer.allocUnsafe(4+1+s);E(u,u.length-4,f);u[f+=4]=i;E(u,o.length,++f);f+=4;for(let e=0;e<o.length;++e){const{pubKey:t,comment:n}=o[e];E(u,t.length,f);t.copy(u,f+=4);E(u,n.length,f+=t.length);f+=4;if(n.length){n.copy(u,f);f+=n.length}}return respond(this,t,u)}signReply(e,n){if(this[k]!==g)throw new Error("Server-only method called with client role");if(!(e instanceof AgentInboundRequest))throw new Error("Wrong request argument");if(e.hasResponded())return true;if(e.getType()!==t)throw new Error("Invalid response to request");if(!Buffer.isBuffer(n))throw new Error("Signature argument must be a Buffer");if(n.length===0)throw new Error("Signature argument must be non-empty");let i=0;const s=e.getContext();const f=Buffer.byteLength(s);const u=Buffer.allocUnsafe(4+1+4+4+f+4+n.length);E(u,u.length-4,i);u[i+=4]=o;E(u,4+f+4+n.length,++i);E(u,f,i+=4);u.utf8Write(s,i+=4,f);E(u,n.length,i+=f);n.copy(u,i+=4);return respond(this,e,u)}}})();const R=Symbol("Agent");const B=Symbol("Agent Keys");const T=Symbol("Agent Keys Index");const O=Symbol("Agent Init Callbacks");class AgentContext{constructor(e){if(typeof e==="string")e=createAgent(e);else if(!isAgent(e))throw new Error("Invalid agent argument");this[R]=e;this[B]=null;this[T]=-1;this[O]=null}init(e){if(typeof e!=="function")e=noop;if(this[B]===null){if(this[O]===null){this[O]=[e];const doCbs=(...e)=>{process.nextTick((()=>{const t=this[O];this[O]=null;for(const n of t)n(...e)}))};this[R].getIdentities(once(((e,t)=>{if(e)return doCbs(e);if(!Array.isArray(t)){return doCbs(new Error("Agent implementation failed to provide keys"))}const n=[];for(let e of t){e=p(e);if(e instanceof Error){continue}n.push(e)}this[B]=n;this[T]=-1;doCbs()})))}else{this[O].push(e)}}else{process.nextTick(e)}}nextKey(){if(this[B]===null||++this[T]>=this[B].length){return false}return this[B][this[T]]}currentKey(){if(this[B]===null||this[T]>=this[B].length){return null}return this[B][this[T]]}pos(){if(this[B]===null||this[T]>=this[B].length){return-1}return this[T]}reset(){this[T]=-1}sign(...e){this[R].sign(...e)}}function isAgent(e){return e instanceof BaseAgent}e.exports={AgentContext:AgentContext,AgentProtocol:k,BaseAgent:BaseAgent,createAgent:createAgent,CygwinAgent:C,isAgent:isAgent,OpenSSHAgent:OpenSSHAgent,PageantAgent:I}},6063:(e,t,n)=>{"use strict";const{createHash:i,getHashes:s,randomFillSync:o}=n(6113);const{Socket:f}=n(1808);const{lookup:u}=n(9523);const l=n(2361);const h=s();const{COMPAT:p,CHANNEL_EXTENDED_DATATYPE:{STDERR:g},CHANNEL_OPEN_FAILURE:_,DEFAULT_CIPHER:E,DEFAULT_COMPRESSION:y,DEFAULT_KEX:b,DEFAULT_MAC:w,DEFAULT_SERVER_HOST_KEY:I,DISCONNECT_REASON:C,DISCONNECT_REASON_BY_VALUE:v,SUPPORTED_CIPHER:k,SUPPORTED_COMPRESSION:R,SUPPORTED_KEX:B,SUPPORTED_MAC:T,SUPPORTED_SERVER_HOST_KEY:O}=n(6832);const{init:P}=n(5708);const L=n(9031);const{parseKey:U}=n(2218);const{SFTP:D}=n(2026);const{bufferCopy:x,makeBufferParser:Q,makeError:W,readUInt32BE:$,sigSSHToASN1:q,writeUInt32BE:G}=n(9475);const{AgentContext:j,createAgent:Y,isAgent:V}=n(9054);const{Channel:z,MAX_WINDOW:J,PACKET_SIZE:ee,windowAdjust:te,WINDOW_THRESHOLD:re}=n(3204);const{ChannelManager:ne,generateAlgorithmList:ie,isWritable:se,onChannelOpenFailure:oe,onCHANNEL_CLOSE:ae}=n(834);const ce=Q();const fe=Q();const ue=/^OpenSSH_(?:(?![0-4])\d)|(?:\d{2,})/;const noop=e=>{};class Client extends l{constructor(){super();this.config={host:undefined,port:undefined,localAddress:undefined,localPort:undefined,forceIPv4:undefined,forceIPv6:undefined,keepaliveCountMax:undefined,keepaliveInterval:undefined,readyTimeout:undefined,ident:undefined,username:undefined,password:undefined,privateKey:undefined,tryKeyboard:undefined,agent:undefined,allowAgentFwd:undefined,authHandler:undefined,hostHashAlgo:undefined,hostHashCb:undefined,strictVendor:undefined,debug:undefined};this._agent=undefined;this._readyTimeout=undefined;this._chanMgr=undefined;this._callbacks=undefined;this._forwarding=undefined;this._forwardingUnix=undefined;this._acceptX11=undefined;this._agentFwdEnabled=undefined;this._remoteVer=undefined;this._protocol=undefined;this._sock=undefined;this._resetKA=undefined}connect(e){if(this._sock&&se(this._sock)){this.once("close",(()=>{this.connect(e)}));this.end();return this}this.config.host=e.hostname||e.host||"localhost";this.config.port=e.port||22;this.config.localAddress=typeof e.localAddress==="string"?e.localAddress:undefined;this.config.localPort=typeof e.localPort==="string"||typeof e.localPort==="number"?e.localPort:undefined;this.config.forceIPv4=e.forceIPv4||false;this.config.forceIPv6=e.forceIPv6||false;this.config.keepaliveCountMax=typeof e.keepaliveCountMax==="number"&&e.keepaliveCountMax>=0?e.keepaliveCountMax:3;this.config.keepaliveInterval=typeof e.keepaliveInterval==="number"&&e.keepaliveInterval>0?e.keepaliveInterval:0;this.config.readyTimeout=typeof e.readyTimeout==="number"&&e.readyTimeout>=0?e.readyTimeout:2e4;this.config.ident=typeof e.ident==="string"||Buffer.isBuffer(e.ident)?e.ident:undefined;const t={kex:undefined,serverHostKey:undefined,cs:{cipher:undefined,mac:undefined,compress:undefined,lang:[]},sc:undefined};let n=true;if(typeof e.algorithms==="object"&&e.algorithms!==null){t.kex=ie(e.algorithms.kex,b,B);if(t.kex!==b)n=false;t.serverHostKey=ie(e.algorithms.serverHostKey,I,O);if(t.serverHostKey!==I)n=false;t.cs.cipher=ie(e.algorithms.cipher,E,k);if(t.cs.cipher!==E)n=false;t.cs.mac=ie(e.algorithms.hmac,w,T);if(t.cs.mac!==w)n=false;t.cs.compress=ie(e.algorithms.compress,y,R);if(t.cs.compress!==y)n=false;if(!n)t.sc=t.cs}if(typeof e.username==="string")this.config.username=e.username;else if(typeof e.user==="string")this.config.username=e.user;else throw new Error("Invalid username");this.config.password=typeof e.password==="string"?e.password:undefined;this.config.privateKey=typeof e.privateKey==="string"||Buffer.isBuffer(e.privateKey)?e.privateKey:undefined;this.config.localHostname=typeof e.localHostname==="string"?e.localHostname:undefined;this.config.localUsername=typeof e.localUsername==="string"?e.localUsername:undefined;this.config.tryKeyboard=e.tryKeyboard===true;if(typeof e.agent==="string"&&e.agent.length)this.config.agent=Y(e.agent);else if(V(e.agent))this.config.agent=e.agent;else this.config.agent=undefined;this.config.allowAgentFwd=e.agentForward===true&&this.config.agent!==undefined;let s=this.config.authHandler=typeof e.authHandler==="function"||Array.isArray(e.authHandler)?e.authHandler:undefined;this.config.strictVendor=typeof e.strictVendor==="boolean"?e.strictVendor:true;const o=this.config.debug=typeof e.debug==="function"?e.debug:undefined;if(e.agentForward===true&&!this.config.allowAgentFwd){throw new Error("You must set a valid agent path to allow agent forwarding")}let l=this._callbacks=[];this._chanMgr=new ne(this);this._forwarding={};this._forwardingUnix={};this._acceptX11=0;this._agentFwdEnabled=false;this._agent=this.config.agent?this.config.agent:undefined;this._remoteVer=undefined;let p;if(this.config.privateKey){p=U(this.config.privateKey,e.passphrase);if(p instanceof Error)throw new Error(`Cannot parse privateKey: ${p.message}`);if(Array.isArray(p)){p=p[0]}if(p.getPrivatePEM()===null){throw new Error("privateKey value does not contain a (valid) private key")}}let _;if(typeof e.hostVerifier==="function"){const t=e.hostVerifier;let n;if(h.indexOf(e.hostHash)!==-1){n=i(e.hostHash)}_=(e,i)=>{if(n){n.update(e);e=n.digest("hex")}const s=t(e,i);if(s!==undefined)i(s)}}const x=this._sock=e.sock||new f;let Q=false;let $=false;if(this._protocol)this._protocol.cleanup();const q=!o?undefined:(e,t,n)=>{o(`Debug output from server: ${JSON.stringify(n)}`)};const G=this._protocol=new L({ident:this.config.ident,offer:n?undefined:t,onWrite:e=>{if(se(x))x.write(e)},onError:e=>{if(e.level==="handshake")clearTimeout(this._readyTimeout);if(!G._destruct)x.removeAllListeners("data");this.emit("error",e);try{x.end()}catch{}},onHeader:e=>{$=true;this._remoteVer=e.versions.software;if(e.greeting)this.emit("greeting",e.greeting)},onHandshakeComplete:e=>{this.emit("handshake",e);if(!Q){Q=true;G.service("ssh-userauth")}},debug:o,hostVerifier:_,messageHandlers:{DEBUG:q,DISCONNECT:(e,t,n)=>{if(t!==C.BY_APPLICATION){if(!n){n=v[t];if(n===undefined)n=`Unexpected disconnection reason: ${t}`}const e=new Error(n);e.code=t;this.emit("error",e)}x.end()},SERVICE_ACCEPT:(e,t)=>{if(t==="ssh-userauth")tryNextAuth()},USERAUTH_BANNER:(e,t)=>{this.emit("banner",t)},USERAUTH_SUCCESS:e=>{resetKA();clearTimeout(this._readyTimeout);this.emit("ready")},USERAUTH_FAILURE:(e,t,n)=>{if(ge.type==="agent"){const e=ge.agentCtx.pos();o&&o(`Client: Agent key #${e+1} failed`);return tryNextAgentKey()}o&&o(`Client: ${ge.type} auth failed`);_e=n;Ae=t;tryNextAuth()},USERAUTH_PASSWD_CHANGEREQ:(e,t)=>{if(ge.type==="password"){this.emit("change password",t,(e=>{G.authPassword(this.config.username,this.config.password,e)}))}},USERAUTH_PK_OK:e=>{if(ge.type==="agent"){const e=ge.agentCtx.currentKey();G.authPK(ge.username,e,((t,n)=>{ge.agentCtx.sign(e,t,{},((e,t)=>{if(e){e.level="agent";this.emit("error",e)}else{return n(t)}tryNextAgentKey()}))}))}else if(ge.type==="publickey"){G.authPK(ge.username,ge.key,((e,t)=>{const n=ge.key.sign(e);if(n instanceof Error){n.message=`Error signing data with key: ${n.message}`;n.level="client-authentication";this.emit("error",n);return tryNextAuth()}t(n)}))}},USERAUTH_INFO_REQUEST:(e,t,n,i)=>{if(ge.type==="keyboard-interactive"){const e=Array.isArray(i)?i.length:0;if(e===0){o&&o("Client: Sending automatic USERAUTH_INFO_RESPONSE");G.authInfoRes();return}ge.prompt(t,n,"",i,(e=>{G.authInfoRes(e)}))}},REQUEST_SUCCESS:(e,t)=>{if(l.length)l.shift()(false,t)},REQUEST_FAILURE:e=>{if(l.length)l.shift()(true)},GLOBAL_REQUEST:(e,t,n,i)=>{switch(t){case"hostkeys-00@openssh.com":hostKeysProve(this,i,((e,t)=>{if(e)return;this.emit("hostkeys",t)}));if(n)G.requestSuccess();break;default:if(n)G.requestFailure()}},CHANNEL_OPEN:(e,t)=>{onCHANNEL_OPEN(this,t)},CHANNEL_OPEN_CONFIRMATION:(e,t)=>{const n=this._chanMgr.get(t.recipient);if(typeof n!=="function")return;const i=n.type==="sftp";const s=i?"session":n.type;const f={type:s,incoming:{id:t.recipient,window:J,packetSize:ee,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const u=i?new D(this,f,{debug:o}):new z(this,f);this._chanMgr.update(t.recipient,u);n(undefined,u)},CHANNEL_OPEN_FAILURE:(e,t,n,i)=>{const s=this._chanMgr.get(t);if(typeof s!=="function")return;const o={reason:n,description:i};oe(this,t,o,s)},CHANNEL_DATA:(e,t,n)=>{const i=this._chanMgr.get(t);if(typeof i!=="object"||i===null)return;if(i.incoming.window===0)return;i.incoming.window-=n.length;if(i.push(n)===false){i._waitChanDrain=true;return}if(i.incoming.window<=re)te(i)},CHANNEL_EXTENDED_DATA:(e,t,n,i)=>{if(i!==g)return;const s=this._chanMgr.get(t);if(typeof s!=="object"||s===null)return;if(s.incoming.window===0)return;s.incoming.window-=n.length;if(!s.stderr.push(n)){s._waitChanDrain=true;return}if(s.incoming.window<=re)te(s)},CHANNEL_WINDOW_ADJUST:(e,t,n)=>{const i=this._chanMgr.get(t);if(typeof i!=="object"||i===null)return;i.outgoing.window+=n;if(i._waitWindow){i._waitWindow=false;if(i._chunk){i._write(i._chunk,null,i._chunkcb)}else if(i._chunkcb){i._chunkcb()}else if(i._chunkErr){i.stderr._write(i._chunkErr,null,i._chunkcbErr)}else if(i._chunkcbErr){i._chunkcbErr()}}},CHANNEL_SUCCESS:(e,t)=>{const n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;this._resetKA();if(n._callbacks.length)n._callbacks.shift()(false)},CHANNEL_FAILURE:(e,t)=>{const n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;this._resetKA();if(n._callbacks.length)n._callbacks.shift()(true)},CHANNEL_REQUEST:(e,t,n,i,s)=>{const o=this._chanMgr.get(t);if(typeof o!=="object"||o===null)return;const f=o._exit;if(f.code!==undefined)return;switch(n){case"exit-status":o.emit("exit",f.code=s);return;case"exit-signal":o.emit("exit",f.code=null,f.signal=`SIG${s.signal}`,f.dump=s.coreDumped,f.desc=s.errorMessage);return}if(i)e.channelFailure(o.outgoing.id)},CHANNEL_EOF:(e,t)=>{const n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.incoming.state!=="open")return;n.incoming.state="eof";if(n.readable)n.push(null);if(n.stderr.readable)n.stderr.push(null)},CHANNEL_CLOSE:(e,t)=>{ae(this,t,this._chanMgr.get(t))}}});x.pause();const ce=this.config.keepaliveInterval;const fe=this.config.keepaliveCountMax;let ue=0;let le;const sendKA=()=>{if(++ue>fe){clearInterval(le);if(x.readable){const e=new Error("Keepalive timeout");e.level="client-timeout";this.emit("error",e);x.destroy()}return}if(se(x)){l.push(resetKA);G.ping()}else{clearInterval(le)}};function resetKA(){if(ce>0){ue=0;clearInterval(le);if(se(x))le=setInterval(sendKA,ce)}}this._resetKA=resetKA;const he=(()=>{let e=false;return()=>{if(e)return;e=true;if(pe&&!$){const e=W("Connection lost before handshake","protocol",true);this.emit("error",e)}}})();const de=(()=>{let e=false;return()=>{if(e)return;e=true;pe=true;o&&o("Socket connected");this.emit("connect");P.then((()=>{G.start();x.on("data",(e=>{try{G.parse(e,0,e.length)}catch(e){this.emit("error",e);try{if(se(x))x.end()}catch{}}}));if(x.stderr&&typeof x.stderr.resume==="function")x.stderr.resume();x.resume()})).catch((e=>{this.emit("error",e);try{if(se(x))x.end()}catch{}}))}})();let pe=false;x.on("connect",de).on("timeout",(()=>{this.emit("timeout")})).on("error",(e=>{o&&o(`Socket error: ${e.message}`);clearTimeout(this._readyTimeout);e.level="client-socket";this.emit("error",e)})).on("end",(()=>{o&&o("Socket ended");he();G.cleanup();clearTimeout(this._readyTimeout);clearInterval(le);this.emit("end")})).on("close",(()=>{o&&o("Socket closed");he();G.cleanup();clearTimeout(this._readyTimeout);clearInterval(le);this.emit("close");const e=l;l=this._callbacks=[];const t=new Error("No response from server");for(let n=0;n<e.length;++n)e[n](t);this._chanMgr.cleanup(t)}));let ge;let _e=null;let Ae=null;const Ee=["none"];if(this.config.password!==undefined)Ee.push("password");if(p!==undefined)Ee.push("publickey");if(this._agent!==undefined)Ee.push("agent");if(this.config.tryKeyboard)Ee.push("keyboard-interactive");if(p!==undefined&&this.config.localHostname!==undefined&&this.config.localUsername!==undefined){Ee.push("hostbased")}if(Array.isArray(s))s=makeSimpleAuthHandler(s);else if(typeof s!=="function")s=makeSimpleAuthHandler(Ee);let ye=false;const doNextAuth=e=>{if(ye)return;ye=true;if(e===false){const e=new Error("All configured authentication methods failed");e.level="client-authentication";this.emit("error",e);this.end();return}if(typeof e==="string"){const t=e;if(Ee.indexOf(t)===-1)return skipAuth(`Authentication method not allowed: ${t}`);const n=this.config.username;switch(t){case"password":e={type:t,username:n,password:this.config.password};break;case"publickey":e={type:t,username:n,key:p};break;case"hostbased":e={type:t,username:n,key:p,localHostname:this.config.localHostname,localUsername:this.config.localUsername};break;case"agent":e={type:t,username:n,agentCtx:new j(this._agent)};break;case"keyboard-interactive":e={type:t,username:n,prompt:(...e)=>this.emit("keyboard-interactive",...e)};break;case"none":e={type:t,username:n};break;default:return skipAuth(`Skipping unsupported authentication method: ${e}`)}}else if(typeof e!=="object"||e===null){return skipAuth(`Skipping invalid authentication attempt: ${e}`)}else{const t=e.username;if(typeof t!=="string"){return skipAuth(`Skipping invalid authentication attempt: ${e}`)}const n=e.type;switch(n){case"password":{const{password:i}=e;if(typeof i!=="string"&&!Buffer.isBuffer(i))return skipAuth("Skipping invalid password auth attempt");e={type:n,username:t,password:i};break}case"publickey":{const i=U(e.key,e.passphrase);if(i instanceof Error)return skipAuth("Skipping invalid key auth attempt");if(!i.isPrivateKey())return skipAuth("Skipping non-private key");e={type:n,username:t,key:i};break}case"hostbased":{const{localHostname:i,localUsername:s}=e;const o=U(e.key,e.passphrase);if(o instanceof Error||typeof i!=="string"||typeof s!=="string"){return skipAuth("Skipping invalid hostbased auth attempt")}if(!o.isPrivateKey())return skipAuth("Skipping non-private key");e={type:n,username:t,key:o,localHostname:i,localUsername:s};break}case"agent":{let i=e.agent;if(typeof i==="string"&&i.length){i=Y(i)}else if(!V(i)){return skipAuth(`Skipping invalid agent: ${e.agent}`)}e={type:n,username:t,agentCtx:new j(i)};break}case"keyboard-interactive":{const{prompt:i}=e;if(typeof i!=="function"){return skipAuth("Skipping invalid keyboard-interactive auth attempt")}e={type:n,username:t,prompt:i};break}case"none":e={type:n,username:t};break;default:return skipAuth(`Skipping unsupported authentication method: ${e}`)}}ge=e;try{const e=ge.username;switch(ge.type){case"password":G.authPassword(e,ge.password);break;case"publickey":G.authPK(e,ge.key);break;case"hostbased":G.authHostbased(e,ge.key,ge.localHostname,ge.localUsername,((e,t)=>{const n=ge.key.sign(e);if(n instanceof Error){n.message=`Error while signing with key: ${n.message}`;n.level="client-authentication";this.emit("error",n);return tryNextAuth()}t(n)}));break;case"agent":ge.agentCtx.init((e=>{if(e){e.level="agent";this.emit("error",e);return tryNextAuth()}tryNextAgentKey()}));break;case"keyboard-interactive":G.authKeyboard(e);break;case"none":G.authNone(e);break}}finally{ye=false}};function skipAuth(e){o&&o(e);process.nextTick(tryNextAuth)}function tryNextAuth(){ye=false;const e=s(Ae,_e,doNextAuth);if(ye||e===undefined)return;doNextAuth(e)}const tryNextAgentKey=()=>{if(ge.type==="agent"){const e=ge.agentCtx.nextKey();if(e===false){o&&o("Agent: No more keys left to try");o&&o("Client: agent auth failed");tryNextAuth()}else{const t=ge.agentCtx.pos();o&&o(`Agent: Trying key #${t+1}`);G.authPK(ge.username,e)}}};const startTimeout=()=>{if(this.config.readyTimeout>0){this._readyTimeout=setTimeout((()=>{const e=new Error("Timed out while waiting for handshake");e.level="client-timeout";this.emit("error",e);x.destroy()}),this.config.readyTimeout)}};if(!e.sock){let t=this.config.host;const n=this.config.forceIPv4;const i=this.config.forceIPv6;o&&o(`Client: Trying ${t} on port ${this.config.port} ...`);const doConnect=()=>{startTimeout();x.connect({host:t,port:this.config.port,localAddress:this.config.localAddress,localPort:this.config.localPort});x.setNoDelay(true);x.setMaxListeners(0);x.setTimeout(typeof e.timeout==="number"?e.timeout:0)};if(!n&&!i||n&&i){doConnect()}else{u(t,n?4:6,((e,i,s)=>{if(e){const i=n?"IPv4":"IPv6";const s=new Error(`Error while looking up ${i} address for '${t}': ${e}`);clearTimeout(this._readyTimeout);s.level="client-dns";this.emit("error",s);this.emit("close");return}t=i;doConnect()}))}}else{startTimeout();if(typeof x.connecting==="boolean"){if(!x.connecting){de()}}else{de()}}return this}end(){if(this._sock&&se(this._sock)){this._protocol.disconnect(C.BY_APPLICATION);this._sock.end()}return this}destroy(){this._sock&&se(this._sock)&&this._sock.destroy();return this}exec(e,t,n){if(!this._sock||!se(this._sock))throw new Error("Not connected");if(typeof t==="function"){n=t;t={}}const i={allowHalfOpen:t.allowHalfOpen!==false};openChannel(this,"session",i,((i,s)=>{if(i){n(i);return}const o=[];function reqCb(e){if(e){s.close();n(e);return}if(o.length)o.shift()()}if(this.config.allowAgentFwd===true||t&&t.agentForward===true&&this._agent!==undefined){o.push((()=>reqAgentFwd(s,reqCb)))}if(typeof t==="object"&&t!==null){if(typeof t.env==="object"&&t.env!==null)reqEnv(s,t.env);if(typeof t.pty==="object"&&t.pty!==null||t.pty===true){o.push((()=>reqPty(s,t.pty,reqCb)))}if(typeof t.x11==="object"&&t.x11!==null||t.x11==="number"||t.x11===true){o.push((()=>reqX11(s,t.x11,reqCb)))}}o.push((()=>reqExec(s,e,t,n)));o.shift()()}));return this}shell(e,t,n){if(!this._sock||!se(this._sock))throw new Error("Not connected");if(typeof e==="function"){n=e;e=t=undefined}else if(typeof t==="function"){n=t;t=undefined}if(e&&(e.x11!==undefined||e.env!==undefined)){t=e;e=undefined}openChannel(this,"session",((i,s)=>{if(i){n(i);return}const o=[];function reqCb(e){if(e){s.close();n(e);return}if(o.length)o.shift()()}if(this.config.allowAgentFwd===true||t&&t.agentForward===true&&this._agent!==undefined){o.push((()=>reqAgentFwd(s,reqCb)))}if(e!==false)o.push((()=>reqPty(s,e,reqCb)));if(typeof t==="object"&&t!==null){if(typeof t.env==="object"&&t.env!==null)reqEnv(s,t.env);if(typeof t.x11==="object"&&t.x11!==null||t.x11==="number"||t.x11===true){o.push((()=>reqX11(s,t.x11,reqCb)))}}o.push((()=>reqShell(s,n)));o.shift()()}));return this}subsys(e,t){if(!this._sock||!se(this._sock))throw new Error("Not connected");openChannel(this,"session",((n,i)=>{if(n){t(n);return}reqSubsystem(i,e,((e,n)=>{if(e){t(e);return}t(undefined,n)}))}));return this}forwardIn(e,t,n){if(!this._sock||!se(this._sock))throw new Error("Not connected");const i=typeof n==="function";if(i){this._callbacks.push(((i,s)=>{if(i){n(i!==true?i:new Error(`Unable to bind to ${e}:${t}`));return}let o=t;if(t===0&&s&&s.length>=4){o=$(s,0);if(!(this._protocol._compatFlags&p.DYN_RPORT_BUG))t=o}this._forwarding[`${e}:${t}`]=o;n(undefined,o)}))}this._protocol.tcpipForward(e,t,i);return this}unforwardIn(e,t,n){if(!this._sock||!se(this._sock))throw new Error("Not connected");const i=typeof n==="function";if(i){this._callbacks.push((i=>{if(i){n(i!==true?i:new Error(`Unable to unbind from ${e}:${t}`));return}delete this._forwarding[`${e}:${t}`];n()}))}this._protocol.cancelTcpipForward(e,t,i);return this}forwardOut(e,t,n,i,s){if(!this._sock||!se(this._sock))throw new Error("Not connected");const o={srcIP:e,srcPort:t,dstIP:n,dstPort:i};if(typeof s!=="function")s=noop;openChannel(this,"direct-tcpip",o,s);return this}openssh_noMoreSessions(e){if(!this._sock||!se(this._sock))throw new Error("Not connected");const t=typeof e==="function";if(!this.config.strictVendor||this.config.strictVendor&&ue.test(this._remoteVer)){if(t){this._callbacks.push((t=>{if(t){e(t!==true?t:new Error("Unable to disable future sessions"));return}e()}))}this._protocol.openssh_noMoreSessions(t);return this}if(!t)return this;process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}openssh_forwardInStreamLocal(e,t){if(!this._sock||!se(this._sock))throw new Error("Not connected");const n=typeof t==="function";if(!this.config.strictVendor||this.config.strictVendor&&ue.test(this._remoteVer)){if(n){this._callbacks.push((n=>{if(n){t(n!==true?n:new Error(`Unable to bind to ${e}`));return}this._forwardingUnix[e]=true;t()}))}this._protocol.openssh_streamLocalForward(e,n);return this}if(!n)return this;process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}openssh_unforwardInStreamLocal(e,t){if(!this._sock||!se(this._sock))throw new Error("Not connected");const n=typeof t==="function";if(!this.config.strictVendor||this.config.strictVendor&&ue.test(this._remoteVer)){if(n){this._callbacks.push((n=>{if(n){t(n!==true?n:new Error(`Unable to unbind from ${e}`));return}delete this._forwardingUnix[e];t()}))}this._protocol.openssh_cancelStreamLocalForward(e,n);return this}if(!n)return this;process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}openssh_forwardOutStreamLocal(e,t){if(!this._sock||!se(this._sock))throw new Error("Not connected");if(typeof t!=="function")t=noop;if(!this.config.strictVendor||this.config.strictVendor&&ue.test(this._remoteVer)){openChannel(this,"direct-streamlocal@openssh.com",{socketPath:e},t);return this}process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}sftp(e){if(!this._sock||!se(this._sock))throw new Error("Not connected");openChannel(this,"sftp",((t,n)=>{if(t){e(t);return}reqSubsystem(n,"sftp",((t,i)=>{if(t){e(t);return}function removeListeners(){n.removeListener("ready",onReady);n.removeListener("error",onError);n.removeListener("exit",onExit);n.removeListener("close",onExit)}function onReady(){removeListeners();e(undefined,n)}function onError(t){removeListeners();e(t)}function onExit(t,n){removeListeners();let i;if(typeof t==="number")i=`Received exit code ${t} while establishing SFTP session`;else if(n!==undefined)i=`Received signal ${n} while establishing SFTP session`;else i="Received unexpected SFTP session termination";const s=new Error(i);s.code=t;s.signal=n;e(s)}n.on("ready",onReady).on("error",onError).on("exit",onExit).on("close",onExit);n._init()}))}));return this}}function openChannel(e,t,n,i){const s=J;const o=ee;if(typeof n==="function"){i=n;n={}}const wrapper=(e,t)=>{i(e,t)};wrapper.type=t;const f=e._chanMgr.add(wrapper);if(f===-1){i(new Error("No free channels available"));return}switch(t){case"session":case"sftp":e._protocol.session(f,s,o);break;case"direct-tcpip":e._protocol.directTcpip(f,s,o,n);break;case"direct-streamlocal@openssh.com":e._protocol.openssh_directStreamLocal(f,s,o,n);break;default:throw new Error(`Unsupported channel type: ${t}`)}}function reqX11(e,t,n){const i={single:false,protocol:"MIT-MAGIC-COOKIE-1",cookie:undefined,screen:0};if(typeof t==="function"){n=t}else if(typeof t==="object"&&t!==null){if(typeof t.single==="boolean")i.single=t.single;if(typeof t.screen==="number")i.screen=t.screen;if(typeof t.protocol==="string")i.protocol=t.protocol;if(typeof t.cookie==="string")i.cookie=t.cookie;else if(Buffer.isBuffer(t.cookie))i.cookie=t.cookie.hexSlice(0,t.cookie.length)}if(i.cookie===undefined)i.cookie=le();const s=typeof n==="function";if(e.outgoing.state!=="open"){if(s)n(new Error("Channel is not open"));return}if(s){e._callbacks.push((t=>{if(t){n(t!==true?t:new Error("Unable to request X11"));return}e._hasX11=true;++e._client._acceptX11;e.once("close",(()=>{if(e._client._acceptX11)--e._client._acceptX11}));n()}))}e._client._protocol.x11Forward(e.outgoing.id,i,s)}function reqPty(e,t,n){let i=24;let s=80;let o=640;let f=480;let u="vt100";let l=null;if(typeof t==="function"){n=t}else if(typeof t==="object"&&t!==null){if(typeof t.rows==="number")i=t.rows;if(typeof t.cols==="number")s=t.cols;if(typeof t.width==="number")o=t.width;if(typeof t.height==="number")f=t.height;if(typeof t.term==="string")u=t.term;if(typeof t.modes==="object")l=t.modes}const h=typeof n==="function";if(e.outgoing.state!=="open"){if(h)n(new Error("Channel is not open"));return}if(h){e._callbacks.push((e=>{if(e){n(e!==true?e:new Error("Unable to request a pseudo-terminal"));return}n()}))}e._client._protocol.pty(e.outgoing.id,i,s,f,o,u,l,h)}function reqAgentFwd(e,t){const n=typeof t==="function";if(e.outgoing.state!=="open"){n&&t(new Error("Channel is not open"));return}if(e._client._agentFwdEnabled){n&&t(false);return}e._client._agentFwdEnabled=true;e._callbacks.push((i=>{if(i){e._client._agentFwdEnabled=false;if(n){t(i!==true?i:new Error("Unable to request agent forwarding"))}return}if(n)t()}));e._client._protocol.openssh_agentForward(e.outgoing.id,true)}function reqShell(e,t){if(e.outgoing.state!=="open"){t(new Error("Channel is not open"));return}e._callbacks.push((n=>{if(n){t(n!==true?n:new Error("Unable to open shell"));return}e.subtype="shell";t(undefined,e)}));e._client._protocol.shell(e.outgoing.id,true)}function reqExec(e,t,n,i){if(e.outgoing.state!=="open"){i(new Error("Channel is not open"));return}e._callbacks.push((t=>{if(t){i(t!==true?t:new Error("Unable to exec"));return}e.subtype="exec";e.allowHalfOpen=n.allowHalfOpen!==false;i(undefined,e)}));e._client._protocol.exec(e.outgoing.id,t,true)}function reqEnv(e,t){if(e.outgoing.state!=="open")return;const n=Object.keys(t||{});for(let i=0;i<n.length;++i){const s=n[i];const o=t[s];e._client._protocol.env(e.outgoing.id,s,o,false)}}function reqSubsystem(e,t,n){if(e.outgoing.state!=="open"){n(new Error("Channel is not open"));return}e._callbacks.push((i=>{if(i){n(i!==true?i:new Error(`Unable to start subsystem: ${t}`));return}e.subtype="subsystem";n(undefined,e)}));e._client._protocol.subsystem(e.outgoing.id,t,true)}function onCHANNEL_OPEN(e,t){let n=-1;let i;const accept=()=>{const i={type:t.type,incoming:{id:n,window:J,packetSize:ee,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const s=new z(e,i);e._chanMgr.update(n,s);e._protocol.channelOpenConfirm(t.sender,n,J,ee);return s};const reject=()=>{if(i===undefined){if(n===-1)i=_.RESOURCE_SHORTAGE;else i=_.CONNECT_FAILED}if(n!==-1)e._chanMgr.remove(n);e._protocol.channelOpenFail(t.sender,i,"")};const reserveChannel=()=>{n=e._chanMgr.add();if(n===-1){i=_.RESOURCE_SHORTAGE;if(e.config.debug){e.config.debug("Client: Automatic rejection of incoming channel open: "+"no channels available")}}return n!==-1};const s=t.data;switch(t.type){case"forwarded-tcpip":{const t=e._forwarding[`${s.destIP}:${s.destPort}`];if(t!==undefined&&reserveChannel()){if(s.destPort===0)s.destPort=t;e.emit("tcp connection",s,accept,reject);return}break}case"forwarded-streamlocal@openssh.com":if(e._forwardingUnix[s.socketPath]!==undefined&&reserveChannel()){e.emit("unix connection",s,accept,reject);return}break;case"auth-agent@openssh.com":if(e._agentFwdEnabled&&typeof e._agent.getStream==="function"&&reserveChannel()){e._agent.getStream(((e,t)=>{if(e)return reject();const n=accept();n.pipe(t).pipe(n)}));return}break;case"x11":if(e._acceptX11!==0&&reserveChannel()){e.emit("x11",s,accept,reject);return}break;default:i=_.UNKNOWN_CHANNEL_TYPE;if(e.config.debug){e.config.debug("Client: Automatic rejection of unsupported incoming channel open "+`type: ${t.type}`)}}if(i===undefined){i=_.ADMINISTRATIVELY_PROHIBITED;if(e.config.debug){e.config.debug("Client: Automatic rejection of unexpected incoming channel open for: "+t.type)}}reject()}const le=(()=>{const e=Buffer.allocUnsafe(16);return()=>{o(e,0,16);return e.hexSlice(0,16)}})();function makeSimpleAuthHandler(e){if(!Array.isArray(e))throw new Error("authList must be an array");let t=0;return(n,i,s)=>{if(t===e.length)return false;return e[t++]}}function hostKeysProve(e,t,n){if(!e._sock||!se(e._sock))return;if(typeof n!=="function")n=noop;if(!Array.isArray(t))throw new TypeError("Invalid keys argument type");const i=[];for(const e of t){const t=U(e);if(t instanceof Error)throw t;i.push(t)}if(!e.config.strictVendor||e.config.strictVendor&&ue.test(e._remoteVer)){e._callbacks.push(((t,s)=>{if(t){n(t!==true?t:new Error("Server failed to prove supplied keys"));return}const o=[];let f=0;ce.init(s,0);while(ce.avail()){if(f===i.length)break;const t=i[f++];const n=t.getPublicSSH();const s=ce.readString();fe.init(s,0);const u=fe.readString(true);let l=fe.readString();let h;if(u!==t.type){if(t.type==="ssh-rsa"){switch(u){case"rsa-sha2-256":h="sha256";break;case"rsa-sha2-512":h="sha512";break;default:continue}}else{continue}}const p=e._protocol._kex.sessionID;const g=Buffer.allocUnsafe(4+29+4+p.length+4+n.length);let _=0;G(g,29,_);g.utf8Write("hostkeys-prove-00@openssh.com",_+=4,29);G(g,p.length,_+=29);x(p,g,0,p.length,_+=4);G(g,n.length,_+=p.length);x(n,g,0,n.length,_+=4);if(!(l=q(l,u)))continue;if(t.verify(g,l,h)===true)o.push(t)}fe.clear();ce.clear();n(null,o)}));e._protocol.openssh_hostKeysProve(i);return}process.nextTick(n,new Error("strictVendor enabled and server is not OpenSSH or compatible version"))}e.exports=Client},2994:(e,t,n)=>{"use strict";const{Agent:i}=n(3685);const{Agent:s}=n(5687);const{connect:o}=n(4404);let f;for(const e of[i,s]){class SSHAgent extends e{constructor(e,t){super(t);this._connectCfg=e;this._defaultSrcIP=t&&t.srcIP||"localhost"}createConnection(t,i){const s=t&&t.localAddress||this._defaultSrcIP;const o=t&&t.localPort||0;const u=t.host;const l=t.port;if(f===undefined)f=n(6063);const h=new f;let p=false;h.on("ready",(()=>{h.forwardOut(s,o,u,l,((n,s)=>{p=true;if(n){h.end();return i(n)}s.once("close",(()=>h.end()));i(null,decorateStream(s,e,t))}))})).on("error",i).on("close",(()=>{if(!p)i(new Error("Unexpected connection close"))})).connect(this._connectCfg)}}t[e===i?"SSHTTPAgent":"SSHTTPSAgent"]=SSHAgent}function noop(){}function decorateStream(e,t,n){if(t===i){e.setKeepAlive=noop;e.setNoDelay=noop;e.setTimeout=noop;e.ref=noop;e.unref=noop;e.destroySoon=e.destroy;return e}n.socket=e;const s=o(n);const f=(()=>{let t=false;return()=>{if(t)return;t=true;if(e.isPaused())e.resume()}})();s.on("end",f).on("close",f);return s}},5869:(e,t,n)=>{"use strict";const{AgentProtocol:i,BaseAgent:s,createAgent:o,CygwinAgent:f,OpenSSHAgent:u,PageantAgent:l}=n(9054);const{SSHTTPAgent:h,SSHTTPSAgent:p}=n(2994);const{parseKey:g}=n(2218);const{flagsToString:_,OPEN_MODE:E,STATUS_CODE:y,stringToFlags:b}=n(2026);e.exports={AgentProtocol:i,BaseAgent:s,createAgent:o,Client:n(6063),CygwinAgent:f,HTTPAgent:h,HTTPSAgent:p,OpenSSHAgent:u,PageantAgent:l,Server:n(2986),utils:{parseKey:g,sftp:{flagsToString:_,OPEN_MODE:E,STATUS_CODE:y,stringToFlags:b}}}},9031:(e,t,n)=>{"use strict";const{inspect:i}=n(3837);const{bindingAvailable:s,NullCipher:o,NullDecipher:f}=n(5708);const{COMPAT_CHECKS:u,DISCONNECT_REASON:l,MESSAGE:h,SIGNALS:p,TERMINAL_MODE:g}=n(6832);const{DEFAULT_KEXINIT:_,KexInit:E,kexinit:y,onKEXPayload:b}=n(4126);const{parseKey:w}=n(2218);const I=n(172);const{bufferCopy:C,bufferFill:v,bufferSlice:k,convertSignature:R,sendPacket:B,writeUInt32BE:T}=n(9475);const{PacketReader:O,PacketWriter:P,ZlibPacketReader:L,ZlibPacketWriter:U}=n(6715);const D=n(6674).i8;const x=new Map(Object.values(l).map((e=>[e,1])));const Q=Buffer.from(`SSH-2.0-ssh2js${D}`);const W=Buffer.from(`${Q}\r\n`);const $=8192;const q=1024;const G=Buffer.from([h.GLOBAL_REQUEST,0,0,0,21,107,101,101,112,97,108,105,118,101,64,111,112,101,110,115,115,104,46,99,111,109,1]);const j=Buffer.from([g.TTY_OP_END]);function noop(){}class Protocol{constructor(e){const t=e.onWrite;if(typeof t!=="function")throw new Error("Missing onWrite function");this._onWrite=e=>{t(e)};const n=e.onError;if(typeof n!=="function")throw new Error("Missing onError function");this._onError=e=>{n(e)};const f=e.debug;this._debug=typeof f==="function"?e=>{f(e)}:undefined;const u=e.onHeader;this._onHeader=typeof u==="function"?(...e)=>{u(...e)}:noop;const l=e.onPacket;this._onPacket=typeof l==="function"?()=>{l()}:noop;let h=e.onHandshakeComplete;if(typeof h!=="function")h=noop;this._onHandshakeComplete=(...e)=>{this._debug&&this._debug("Handshake completed");const t=this._queue;if(t){this._queue=undefined;this._debug&&this._debug(`Draining outbound queue (${t.length}) ...`);for(let e=0;e<t.length;++e){const n=t[e];let i=this._packetRW.write.finalize(n);if(i===n){const e=this._cipher.allocPacket(n.length);e.set(n,5);i=e}B(this,i)}this._debug&&this._debug("... finished draining outbound queue")}h(...e)};this._queue=undefined;const p=e.messageHandlers;if(typeof p==="object"&&p!==null)this._handlers=p;else this._handlers={};this._onPayload=onPayload.bind(this);this._server=!!e.server;this._banner=undefined;let g;if(this._server){if(typeof e.hostKeys!=="object"||e.hostKeys===null)throw new Error("Missing server host key(s)");this._hostKeys=e.hostKeys;if(typeof e.greeting==="string"&&e.greeting.length){g=e.greeting.slice(-2)==="\r\n"?e.greeting:`${e.greeting}\r\n`}if(typeof e.banner==="string"&&e.banner.length){this._banner=e.banner.slice(-2)==="\r\n"?e.banner:`${e.banner}\r\n`}}else{this._hostKeys=undefined}let y=e.offer;if(typeof y!=="object"||y===null)y=_;else if(y.constructor!==E)y=new E(y);this._kex=undefined;this._kexinit=undefined;this._offer=y;this._cipher=new o(0,this._onWrite);this._decipher=undefined;this._skipNextInboundPacket=false;this._packetRW={read:new O,write:new P(this)};this._hostVerifier=!this._server&&typeof e.hostVerifier==="function"?e.hostVerifier:undefined;this._parse=parseHeader;this._buffer=undefined;this._authsQueue=[];this._authenticated=false;this._remoteIdentRaw=undefined;let b;if(typeof e.ident==="string"){this._identRaw=Buffer.from(`SSH-2.0-${e.ident}`);b=Buffer.allocUnsafe(this._identRaw.length+2);b.set(this._identRaw,0);b[b.length-2]=13;b[b.length-1]=10}else if(Buffer.isBuffer(e.ident)){const t=Buffer.allocUnsafe(8+e.ident.length);t.latin1Write("SSH-2.0-",0,8);t.set(e.ident,8);this._identRaw=t;b=Buffer.allocUnsafe(t.length+2);b.set(t,0);b[b.length-2]=13;b[b.length-1]=10}else{this._identRaw=Q;b=W}this._compatFlags=0;if(this._debug){if(s)this._debug("Custom crypto binding available");else this._debug("Custom crypto binding not available")}this._debug&&this._debug(`Local ident: ${i(this._identRaw.toString())}`);this.start=()=>{this.start=undefined;if(g)this._onWrite(g);this._onWrite(b)}}_destruct(e){this._packetRW.read.cleanup();this._packetRW.write.cleanup();this._cipher&&this._cipher.free();this._decipher&&this._decipher.free();if(typeof e!=="string"||e.length===0)e="fatal error";this.parse=()=>{throw new Error(`Instance unusable after ${e}`)};this._onWrite=()=>{throw new Error(`Instance unusable after ${e}`)};this._destruct=undefined}cleanup(){this._destruct&&this._destruct()}parse(e,t,n){while(t<n)t=this._parse(e,t,n)}disconnect(e){const t=1+4+4+4;let n=this._packetRW.write.allocStartKEX;const i=this._packetRW.write.alloc(t,true);const s=n+t;if(!x.has(e))e=l.PROTOCOL_ERROR;i[n]=h.DISCONNECT;T(i,e,++n);i.fill(0,n+=4,s);this._debug&&this._debug(`Outbound: Sending DISCONNECT (${e})`);B(this,this._packetRW.write.finalize(i,true),true)}ping(){const e=this._packetRW.write.allocStart;const t=this._packetRW.write.alloc(G.length);t.set(G,e);this._debug&&this._debug("Outbound: Sending ping (GLOBAL_REQUEST: keepalive@openssh.com)");B(this,this._packetRW.write.finalize(t))}rekey(){if(this._kexinit===undefined){this._debug&&this._debug("Outbound: Initiated explicit rekey");this._queue=[];y(this)}else{this._debug&&this._debug("Outbound: Ignoring rekey during handshake")}}requestSuccess(e){let t=this._packetRW.write.allocStart;let n;if(Buffer.isBuffer(e)){n=this._packetRW.write.alloc(1+e.length);n[t]=h.REQUEST_SUCCESS;n.set(e,++t)}else{n=this._packetRW.write.alloc(1);n[t]=h.REQUEST_SUCCESS}this._debug&&this._debug("Outbound: Sending REQUEST_SUCCESS");B(this,this._packetRW.write.finalize(n))}requestFailure(){const e=this._packetRW.write.allocStart;const t=this._packetRW.write.alloc(1);t[e]=h.REQUEST_FAILURE;this._debug&&this._debug("Outbound: Sending REQUEST_FAILURE");B(this,this._packetRW.write.finalize(t))}channelSuccess(e){let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[t]=h.CHANNEL_SUCCESS;T(n,e,++t);this._debug&&this._debug(`Outbound: Sending CHANNEL_SUCCESS (r:${e})`);B(this,this._packetRW.write.finalize(n))}channelFailure(e){let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[t]=h.CHANNEL_FAILURE;T(n,e,++t);this._debug&&this._debug(`Outbound: Sending CHANNEL_FAILURE (r:${e})`);B(this,this._packetRW.write.finalize(n))}channelEOF(e){let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[t]=h.CHANNEL_EOF;T(n,e,++t);this._debug&&this._debug(`Outbound: Sending CHANNEL_EOF (r:${e})`);B(this,this._packetRW.write.finalize(n))}channelClose(e){let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[t]=h.CHANNEL_CLOSE;T(n,e,++t);this._debug&&this._debug(`Outbound: Sending CHANNEL_CLOSE (r:${e})`);B(this,this._packetRW.write.finalize(n))}channelWindowAdjust(e,t){let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+4);i[n]=h.CHANNEL_WINDOW_ADJUST;T(i,e,++n);T(i,t,n+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_WINDOW_ADJUST (r:${e}, ${t})`);B(this,this._packetRW.write.finalize(i))}channelData(e,t){const n=Buffer.isBuffer(t);const i=n?t.length:Buffer.byteLength(t);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+4+i);o[s]=h.CHANNEL_DATA;T(o,e,++s);T(o,i,s+=4);if(n)o.set(t,s+=4);else o.utf8Write(t,s+=4,i);this._debug&&this._debug(`Outbound: Sending CHANNEL_DATA (r:${e}, ${i})`);B(this,this._packetRW.write.finalize(o))}channelExtData(e,t,n){const i=Buffer.isBuffer(t);const s=i?t.length:Buffer.byteLength(t);let o=this._packetRW.write.allocStart;const f=this._packetRW.write.alloc(1+4+4+4+s);f[o]=h.CHANNEL_EXTENDED_DATA;T(f,e,++o);T(f,n,o+=4);T(f,s,o+=4);if(i)f.set(t,o+=4);else f.utf8Write(t,o+=4,s);this._debug&&this._debug(`Outbound: Sending CHANNEL_EXTENDED_DATA (r:${e})`);B(this,this._packetRW.write.finalize(f))}channelOpenConfirm(e,t,n,i){let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+4+4+4);o[s]=h.CHANNEL_OPEN_CONFIRMATION;T(o,e,++s);T(o,t,s+=4);T(o,n,s+=4);T(o,i,s+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_CONFIRMATION (r:${e}, l:${t})`);B(this,this._packetRW.write.finalize(o))}channelOpenFail(e,t,n){if(typeof n!=="string")n="";const i=Buffer.byteLength(n);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+4+4+i+4);o[s]=h.CHANNEL_OPEN_FAILURE;T(o,e,++s);T(o,t,s+=4);T(o,i,s+=4);s+=4;if(i){o.utf8Write(n,s,i);s+=i}T(o,0,s);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_FAILURE (r:${e})`);B(this,this._packetRW.write.finalize(o))}service(e){if(this._server)throw new Error("Client-only method called in server mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+t);i[n]=h.SERVICE_REQUEST;T(i,t,++n);i.utf8Write(e,n+=4,t);this._debug&&this._debug(`Outbound: Sending SERVICE_REQUEST (${e})`);B(this,this._packetRW.write.finalize(i))}authPassword(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(e);const s=Buffer.byteLength(t);const o=n?Buffer.byteLength(n):0;let f=this._packetRW.write.allocStart;const u=this._packetRW.write.alloc(1+4+i+4+14+4+8+1+4+s+(n?4+o:0));u[f]=h.USERAUTH_REQUEST;T(u,i,++f);u.utf8Write(e,f+=4,i);T(u,14,f+=i);u.utf8Write("ssh-connection",f+=4,14);T(u,8,f+=14);u.utf8Write("password",f+=4,8);u[f+=8]=n?1:0;T(u,s,++f);if(Buffer.isBuffer(t))C(t,u,0,s,f+=4);else u.utf8Write(t,f+=4,s);if(n){T(u,o,f+=s);if(Buffer.isBuffer(n))C(n,u,0,o,f+=4);else u.utf8Write(n,f+=4,o);this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (changed password)")}else{this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (password)")}this._authsQueue.push("password");B(this,this._packetRW.write.finalize(u))}authPK(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");t=w(t);if(t instanceof Error)throw new Error("Invalid key");const i=t.type;t=t.getPublicSSH();const s=Buffer.byteLength(e);const o=Buffer.byteLength(i);const f=t.length;const u=this._kex.sessionID;const l=u.length;const p=(n?4+l:0)+1+4+s+4+14+4+9+1+4+o+4+f;let g;let _;if(n){g=Buffer.allocUnsafe(p);_=0;T(g,l,_);g.set(u,_+=4);_+=l}else{g=this._packetRW.write.alloc(p);_=this._packetRW.write.allocStart}g[_]=h.USERAUTH_REQUEST;T(g,s,++_);g.utf8Write(e,_+=4,s);T(g,14,_+=s);g.utf8Write("ssh-connection",_+=4,14);T(g,9,_+=14);g.utf8Write("publickey",_+=4,9);g[_+=9]=n?1:0;T(g,o,++_);g.utf8Write(i,_+=4,o);T(g,f,_+=o);g.set(t,_+=4);if(!n){this._authsQueue.push("publickey");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey -- check)");B(this,this._packetRW.write.finalize(g));return}n(g,(n=>{n=R(n,i);if(n===false)throw new Error("Error while converting handshake signature");const u=n.length;_=this._packetRW.write.allocStart;g=this._packetRW.write.alloc(1+4+s+4+14+4+9+1+4+o+4+f+4+4+o+4+u);g[_]=h.USERAUTH_REQUEST;T(g,s,++_);g.utf8Write(e,_+=4,s);T(g,14,_+=s);g.utf8Write("ssh-connection",_+=4,14);T(g,9,_+=14);g.utf8Write("publickey",_+=4,9);g[_+=9]=1;T(g,o,++_);g.utf8Write(i,_+=4,o);T(g,f,_+=o);g.set(t,_+=4);T(g,4+o+4+u,_+=f);T(g,o,_+=4);g.utf8Write(i,_+=4,o);T(g,u,_+=o);g.set(n,_+=4);this._authsQueue.push("publickey");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey)");B(this,this._packetRW.write.finalize(g))}))}authHostbased(e,t,n,i,s){if(this._server)throw new Error("Client-only method called in server mode");t=w(t);if(t instanceof Error)throw new Error("Invalid key");const o=t.type;t=t.getPublicSSH();const f=Buffer.byteLength(e);const u=Buffer.byteLength(o);const l=t.length;const p=this._kex.sessionID;const g=p.length;const _=Buffer.byteLength(n);const E=Buffer.byteLength(i);const y=Buffer.allocUnsafe(4+g+1+4+f+4+14+4+9+4+u+4+l+4+_+4+E);let b=0;T(y,g,b);y.set(p,b+=4);y[b+=g]=h.USERAUTH_REQUEST;T(y,f,++b);y.utf8Write(e,b+=4,f);T(y,14,b+=f);y.utf8Write("ssh-connection",b+=4,14);T(y,9,b+=14);y.utf8Write("hostbased",b+=4,9);T(y,u,b+=9);y.utf8Write(o,b+=4,u);T(y,l,b+=u);y.set(t,b+=4);T(y,_,b+=l);y.utf8Write(n,b+=4,_);T(y,E,b+=_);y.utf8Write(i,b+=4,E);s(y,(e=>{e=R(e,o);if(!e)throw new Error("Error while converting handshake signature");const t=e.length;const n=y.length-g-4;b=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(n+4+4+u+4+t);C(y,i,4+g,y.length,b);T(i,4+u+4+t,b+=n);T(i,u,b+=4);i.utf8Write(o,b+=4,u);T(i,t,b+=u);i.set(e,b+=4);this._authsQueue.push("hostbased");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (hostbased)");B(this,this._packetRW.write.finalize(i))}))}authKeyboard(e){if(this._server)throw new Error("Client-only method called in server mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+t+4+14+4+20+4+4);i[n]=h.USERAUTH_REQUEST;T(i,t,++n);i.utf8Write(e,n+=4,t);T(i,14,n+=t);i.utf8Write("ssh-connection",n+=4,14);T(i,20,n+=14);i.utf8Write("keyboard-interactive",n+=4,20);T(i,0,n+=20);T(i,0,n+=4);this._authsQueue.push("keyboard-interactive");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (keyboard-interactive)");B(this,this._packetRW.write.finalize(i))}authNone(e){if(this._server)throw new Error("Client-only method called in server mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+t+4+14+4+4);i[n]=h.USERAUTH_REQUEST;T(i,t,++n);i.utf8Write(e,n+=4,t);T(i,14,n+=t);i.utf8Write("ssh-connection",n+=4,14);T(i,4,n+=14);i.utf8Write("none",n+=4,4);this._authsQueue.push("none");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (none)");B(this,this._packetRW.write.finalize(i))}authInfoRes(e){if(this._server)throw new Error("Client-only method called in server mode");let t=0;let n;if(e){n=new Array(e.length);for(let i=0;i<e.length;++i){const s=Buffer.byteLength(e[i]);n[i]=s;t+=4+s}}let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+t);s[i]=h.USERAUTH_INFO_RESPONSE;if(e){T(s,e.length,++i);i+=4;for(let t=0;t<e.length;++t){const o=n[t];T(s,o,i);i+=4;if(o){s.utf8Write(e[t],i,o);i+=o}}}else{T(s,0,++i)}this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_RESPONSE");B(this,this._packetRW.write.finalize(s))}tcpipForward(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(e);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+13+1+4+i+4);o[s]=h.GLOBAL_REQUEST;T(o,13,++s);o.utf8Write("tcpip-forward",s+=4,13);o[s+=13]=n===undefined||n===true?1:0;T(o,i,++s);o.utf8Write(e,s+=4,i);T(o,t,s+=i);this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (tcpip-forward)");B(this,this._packetRW.write.finalize(o))}cancelTcpipForward(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(e);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+20+1+4+i+4);o[s]=h.GLOBAL_REQUEST;T(o,20,++s);o.utf8Write("cancel-tcpip-forward",s+=4,20);o[s+=20]=n===undefined||n===true?1:0;T(o,i,++s);o.utf8Write(e,s+=4,i);T(o,t,s+=i);this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (cancel-tcpip-forward)");B(this,this._packetRW.write.finalize(o))}openssh_streamLocalForward(e,t){if(this._server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+31+1+4+n);s[i]=h.GLOBAL_REQUEST;T(s,31,++i);s.utf8Write("streamlocal-forward@openssh.com",i+=4,31);s[i+=31]=t===undefined||t===true?1:0;T(s,n,++i);s.utf8Write(e,i+=4,n);this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (streamlocal-forward@openssh.com)");B(this,this._packetRW.write.finalize(s))}openssh_cancelStreamLocalForward(e,t){if(this._server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+38+1+4+n);s[i]=h.GLOBAL_REQUEST;T(s,38,++i);s.utf8Write("cancel-streamlocal-forward@openssh.com",i+=4,38);s[i+=38]=t===undefined||t===true?1:0;T(s,n,++i);s.utf8Write(e,i+=4,n);if(this._debug){this._debug("Outbound: Sending GLOBAL_REQUEST "+"(cancel-streamlocal-forward@openssh.com)")}B(this,this._packetRW.write.finalize(s))}directTcpip(e,t,n,i){if(this._server)throw new Error("Client-only method called in server mode");const s=Buffer.byteLength(i.srcIP);const o=Buffer.byteLength(i.dstIP);let f=this._packetRW.write.allocStart;const u=this._packetRW.write.alloc(1+4+12+4+4+4+4+s+4+4+o+4);u[f]=h.CHANNEL_OPEN;T(u,12,++f);u.utf8Write("direct-tcpip",f+=4,12);T(u,e,f+=12);T(u,t,f+=4);T(u,n,f+=4);T(u,o,f+=4);u.utf8Write(i.dstIP,f+=4,o);T(u,i.dstPort,f+=o);T(u,s,f+=4);u.utf8Write(i.srcIP,f+=4,s);T(u,i.srcPort,f+=s);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, direct-tcpip)`);B(this,this._packetRW.write.finalize(u))}openssh_directStreamLocal(e,t,n,i){if(this._server)throw new Error("Client-only method called in server mode");const s=Buffer.byteLength(i.socketPath);let o=this._packetRW.write.allocStart;const f=this._packetRW.write.alloc(1+4+30+4+4+4+4+s+4+4);f[o]=h.CHANNEL_OPEN;T(f,30,++o);f.utf8Write("direct-streamlocal@openssh.com",o+=4,30);T(f,e,o+=30);T(f,t,o+=4);T(f,n,o+=4);T(f,s,o+=4);f.utf8Write(i.socketPath,o+=4,s);v(f,0,o+=s,o+8);if(this._debug){this._debug("Outbound: Sending CHANNEL_OPEN "+`(r:${e}, direct-streamlocal@openssh.com)`)}B(this,this._packetRW.write.finalize(f))}openssh_noMoreSessions(e){if(this._server)throw new Error("Client-only method called in server mode");let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4+28+1);n[t]=h.GLOBAL_REQUEST;T(n,28,++t);n.utf8Write("no-more-sessions@openssh.com",t+=4,28);n[t+=28]=e===undefined||e===true?1:0;this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (no-more-sessions@openssh.com)");B(this,this._packetRW.write.finalize(n))}session(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+7+4+4+4);s[i]=h.CHANNEL_OPEN;T(s,7,++i);s.utf8Write("session",i+=4,7);T(s,e,i+=7);T(s,t,i+=4);T(s,n,i+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, session)`);B(this,this._packetRW.write.finalize(s))}windowChange(e,t,n,i,s){if(this._server)throw new Error("Client-only method called in server mode");let o=this._packetRW.write.allocStart;const f=this._packetRW.write.alloc(1+4+4+13+1+4+4+4+4);f[o]=h.CHANNEL_REQUEST;T(f,e,++o);T(f,13,o+=4);f.utf8Write("window-change",o+=4,13);f[o+=13]=0;T(f,n,++o);T(f,t,o+=4);T(f,s,o+=4);T(f,i,o+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, window-change)`);B(this,this._packetRW.write.finalize(f))}pty(e,t,n,i,s,o,f,u){if(this._server)throw new Error("Client-only method called in server mode");if(!o||!o.length)o="vt100";if(f&&!Buffer.isBuffer(f)&&!Array.isArray(f)&&typeof f==="object"&&f!==null){f=modesToBytes(f)}if(!f||!f.length)f=j;const l=o.length;const p=f.length;let g=this._packetRW.write.allocStart;const _=this._packetRW.write.alloc(1+4+4+7+1+4+l+4+4+4+4+4+p);_[g]=h.CHANNEL_REQUEST;T(_,e,++g);T(_,7,g+=4);_.utf8Write("pty-req",g+=4,7);_[g+=7]=u===undefined||u===true?1:0;T(_,l,++g);_.utf8Write(o,g+=4,l);T(_,n,g+=l);T(_,t,g+=4);T(_,s,g+=4);T(_,i,g+=4);T(_,p,g+=4);g+=4;if(Array.isArray(f)){for(let e=0;e<p;++e)_[g++]=f[e]}else if(Buffer.isBuffer(f)){_.set(f,g)}this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, pty-req)`);B(this,this._packetRW.write.finalize(_))}shell(e,t){if(this._server)throw new Error("Client-only method called in server mode");let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+4+5+1);i[n]=h.CHANNEL_REQUEST;T(i,e,++n);T(i,5,n+=4);i.utf8Write("shell",n+=4,5);i[n+=5]=t===undefined||t===true?1:0;this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, shell)`);B(this,this._packetRW.write.finalize(i))}exec(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.isBuffer(t);const s=i?t.length:Buffer.byteLength(t);let o=this._packetRW.write.allocStart;const f=this._packetRW.write.alloc(1+4+4+4+1+4+s);f[o]=h.CHANNEL_REQUEST;T(f,e,++o);T(f,4,o+=4);f.utf8Write("exec",o+=4,4);f[o+=4]=n===undefined||n===true?1:0;T(f,s,++o);if(i)f.set(t,o+=4);else f.utf8Write(t,o+=4,s);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, exec: ${t})`);B(this,this._packetRW.write.finalize(f))}signal(e,t){if(this._server)throw new Error("Client-only method called in server mode");const n=t;t=t.toUpperCase();if(t.slice(0,3)==="SIG")t=t.slice(3);if(p[t]!==1)throw new Error(`Invalid signal: ${n}`);const i=t.length;let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+4+6+1+4+i);o[s]=h.CHANNEL_REQUEST;T(o,e,++s);T(o,6,s+=4);o.utf8Write("signal",s+=4,6);o[s+=6]=0;T(o,i,++s);o.utf8Write(t,s+=4,i);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, signal: ${t})`);B(this,this._packetRW.write.finalize(o))}env(e,t,n,i){if(this._server)throw new Error("Client-only method called in server mode");const s=Buffer.byteLength(t);const o=Buffer.isBuffer(n);const f=o?n.length:Buffer.byteLength(n);let u=this._packetRW.write.allocStart;const l=this._packetRW.write.alloc(1+4+4+3+1+4+s+4+f);l[u]=h.CHANNEL_REQUEST;T(l,e,++u);T(l,3,u+=4);l.utf8Write("env",u+=4,3);l[u+=3]=i===undefined||i===true?1:0;T(l,s,++u);l.utf8Write(t,u+=4,s);T(l,f,u+=s);if(o)l.set(n,u+=4);else l.utf8Write(n,u+=4,f);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, env: ${t}=${n})`);B(this,this._packetRW.write.finalize(l))}x11Forward(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const i=t.protocol;const s=t.cookie;const o=Buffer.isBuffer(i);const f=o?i.length:Buffer.byteLength(i);const u=Buffer.isBuffer(s);const l=u?s.length:Buffer.byteLength(s);let p=this._packetRW.write.allocStart;const g=this._packetRW.write.alloc(1+4+4+7+1+1+4+f+4+l+4);g[p]=h.CHANNEL_REQUEST;T(g,e,++p);T(g,7,p+=4);g.utf8Write("x11-req",p+=4,7);g[p+=7]=n===undefined||n===true?1:0;g[++p]=t.single?1:0;T(g,f,++p);if(o)g.set(i,p+=4);else g.utf8Write(i,p+=4,f);T(g,l,p+=f);if(u)g.set(s,p+=4);else g.latin1Write(s,p+=4,l);T(g,t.screen||0,p+=l);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, x11-req)`);B(this,this._packetRW.write.finalize(g))}subsystem(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(t);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+4+9+1+4+i);o[s]=h.CHANNEL_REQUEST;T(o,e,++s);T(o,9,s+=4);o.utf8Write("subsystem",s+=4,9);o[s+=9]=n===undefined||n===true?1:0;T(o,i,++s);o.utf8Write(t,s+=4,i);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, subsystem: ${t})`);B(this,this._packetRW.write.finalize(o))}openssh_agentForward(e,t){if(this._server)throw new Error("Client-only method called in server mode");let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+4+26+1);i[n]=h.CHANNEL_REQUEST;T(i,e,++n);T(i,26,n+=4);i.utf8Write("auth-agent-req@openssh.com",n+=4,26);i[n+=26]=t===undefined||t===true?1:0;if(this._debug){this._debug("Outbound: Sending CHANNEL_REQUEST "+`(r:${e}, auth-agent-req@openssh.com)`)}B(this,this._packetRW.write.finalize(i))}openssh_hostKeysProve(e){if(this._server)throw new Error("Client-only method called in server mode");let t=0;const n=[];for(const i of e){const e=i.getPublicSSH();t+=4+e.length;n.push(e)}let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+29+1+t);s[i]=h.GLOBAL_REQUEST;T(s,29,++i);s.utf8Write("hostkeys-prove-00@openssh.com",i+=4,29);s[i+=29]=1;++i;for(const e of n){T(s,e.length,i);C(e,s,0,e.length,i+=4);i+=e.length}if(this._debug){this._debug("Outbound: Sending GLOBAL_REQUEST (hostkeys-prove-00@openssh.com)")}B(this,this._packetRW.write.finalize(s))}serviceAccept(e){if(!this._server)throw new Error("Server-only method called in client mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+t);i[n]=h.SERVICE_ACCEPT;T(i,t,++n);i.utf8Write(e,n+=4,t);this._debug&&this._debug(`Outbound: Sending SERVICE_ACCEPT (${e})`);B(this,this._packetRW.write.finalize(i));if(this._server&&this._banner&&e==="ssh-userauth"){const e=this._banner;this._banner=undefined;const t=Buffer.byteLength(e);n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+t+4);i[n]=h.USERAUTH_BANNER;T(i,t,++n);i.utf8Write(e,n+=4,t);T(i,0,n+=t);this._debug&&this._debug("Outbound: Sending USERAUTH_BANNER");B(this,this._packetRW.write.finalize(i))}}forwardedTcpip(e,t,n,i){if(!this._server)throw new Error("Server-only method called in client mode");const s=Buffer.byteLength(i.boundAddr);const o=Buffer.byteLength(i.remoteAddr);let f=this._packetRW.write.allocStart;const u=this._packetRW.write.alloc(1+4+15+4+4+4+4+s+4+4+o+4);u[f]=h.CHANNEL_OPEN;T(u,15,++f);u.utf8Write("forwarded-tcpip",f+=4,15);T(u,e,f+=15);T(u,t,f+=4);T(u,n,f+=4);T(u,s,f+=4);u.utf8Write(i.boundAddr,f+=4,s);T(u,i.boundPort,f+=s);T(u,o,f+=4);u.utf8Write(i.remoteAddr,f+=4,o);T(u,i.remotePort,f+=o);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, forwarded-tcpip)`);B(this,this._packetRW.write.finalize(u))}x11(e,t,n,i){if(!this._server)throw new Error("Server-only method called in client mode");const s=Buffer.byteLength(i.originAddr);let o=this._packetRW.write.allocStart;const f=this._packetRW.write.alloc(1+4+3+4+4+4+4+s+4);f[o]=h.CHANNEL_OPEN;T(f,3,++o);f.utf8Write("x11",o+=4,3);T(f,e,o+=3);T(f,t,o+=4);T(f,n,o+=4);T(f,s,o+=4);f.utf8Write(i.originAddr,o+=4,s);T(f,i.originPort,o+=s);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, x11)`);B(this,this._packetRW.write.finalize(f))}openssh_authAgent(e,t,n){if(!this._server)throw new Error("Server-only method called in client mode");let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+22+4+4+4);s[i]=h.CHANNEL_OPEN;T(s,22,++i);s.utf8Write("auth-agent@openssh.com",i+=4,22);T(s,e,i+=22);T(s,t,i+=4);T(s,n,i+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, auth-agent@openssh.com)`);B(this,this._packetRW.write.finalize(s))}openssh_forwardedStreamLocal(e,t,n,i){if(!this._server)throw new Error("Server-only method called in client mode");const s=Buffer.byteLength(i.socketPath);let o=this._packetRW.write.allocStart;const f=this._packetRW.write.alloc(1+4+33+4+4+4+4+s+4);f[o]=h.CHANNEL_OPEN;T(f,33,++o);f.utf8Write("forwarded-streamlocal@openssh.com",o+=4,33);T(f,e,o+=33);T(f,t,o+=4);T(f,n,o+=4);T(f,s,o+=4);f.utf8Write(i.socketPath,o+=4,s);T(f,0,o+=s);if(this._debug){this._debug("Outbound: Sending CHANNEL_OPEN "+`(r:${e}, forwarded-streamlocal@openssh.com)`)}B(this,this._packetRW.write.finalize(f))}exitStatus(e,t){if(!this._server)throw new Error("Server-only method called in client mode");let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+4+11+1+4);i[n]=h.CHANNEL_REQUEST;T(i,e,++n);T(i,11,n+=4);i.utf8Write("exit-status",n+=4,11);i[n+=11]=0;T(i,t,++n);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, exit-status: ${t})`);B(this,this._packetRW.write.finalize(i))}exitSignal(e,t,n,i){if(!this._server)throw new Error("Server-only method called in client mode");const s=t;if(typeof s!=="string"||!s)throw new Error(`Invalid signal: ${s}`);let o=t.toUpperCase();if(o.slice(0,3)==="SIG")o=o.slice(3);if(p[o]!==1)throw new Error(`Invalid signal: ${s}`);const f=Buffer.byteLength(o);const u=i?Buffer.byteLength(i):0;let l=this._packetRW.write.allocStart;const g=this._packetRW.write.alloc(1+4+4+11+1+4+f+1+4+u+4);g[l]=h.CHANNEL_REQUEST;T(g,e,++l);T(g,11,l+=4);g.utf8Write("exit-signal",l+=4,11);g[l+=11]=0;T(g,f,++l);g.utf8Write(o,l+=4,f);g[l+=f]=n?1:0;T(g,u,++l);l+=4;if(u){g.utf8Write(i,l,u);l+=u}T(g,0,l);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, exit-signal: ${t})`);B(this,this._packetRW.write.finalize(g))}authFailure(e,t){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");let n;if(typeof e==="boolean"){t=e;e=undefined}if(e){n=[];for(let t=0;t<e.length;++t){if(e[t].toLowerCase()==="none")continue;n.push(e[t])}n=n.join(",")}else{n=""}const i=n.length;let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+i+1);o[s]=h.USERAUTH_FAILURE;T(o,i,++s);o.utf8Write(n,s+=4,i);o[s+=i]=t===true?1:0;this._authsQueue.shift();this._debug&&this._debug("Outbound: Sending USERAUTH_FAILURE");B(this,this._packetRW.write.finalize(o))}authSuccess(){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");const e=this._packetRW.write.allocStart;const t=this._packetRW.write.alloc(1);t[e]=h.USERAUTH_SUCCESS;this._authsQueue.shift();this._authenticated=true;this._debug&&this._debug("Outbound: Sending USERAUTH_SUCCESS");B(this,this._packetRW.write.finalize(t));if(this._kex.negotiated.cs.compress==="zlib@openssh.com")this._packetRW.read=new L;if(this._kex.negotiated.sc.compress==="zlib@openssh.com")this._packetRW.write=new U(this)}authPKOK(e,t){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0||this._authsQueue[0]!=="publickey")throw new Error('"publickey" auth not in progress');const n=Buffer.byteLength(e);const i=t.length;let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+n+4+i);o[s]=h.USERAUTH_PK_OK;T(o,n,++s);o.utf8Write(e,s+=4,n);T(o,i,s+=n);o.set(t,s+=4);this._authsQueue.shift();this._debug&&this._debug("Outbound: Sending USERAUTH_PK_OK");B(this,this._packetRW.write.finalize(o))}authPasswdChg(e){if(!this._server)throw new Error("Server-only method called in client mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+t+4);i[n]=h.USERAUTH_PASSWD_CHANGEREQ;T(i,t,++n);i.utf8Write(e,n+=4,t);T(i,0,n+=t);this._debug&&this._debug("Outbound: Sending USERAUTH_PASSWD_CHANGEREQ");B(this,this._packetRW.write.finalize(i))}authInfoReq(e,t,n){if(!this._server)throw new Error("Server-only method called in client mode");let i=0;const s=e?Buffer.byteLength(e):0;const o=t?Buffer.byteLength(t):0;for(let e=0;e<n.length;++e)i+=4+Buffer.byteLength(n[e].prompt)+1;let f=this._packetRW.write.allocStart;const u=this._packetRW.write.alloc(1+4+s+4+o+4+4+i);u[f]=h.USERAUTH_INFO_REQUEST;T(u,s,++f);f+=4;if(e){u.utf8Write(e,f,s);f+=s}T(u,o,f);f+=4;if(t){u.utf8Write(t,f,o);f+=o}T(u,0,f);T(u,n.length,f+=4);f+=4;for(let e=0;e<n.length;++e){const t=n[e];const i=Buffer.byteLength(t.prompt);T(u,i,f);f+=4;if(i){u.utf8Write(t.prompt,f,i);f+=i}u[f++]=t.echo?1:0}this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_REQUEST");B(this,this._packetRW.write.finalize(u))}}const Y=/^SSH-(2\.0|1\.99)-([^ ]+)(?: (.*))?$/;function parseHeader(e,t,n){let s;let o;if(this._buffer){s=Buffer.allocUnsafe(this._buffer.length+(n-t));s.set(this._buffer,0);if(t===0){s.set(e,this._buffer.length)}else{s.set(new Uint8Array(e.buffer,e.byteOffset+t,n-t),this._buffer.length)}o=this._buffer.length;t=0}else{s=e;o=0}const u=t;let l=t;let h=t;let p=false;let g=0;let _=0;for(;t<s.length;++t){const e=s[t];if(e===13){p=true;continue}if(e===10){if(h>l&&h-l>4&&s[l]===83&&s[l+1]===83&&s[l+2]===72&&s[l+3]===45){const e=s.latin1Slice(u,h+1);const p=l===u?e:e.slice(l-u);const g=Y.exec(p);if(!g)throw new Error("Invalid identification string");const _={greeting:l===u?"":e.slice(0,l-u),identRaw:p,versions:{protocol:g[1],software:g[2]},comments:g[3]};this._remoteIdentRaw=Buffer.from(p);this._debug&&this._debug(`Remote ident: ${i(p)}`);this._compatFlags=getCompatFlags(_);this._buffer=undefined;this._decipher=new f(0,b.bind(this,{firstPacket:true}));this._parse=parsePacket;this._onHeader(_);if(!this._destruct){return n}y(this);return t+1-o}if(this._server)throw new Error("Greetings from clients not permitted");if(++_>q)throw new Error("Max greeting lines exceeded");p=false;l=t+1;g=0}else if(p){throw new Error("Invalid header: expected newline")}else if(++g>=$){throw new Error("Header line too long")}h=t}if(!this._buffer)this._buffer=k(s,u);return t-o}function parsePacket(e,t,n){return this._decipher.decrypt(e,t,n)}function onPayload(e){this._onPacket();if(e.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}e=this._packetRW.read.read(e);const t=e[0];if(t===h.USERAUTH_SUCCESS&&!this._server&&!this._authenticated){this._authenticated=true;if(this._kex.negotiated.cs.compress==="zlib@openssh.com")this._packetRW.write=new U(this);if(this._kex.negotiated.sc.compress==="zlib@openssh.com")this._packetRW.read=new L}const n=I[t];if(n===undefined){this._debug&&this._debug(`Inbound: Unsupported message type: ${t}`);return}return n(this,e)}function getCompatFlags(e){const t=e.versions.software;let n=0;for(const e of u){if(typeof e[0]==="string"){if(t===e[0])n|=e[1]}else if(e[0].test(t)){n|=e[1]}}return n}function modesToBytes(e){const t=Object.keys(e);const n=Buffer.allocUnsafe(5*t.length+1);let i=0;for(let s=0;s<t.length;++s){const o=t[s];if(o==="TTY_OP_END")continue;const f=g[o];if(f===undefined)continue;const u=e[o];if(typeof u==="number"&&isFinite(u)){n[i++]=f;n[i++]=u>>>24;n[i++]=u>>>16;n[i++]=u>>>8;n[i++]=u}}n[i++]=g.TTY_OP_END;if(i<n.length)return k(n,0,i);return n}e.exports=Protocol},2026:(e,t,n)=>{"use strict";const i=n(2361);const s=n(7147);const{constants:o}=s;const{Readable:f,Writable:u}=n(2781);const{inherits:l,isDate:h}=n(3837);const p=Buffer[Symbol.species];const{bufferCopy:g,bufferSlice:_,makeBufferParser:E,writeUInt32BE:y}=n(9475);const b={SIZE:1,UIDGID:2,PERMISSIONS:4,ACMODTIME:8,EXTENDED:2147483648};const w=Buffer.alloc(28);const I={OK:0,EOF:1,NO_SUCH_FILE:2,PERMISSION_DENIED:3,FAILURE:4,BAD_MESSAGE:5,NO_CONNECTION:6,CONNECTION_LOST:7,OP_UNSUPPORTED:8};const C=new Map(Object.values(I).map((e=>[e,1])));const v={[I.OK]:"No error",[I.EOF]:"End of file",[I.NO_SUCH_FILE]:"No such file or directory",[I.PERMISSION_DENIED]:"Permission denied",[I.FAILURE]:"Failure",[I.BAD_MESSAGE]:"Bad message",[I.NO_CONNECTION]:"No connection",[I.CONNECTION_LOST]:"Connection lost",[I.OP_UNSUPPORTED]:"Operation unsupported"};const k={INIT:1,OPEN:3,CLOSE:4,READ:5,WRITE:6,LSTAT:7,FSTAT:8,SETSTAT:9,FSETSTAT:10,OPENDIR:11,READDIR:12,REMOVE:13,MKDIR:14,RMDIR:15,REALPATH:16,STAT:17,RENAME:18,READLINK:19,SYMLINK:20,EXTENDED:200};const R={VERSION:2,STATUS:101,HANDLE:102,DATA:103,NAME:104,ATTRS:105,EXTENDED:201};const B={READ:1,WRITE:2,APPEND:4,CREAT:8,TRUNC:16,EXCL:32};const T=2*1024;const O=2**32-1;const P=Buffer.from([0,0,0,5,k.INIT,0,0,0,3]);const L=Buffer.from([0,0,0,5,R.VERSION,0,0,0,3]);const U=/^SSH-2.0-(?:OpenSSH|dropbear)/;const D=256*1024;const x=E();const Q={readable:false,writable:false,push:e=>{},once:()=>{},on:()=>{},emit:()=>{},end:()=>{}};function noop(){}class SFTP extends i{constructor(e,t,n){super();if(typeof n!=="object"||!n)n={};const i=e._protocol._remoteIdentRaw;this.server=!!n.server;this._debug=typeof n.debug==="function"?n.debug:undefined;this._isOpenSSH=i&&U.test(i);this._version=-1;this._extensions={};this._biOpt=n.biOpt;this._pktLenBytes=0;this._pktLen=0;this._pktPos=0;this._pktType=0;this._pktData=undefined;this._writeReqid=-1;this._requests={};this._maxInPktLen=D;this._maxOutPktLen=34e3;this._maxReadLen=(this._isOpenSSH?D:34e3)-T;this._maxWriteLen=(this._isOpenSSH?D:34e3)-T;this.maxOpenHandles=undefined;this._client=e;this._protocol=e._protocol;this._callbacks=[];this._hasX11=false;this._exit={code:undefined,signal:undefined,dump:undefined,desc:undefined};this._waitWindow=false;this._chunkcb=undefined;this._buffer=[];this.type=t.type;this.subtype=undefined;this.incoming=t.incoming;this.outgoing=t.outgoing;this.stderr=Q;this.readable=true}push(e){if(e===null){cleanupRequests(this);if(!this.readable)return;this.readable=false;this.emit("end");return}let t=0;while(t<e.length){if(this._pktLenBytes<4){let n=Math.min(4-this._pktLenBytes,e.length-t);this._pktLenBytes+=n;while(n--)this._pktLen=(this._pktLen<<8)+e[t++];if(this._pktLenBytes<4)return;if(this._pktLen===0)return doFatalSFTPError(this,"Invalid packet length");if(this._pktLen>this._maxInPktLen){const e=this._maxInPktLen;return doFatalSFTPError(this,`Packet length ${this._pktLen} exceeds max length of ${e}`)}if(t>=e.length)return}if(this._pktPos<this._pktLen){const n=Math.min(this._pktLen-this._pktPos,e.length-t);if(t!==0||n!==e.length){if(n===this._pktLen){this._pkt=new p(e.buffer,e.byteOffset+t,n)}else{if(!this._pkt)this._pkt=Buffer.allocUnsafe(this._pktLen);this._pkt.set(new Uint8Array(e.buffer,e.byteOffset+t,n),this._pktPos)}}else if(n===this._pktLen){this._pkt=e}else{if(!this._pkt)this._pkt=Buffer.allocUnsafe(this._pktLen);this._pkt.set(e,this._pktPos)}t+=n;this._pktPos+=n;if(this._pktPos<this._pktLen)return}const n=this._pkt[0];const i=this._pkt;this._pktLen=0;this._pktLenBytes=0;this._pkt=undefined;this._pktPos=0;const s=this.server?G[n]:q[n];if(!s)return doFatalSFTPError(this,`Unknown packet type ${n}`);if(this._version===-1){if(this.server){if(n!==k.INIT)return doFatalSFTPError(this,`Expected INIT packet, got ${n}`)}else if(n!==R.VERSION){return doFatalSFTPError(this,`Expected VERSION packet, got ${n}`)}}if(s(this,i)===false)return}}end(){this.destroy()}destroy(){if(this.outgoing.state==="open"||this.outgoing.state==="eof"){this.outgoing.state="closing";this._protocol.channelClose(this.outgoing.id)}}_init(){this._init=noop;if(!this.server)sendOrBuffer(this,P)}createReadStream(e,t){if(this.server)throw new Error("Client-only method called in server mode");return new ReadStream(this,e,t)}createWriteStream(e,t){if(this.server)throw new Error("Client-only method called in server mode");return new WriteStream(this,e,t)}open(e,t,n,i){if(this.server)throw new Error("Client-only method called in server mode");if(typeof n==="function"){i=n;n=undefined}const s=typeof t==="number"?t:stringToFlags(t);if(s===null)throw new Error(`Unknown flags string: ${t}`);let o=0;let f=0;if(typeof n==="string"||typeof n==="number")n={mode:n};if(typeof n==="object"&&n!==null){n=attrsToBytes(n);o=n.flags;f=n.nb}const u=Buffer.byteLength(e);let l=9;const h=Buffer.allocUnsafe(4+1+4+4+u+4+4+f);y(h,h.length-4,0);h[4]=k.OPEN;const p=this._writeReqid=this._writeReqid+1&O;y(h,p,5);y(h,u,l);h.utf8Write(e,l+=4,u);y(h,s,l+=u);y(h,o,l+=4);if(f){l+=4;if(f===w.length)h.set(w,l);else g(w,h,0,f,l);l+=f}this._requests[p]={cb:i};const _=sendOrBuffer(this,h);this._debug&&this._debug(`SFTP: Outbound: ${_?"Buffered":"Sending"} OPEN`)}close(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");const n=e.length;let i=9;const s=Buffer.allocUnsafe(4+1+4+4+n);y(s,s.length-4,0);s[4]=k.CLOSE;const o=this._writeReqid=this._writeReqid+1&O;y(s,o,5);y(s,n,i);s.set(e,i+=4);this._requests[o]={cb:t};const f=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} CLOSE`)}read(e,t,n,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(t))throw new Error("buffer is not a Buffer");if(n>=t.length)throw new Error("offset is out of bounds");if(n+i>t.length)throw new Error("length extends beyond buffer");if(s===null)throw new Error("null position currently unsupported");read_(this,e,t,n,i,s,o)}readData(e,t,n,i,s,o){this.read(e,t,n,i,s,o)}write(e,t,n,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(t))throw new Error("buffer is not a Buffer");if(n>t.length)throw new Error("offset is out of bounds");if(n+i>t.length)throw new Error("length extends beyond buffer");if(s===null)throw new Error("null position currently unsupported");if(!i){o&&process.nextTick(o,undefined,0);return}const f=this._maxWriteLen;const u=Math.max(i-f,0);const l=s;if(u)i=f;const h=e.length;let p=9;const _=Buffer.allocUnsafe(4+1+4+4+h+8+4+i);y(_,_.length-4,0);_[4]=k.WRITE;const E=this._writeReqid=this._writeReqid+1&O;y(_,E,5);y(_,h,p);_.set(e,p+=4);p+=h;for(let e=7;e>=0;--e){_[p+e]=s&255;s/=256}y(_,i,p+=8);g(t,_,n,n+i,p+=4);this._requests[E]={cb:s=>{if(s){if(typeof o==="function")o(s)}else if(u){this.write(e,t,n+i,u,l+i,o)}else if(typeof o==="function"){o(undefined,n+i)}}};const b=sendOrBuffer(this,_);if(this._debug){const e=b?"Sent":"Buffered";this._debug(`SFTP: Outbound: ${e} WRITE (id:${E})`)}}writeData(e,t,n,i,s,o){this.write(e,t,n,i,s,o)}fastGet(e,t,n,i){if(this.server)throw new Error("Client-only method called in server mode");fastXfer(this,s,e,t,n,i)}fastPut(e,t,n,i){if(this.server)throw new Error("Client-only method called in server mode");fastXfer(s,this,e,t,n,i)}readFile(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let i;if(typeof n==="function"){i=n}else if(typeof t==="function"){i=t;t=undefined}if(typeof t==="string")t={encoding:t,flag:"r"};else if(!t)t={encoding:null,flag:"r"};else if(typeof t!=="object")throw new TypeError("Bad arguments");const s=t.encoding;if(s&&!Buffer.isEncoding(s))throw new Error(`Unknown encoding: ${s}`);let o;let f;let u;let l=0;let h;let p=0;const g=t.flag||"r";const read=()=>{if(o===0){f=Buffer.allocUnsafe(8192);this.read(h,f,0,8192,p,afterRead)}else{this.read(h,f,l,o-l,p,afterRead)}};const afterRead=(e,t)=>{let n;if(e){n=e.code===I.EOF;if(!n){return this.close(h,(()=>i&&i(e)))}}else{n=false}if(n||o===0&&t===0)return close();p+=t;l+=t;if(o!==0){if(l===o)close();else read()}else{u.push(_(f,0,t));read()}};afterRead._wantEOFError=true;const close=()=>{this.close(h,(e=>{if(o===0){f=Buffer.concat(u,l)}else if(l<o){f=_(f,0,l)}if(s)f=f.toString(s);return i&&i(e,f)}))};this.open(e,g,438,((t,n)=>{if(t)return i&&i(t);h=n;const tryStat=(t,n)=>{if(t){this.stat(e,((e,n)=>{if(e){return this.close(h,(()=>{i&&i(t)}))}tryStat(null,n)}));return}o=n.size||0;if(o===0){u=[];return read()}f=Buffer.allocUnsafe(o);read()};this.fstat(h,tryStat)}))}writeFile(e,t,n,i){if(this.server)throw new Error("Client-only method called in server mode");let s;if(typeof i==="function"){s=i}else if(typeof n==="function"){s=n;n=undefined}if(typeof n==="string")n={encoding:n,mode:438,flag:"w"};else if(!n)n={encoding:"utf8",mode:438,flag:"w"};else if(typeof n!=="object")throw new TypeError("Bad arguments");if(n.encoding&&!Buffer.isEncoding(n.encoding))throw new Error(`Unknown encoding: ${n.encoding}`);const o=n.flag||"w";this.open(e,o,n.mode,((i,f)=>{if(i){s&&s(i)}else{const i=Buffer.isBuffer(t)?t:Buffer.from(""+t,n.encoding||"utf8");const u=/a/.test(o)?null:0;if(u===null){const tryStat=(t,n)=>{if(t){this.stat(e,((e,n)=>{if(e){return this.close(f,(()=>{s&&s(t)}))}tryStat(null,n)}));return}writeAll(this,f,i,0,i.length,n.size,s)};this.fstat(f,tryStat);return}writeAll(this,f,i,0,i.length,u,s)}}))}appendFile(e,t,n,i){if(this.server)throw new Error("Client-only method called in server mode");let s;if(typeof i==="function"){s=i}else if(typeof n==="function"){s=n;n=undefined}if(typeof n==="string")n={encoding:n,mode:438,flag:"a"};else if(!n)n={encoding:"utf8",mode:438,flag:"a"};else if(typeof n!=="object")throw new TypeError("Bad arguments");if(!n.flag)n=Object.assign({flag:"a"},n);this.writeFile(e,t,n,s)}exists(e,t){if(this.server)throw new Error("Client-only method called in server mode");this.stat(e,(e=>{t&&t(e?false:true)}))}unlink(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let i=9;const s=Buffer.allocUnsafe(4+1+4+4+n);y(s,s.length-4,0);s[4]=k.REMOVE;const o=this._writeReqid=this._writeReqid+1&O;y(s,o,5);y(s,n,i);s.utf8Write(e,i+=4,n);this._requests[o]={cb:t};const f=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} REMOVE`)}rename(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(e);const s=Buffer.byteLength(t);let o=9;const f=Buffer.allocUnsafe(4+1+4+4+i+4+s);y(f,f.length-4,0);f[4]=k.RENAME;const u=this._writeReqid=this._writeReqid+1&O;y(f,u,5);y(f,i,o);f.utf8Write(e,o+=4,i);y(f,s,o+=i);f.utf8Write(t,o+=4,s);this._requests[u]={cb:n};const l=sendOrBuffer(this,f);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} RENAME`)}mkdir(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let i=0;let s=0;if(typeof t==="function"){n=t;t=undefined}if(typeof t==="object"&&t!==null){t=attrsToBytes(t);i=t.flags;s=t.nb}const o=Buffer.byteLength(e);let f=9;const u=Buffer.allocUnsafe(4+1+4+4+o+4+s);y(u,u.length-4,0);u[4]=k.MKDIR;const l=this._writeReqid=this._writeReqid+1&O;y(u,l,5);y(u,o,f);u.utf8Write(e,f+=4,o);y(u,i,f+=o);if(s){f+=4;if(s===w.length)u.set(w,f);else g(w,u,0,s,f);f+=s}this._requests[l]={cb:n};const h=sendOrBuffer(this,u);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} MKDIR`)}rmdir(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let i=9;const s=Buffer.allocUnsafe(4+1+4+4+n);y(s,s.length-4,0);s[4]=k.RMDIR;const o=this._writeReqid=this._writeReqid+1&O;y(s,o,5);y(s,n,i);s.utf8Write(e,i+=4,n);this._requests[o]={cb:t};const f=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} RMDIR`)}readdir(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");if(typeof t==="function"){n=t;t={}}if(typeof t!=="object"||t===null)t={};const i=t&&t.full?false:true;if(!Buffer.isBuffer(e)&&typeof e!=="string")throw new Error("missing directory handle or path");if(typeof e==="string"){const i=[];let s=0;const reread=(e,o)=>{if(e)return n(e);this.readdir(o,t,((e,t)=>{const f=e&&e.code===I.EOF;if(e&&!f)return this.close(o,(()=>n(e)));if(f){return this.close(o,(e=>{if(e)return n(e);n(undefined,i)}))}for(let e=0;e<t.length;++e,++s)i[s]=t[e];reread(undefined,o)}))};return this.opendir(e,reread)}const s=e.length;let o=9;const f=Buffer.allocUnsafe(4+1+4+4+s);y(f,f.length-4,0);f[4]=k.READDIR;const u=this._writeReqid=this._writeReqid+1&O;y(f,u,5);y(f,s,o);f.set(e,o+=4);this._requests[u]={cb:i?(e,t)=>{if(typeof n!=="function")return;if(e)return n(e);for(let e=t.length-1;e>=0;--e){if(t[e].filename==="."||t[e].filename==="..")t.splice(e,1)}n(undefined,t)}:n};const l=sendOrBuffer(this,f);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} READDIR`)}fstat(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");const n=e.length;let i=9;const s=Buffer.allocUnsafe(4+1+4+4+n);y(s,s.length-4,0);s[4]=k.FSTAT;const o=this._writeReqid=this._writeReqid+1&O;y(s,o,5);y(s,n,i);s.set(e,i+=4);this._requests[o]={cb:t};const f=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} FSTAT`)}stat(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let i=9;const s=Buffer.allocUnsafe(4+1+4+4+n);y(s,s.length-4,0);s[4]=k.STAT;const o=this._writeReqid=this._writeReqid+1&O;y(s,o,5);y(s,n,i);s.utf8Write(e,i+=4,n);this._requests[o]={cb:t};const f=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} STAT`)}lstat(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let i=9;const s=Buffer.allocUnsafe(4+1+4+4+n);y(s,s.length-4,0);s[4]=k.LSTAT;const o=this._writeReqid=this._writeReqid+1&O;y(s,o,5);y(s,n,i);s.utf8Write(e,i+=4,n);this._requests[o]={cb:t};const f=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} LSTAT`)}opendir(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let i=9;const s=Buffer.allocUnsafe(4+1+4+4+n);y(s,s.length-4,0);s[4]=k.OPENDIR;const o=this._writeReqid=this._writeReqid+1&O;y(s,o,5);y(s,n,i);s.utf8Write(e,i+=4,n);this._requests[o]={cb:t};const f=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} OPENDIR`)}setstat(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let i=0;let s=0;if(typeof t==="object"&&t!==null){t=attrsToBytes(t);i=t.flags;s=t.nb}else if(typeof t==="function"){n=t}const o=Buffer.byteLength(e);let f=9;const u=Buffer.allocUnsafe(4+1+4+4+o+4+s);y(u,u.length-4,0);u[4]=k.SETSTAT;const l=this._writeReqid=this._writeReqid+1&O;y(u,l,5);y(u,o,f);u.utf8Write(e,f+=4,o);y(u,i,f+=o);if(s){f+=4;if(s===w.length)u.set(w,f);else g(w,u,0,s,f);f+=s}this._requests[l]={cb:n};const h=sendOrBuffer(this,u);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} SETSTAT`)}fsetstat(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");let i=0;let s=0;if(typeof t==="object"&&t!==null){t=attrsToBytes(t);i=t.flags;s=t.nb}else if(typeof t==="function"){n=t}const o=e.length;let f=9;const u=Buffer.allocUnsafe(4+1+4+4+o+4+s);y(u,u.length-4,0);u[4]=k.FSETSTAT;const l=this._writeReqid=this._writeReqid+1&O;y(u,l,5);y(u,o,f);u.set(e,f+=4);y(u,i,f+=o);if(s){f+=4;if(s===w.length)u.set(w,f);else g(w,u,0,s,f);f+=s}this._requests[l]={cb:n};const h=sendOrBuffer(this,u);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} FSETSTAT`)}futimes(e,t,n,i){return this.fsetstat(e,{atime:toUnixTimestamp(t),mtime:toUnixTimestamp(n)},i)}utimes(e,t,n,i){return this.setstat(e,{atime:toUnixTimestamp(t),mtime:toUnixTimestamp(n)},i)}fchown(e,t,n,i){return this.fsetstat(e,{uid:t,gid:n},i)}chown(e,t,n,i){return this.setstat(e,{uid:t,gid:n},i)}fchmod(e,t,n){return this.fsetstat(e,{mode:t},n)}chmod(e,t,n){return this.setstat(e,{mode:t},n)}readlink(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let i=9;const s=Buffer.allocUnsafe(4+1+4+4+n);y(s,s.length-4,0);s[4]=k.READLINK;const o=this._writeReqid=this._writeReqid+1&O;y(s,o,5);y(s,n,i);s.utf8Write(e,i+=4,n);this._requests[o]={cb:(e,n)=>{if(typeof t!=="function")return;if(e)return t(e);if(!n||!n.length)return t(new Error("Response missing link info"));t(undefined,n[0].filename)}};const f=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} READLINK`)}symlink(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(t);const s=Buffer.byteLength(e);let o=9;const f=Buffer.allocUnsafe(4+1+4+4+i+4+s);y(f,f.length-4,0);f[4]=k.SYMLINK;const u=this._writeReqid=this._writeReqid+1&O;y(f,u,5);if(this._isOpenSSH){y(f,s,o);f.utf8Write(e,o+=4,s);y(f,i,o+=s);f.utf8Write(t,o+=4,i)}else{y(f,i,o);f.utf8Write(t,o+=4,i);y(f,s,o+=i);f.utf8Write(e,o+=4,s)}this._requests[u]={cb:n};const l=sendOrBuffer(this,f);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} SYMLINK`)}realpath(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let i=9;const s=Buffer.allocUnsafe(4+1+4+4+n);y(s,s.length-4,0);s[4]=k.REALPATH;const o=this._writeReqid=this._writeReqid+1&O;y(s,o,5);y(s,n,i);s.utf8Write(e,i+=4,n);this._requests[o]={cb:(e,n)=>{if(typeof t!=="function")return;if(e)return t(e);if(!n||!n.length)return t(new Error("Response missing path info"));t(undefined,n[0].filename)}};const f=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} REALPATH`)}ext_openssh_rename(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const i=this._extensions["posix-rename@openssh.com"];if(!i||i!=="1")throw new Error("Server does not support this extended request");const s=Buffer.byteLength(e);const o=Buffer.byteLength(t);let f=9;const u=Buffer.allocUnsafe(4+1+4+4+24+4+s+4+o);y(u,u.length-4,0);u[4]=k.EXTENDED;const l=this._writeReqid=this._writeReqid+1&O;y(u,l,5);y(u,24,f);u.utf8Write("posix-rename@openssh.com",f+=4,24);y(u,s,f+=24);u.utf8Write(e,f+=4,s);y(u,o,f+=s);u.utf8Write(t,f+=4,o);this._requests[l]={cb:n};const h=sendOrBuffer(this,u);if(this._debug){const e=h?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} posix-rename@openssh.com`)}}ext_openssh_statvfs(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["statvfs@openssh.com"];if(!n||n!=="2")throw new Error("Server does not support this extended request");const i=Buffer.byteLength(e);let s=9;const o=Buffer.allocUnsafe(4+1+4+4+19+4+i);y(o,o.length-4,0);o[4]=k.EXTENDED;const f=this._writeReqid=this._writeReqid+1&O;y(o,f,5);y(o,19,s);o.utf8Write("statvfs@openssh.com",s+=4,19);y(o,i,s+=19);o.utf8Write(e,s+=4,i);this._requests[f]={extended:"statvfs@openssh.com",cb:t};const u=sendOrBuffer(this,o);if(this._debug){const e=u?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} statvfs@openssh.com`)}}ext_openssh_fstatvfs(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["fstatvfs@openssh.com"];if(!n||n!=="2")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");const i=e.length;let s=9;const o=Buffer.allocUnsafe(4+1+4+4+20+4+i);y(o,o.length-4,0);o[4]=k.EXTENDED;const f=this._writeReqid=this._writeReqid+1&O;y(o,f,5);y(o,20,s);o.utf8Write("fstatvfs@openssh.com",s+=4,20);y(o,i,s+=20);o.set(e,s+=4);this._requests[f]={extended:"fstatvfs@openssh.com",cb:t};const u=sendOrBuffer(this,o);if(this._debug){const e=u?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} fstatvfs@openssh.com`)}}ext_openssh_hardlink(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const i=this._extensions["hardlink@openssh.com"];if(i!=="1")throw new Error("Server does not support this extended request");const s=Buffer.byteLength(e);const o=Buffer.byteLength(t);let f=9;const u=Buffer.allocUnsafe(4+1+4+4+20+4+s+4+o);y(u,u.length-4,0);u[4]=k.EXTENDED;const l=this._writeReqid=this._writeReqid+1&O;y(u,l,5);y(u,20,f);u.utf8Write("hardlink@openssh.com",f+=4,20);y(u,s,f+=20);u.utf8Write(e,f+=4,s);y(u,o,f+=s);u.utf8Write(t,f+=4,o);this._requests[l]={cb:n};const h=sendOrBuffer(this,u);if(this._debug){const e=h?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} hardlink@openssh.com`)}}ext_openssh_fsync(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["fsync@openssh.com"];if(n!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");const i=e.length;let s=9;const o=Buffer.allocUnsafe(4+1+4+4+17+4+i);y(o,o.length-4,0);o[4]=k.EXTENDED;const f=this._writeReqid=this._writeReqid+1&O;y(o,f,5);y(o,17,s);o.utf8Write("fsync@openssh.com",s+=4,17);y(o,i,s+=17);o.set(e,s+=4);this._requests[f]={cb:t};const u=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} fsync@openssh.com`)}ext_openssh_lsetstat(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const i=this._extensions["lsetstat@openssh.com"];if(i!=="1")throw new Error("Server does not support this extended request");let s=0;let o=0;if(typeof t==="object"&&t!==null){t=attrsToBytes(t);s=t.flags;o=t.nb}else if(typeof t==="function"){n=t}const f=Buffer.byteLength(e);let u=9;const l=Buffer.allocUnsafe(4+1+4+4+20+4+f+4+o);y(l,l.length-4,0);l[4]=k.EXTENDED;const h=this._writeReqid=this._writeReqid+1&O;y(l,h,5);y(l,20,u);l.utf8Write("lsetstat@openssh.com",u+=4,20);y(l,f,u+=20);l.utf8Write(e,u+=4,f);y(l,s,u+=f);if(o){u+=4;if(o===w.length)l.set(w,u);else g(w,l,0,o,u);u+=o}this._requests[h]={cb:n};const p=sendOrBuffer(this,l);if(this._debug){const e=p?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} lsetstat@openssh.com`)}}ext_openssh_expandPath(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["expand-path@openssh.com"];if(n!=="1")throw new Error("Server does not support this extended request");const i=Buffer.byteLength(e);let s=9;const o=Buffer.allocUnsafe(4+1+4+4+23+4+i);y(o,o.length-4,0);o[4]=k.EXTENDED;const f=this._writeReqid=this._writeReqid+1&O;y(o,f,5);y(o,23,s);o.utf8Write("expand-path@openssh.com",s+=4,23);y(o,i,s+=20);o.utf8Write(e,s+=4,i);this._requests[f]={cb:t};const u=sendOrBuffer(this,o);if(this._debug){const e=u?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} expand-path@openssh.com`)}}ext_copy_data(e,t,n,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");const f=this._extensions["copy-data"];if(f!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("Source handle is not a Buffer");if(!Buffer.isBuffer(i))throw new Error("Destination handle is not a Buffer");let u=0;const l=Buffer.allocUnsafe(4+1+4+4+9+4+e.length+8+8+4+i.length+8);y(l,l.length-4,u);u+=4;l[u]=k.EXTENDED;++u;const h=this._writeReqid=this._writeReqid+1&O;y(l,h,u);u+=4;y(l,9,u);u+=4;l.utf8Write("copy-data",u,9);u+=9;y(l,e.length,u);u+=4;l.set(e,u);u+=e.length;for(let e=7;e>=0;--e){l[u+e]=t&255;t/=256}u+=8;for(let e=7;e>=0;--e){l[u+e]=n&255;n/=256}u+=8;y(l,i.length,u);u+=4;l.set(i,u);u+=i.length;for(let e=7;e>=0;--e){l[u+e]=s&255;s/=256}this._requests[h]={cb:o};const p=sendOrBuffer(this,l);if(this._debug){const e=p?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} copy-data`)}}handle(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");const n=t.length;if(n>256)throw new Error("handle too large (> 256 bytes)");let i=9;const s=Buffer.allocUnsafe(4+1+4+4+n);y(s,s.length-4,0);s[4]=R.HANDLE;y(s,e,5);y(s,n,i);if(n)s.set(t,i+=4);const o=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} HANDLE`)}status(e,t,n){if(!this.server)throw new Error("Server-only method called in client mode");if(!C.has(t))throw new Error(`Bad status code: ${t}`);n||(n="");const i=Buffer.byteLength(n);let s=9;const o=Buffer.allocUnsafe(4+1+4+4+4+i+4);y(o,o.length-4,0);o[4]=R.STATUS;y(o,e,5);y(o,t,s);y(o,i,s+=4);s+=4;if(i){o.utf8Write(n,s,i);s+=i}y(o,0,s);const f=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} STATUS`)}data(e,t,n){if(!this.server)throw new Error("Server-only method called in client mode");const i=Buffer.isBuffer(t);if(!i&&typeof t!=="string")throw new Error("data is not a Buffer or string");let s;if(!i&&!n){n=undefined;s=true}const o=i?t.length:Buffer.byteLength(t,n);let f=9;const u=Buffer.allocUnsafe(4+1+4+4+o);y(u,u.length-4,0);u[4]=R.DATA;y(u,e,5);y(u,o,f);if(o){if(i)u.set(t,f+=4);else if(s)u.utf8Write(t,f+=4,o);else u.write(t,f+=4,o,n)}const l=sendOrBuffer(this,u);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} DATA`)}name(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(!Array.isArray(t)){if(typeof t!=="object"||t===null)throw new Error("names is not an object or array");t=[t]}const n=t.length;let i=0;let s;const o=[];for(let e=0;e<n;++e){const n=t[e];const f=!n||!n.filename||typeof n.filename!=="string"?"":n.filename;i+=4+Buffer.byteLength(f);const u=!n||!n.longname||typeof n.longname!=="string"?"":n.longname;i+=4+Buffer.byteLength(u);if(typeof n.attrs==="object"&&n.attrs!==null){s=attrsToBytes(n.attrs);i+=4+s.nb;if(s.nb){let e;if(s.nb===w.length){e=new Uint8Array(w)}else{e=new Uint8Array(s.nb);g(w,e,0,s.nb,0)}s.bytes=e}o.push(s)}else{i+=4;o.push(null)}}let f=9;const u=Buffer.allocUnsafe(4+1+4+4+i);y(u,u.length-4,0);u[4]=R.NAME;y(u,e,5);y(u,n,f);f+=4;for(let e=0;e<n;++e){const n=t[e];{const e=!n||!n.filename||typeof n.filename!=="string"?"":n.filename;const t=Buffer.byteLength(e);y(u,t,f);f+=4;if(t){u.utf8Write(e,f,t);f+=t}}{const e=!n||!n.longname||typeof n.longname!=="string"?"":n.longname;const t=Buffer.byteLength(e);y(u,t,f);f+=4;if(t){u.utf8Write(e,f,t);f+=t}}const i=o[e];if(i){y(u,i.flags,f);f+=4;if(i.flags&&i.bytes){u.set(i.bytes,f);f+=i.nb}}else{y(u,0,f);f+=4}}const l=sendOrBuffer(this,u);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} NAME`)}attrs(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(typeof t!=="object"||t===null)throw new Error("attrs is not an object");t=attrsToBytes(t);const n=t.flags;const i=t.nb;let s=9;const o=Buffer.allocUnsafe(4+1+4+4+i);y(o,o.length-4,0);o[4]=R.ATTRS;y(o,e,5);y(o,n,s);if(i){s+=4;if(i===w.length)o.set(w,s);else g(w,o,0,i,s);s+=i}const f=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} ATTRS`)}}function tryCreateBuffer(e){try{return Buffer.allocUnsafe(e)}catch(e){return e}}function read_(e,t,n,i,s,o,f,u){const l=e._maxReadLen;const h=Math.max(s-l,0);if(h)s=l;const p=t.length;let g=9;let E=o;const b=Buffer.allocUnsafe(4+1+4+4+p+8+4);y(b,b.length-4,0);b[4]=k.READ;const w=e._writeReqid=e._writeReqid+1&O;y(b,w,5);y(b,p,g);b.set(t,g+=4);g+=p;for(let e=7;e>=0;--e){b[g+e]=E&255;E/=256}y(b,s,g+=8);if(typeof f!=="function")f=noop;const C=u||{nb:0,position:o,off:i,origOff:i,len:undefined,overflow:undefined,cb:(i,s,o)=>{const u=C.len;const l=C.overflow;if(i){if(f._wantEOFError||i.code!==I.EOF)return f(i)}else if(o>u){return f(new Error("Received more data than requested"))}else if(o===u&&l){C.nb+=o;C.position+=o;C.off+=o;read_(e,t,n,C.off,l,C.position,f,C);return}o=o||0;if(C.origOff===0&&n.length===C.nb)s=n;else s=_(n,C.origOff,C.origOff+C.nb+o);f(undefined,C.nb+o,s,C.position)},buffer:undefined};C.len=s;C.overflow=h;C.buffer=_(n,i,i+s);e._requests[w]=C;const v=sendOrBuffer(e,b);e._debug&&e._debug(`SFTP: Outbound: ${v?"Buffered":"Sending"} READ`)}function fastXfer(e,t,n,i,o,f){let u=64;let l=32768;let h;let p;let g;if(typeof o==="function"){f=o}else if(typeof o==="object"&&o!==null){if(typeof o.concurrency==="number"&&o.concurrency>0&&!isNaN(o.concurrency)){u=o.concurrency}if(typeof o.chunkSize==="number"&&o.chunkSize>0&&!isNaN(o.chunkSize)){l=o.chunkSize}if(typeof o.fileSize==="number"&&o.fileSize>0&&!isNaN(o.fileSize)){g=o.fileSize}if(typeof o.step==="function")h=o.step;if(typeof o.mode==="string"||typeof o.mode==="number")p=modeNum(o.mode)}let _;let E=0;let y=0;let b=false;let w;let I;let C;let v=l*u;function onerror(n){if(b)return;b=true;let i=0;let o;if(w||I){o=()=>{if(--i===0)f(n)};if(w&&(e===s||e.outgoing.state==="open"))++i;if(I&&(t===s||t.outgoing.state==="open"))++i;if(w&&(e===s||e.outgoing.state==="open"))e.close(w,o);if(I&&(t===s||t.outgoing.state==="open"))t.close(I,o)}else{f(n)}}e.open(n,"r",((o,b)=>{if(o)return onerror(o);w=b;if(g===undefined)e.fstat(w,tryStat);else tryStat(null,{size:g});function tryStat(o,g){if(o){if(e!==s){e.stat(n,((e,t)=>{if(e)return onerror(o);tryStat(null,t)}));return}return onerror(o)}_=g.size;t.open(i,"w",((n,s)=>{if(n)return onerror(n);I=s;if(_<=0)return onerror();while(v>_){if(u===1){v=_;break}v-=l;--u}C=tryCreateBuffer(v);if(C instanceof Error)return onerror(C);if(p!==undefined){t.fchmod(I,p,(function tryAgain(e){if(e){t.chmod(i,p,(e=>tryAgain()));return}startReads()}))}else{startReads()}function onread(n,i,s,o,u,p){if(n)return onerror(n);u=u||0;t.write(I,C,u,i,o,writeCb);function writeCb(n){if(n)return onerror(n);y+=i;h&&h(y,i,_);if(i<p)return singleRead(u,o+i,p-i);if(y===_){t.close(I,(t=>{I=undefined;if(t)return onerror(t);e.close(w,(e=>{w=undefined;if(e)return onerror(e);f()}))}));return}if(E>=_)return;const s=E+l>_?_-E:l;singleRead(u,E,s);E+=s}}function makeCb(e,t,n){return(i,s,o)=>{onread(i,s,o,t,e,n)}}function singleRead(t,n,i){e.read(w,C,t,i,n,makeCb(t,n,i))}function startReads(){let e=0;let t=0;while(E<_&&e<u){const n=E+l>_?_-E:l;singleRead(t,E,n);t+=n;E+=n;++e}}}))}}))}function writeAll(e,t,n,i,s,o,f){const u=typeof f==="function"?f:undefined;e.write(t,n,i,s,o,((f,l)=>{if(f){return e.close(t,(()=>{u&&u(f)}))}if(l===s){e.close(t,u)}else{i+=l;s-=l;o+=l;writeAll(e,t,n,i,s,o,u)}}))}class Stats{constructor(e){this.mode=e&&e.mode;this.uid=e&&e.uid;this.gid=e&&e.gid;this.size=e&&e.size;this.atime=e&&e.atime;this.mtime=e&&e.mtime;this.extended=e&&e.extended}isDirectory(){return(this.mode&o.S_IFMT)===o.S_IFDIR}isFile(){return(this.mode&o.S_IFMT)===o.S_IFREG}isBlockDevice(){return(this.mode&o.S_IFMT)===o.S_IFBLK}isCharacterDevice(){return(this.mode&o.S_IFMT)===o.S_IFCHR}isSymbolicLink(){return(this.mode&o.S_IFMT)===o.S_IFLNK}isFIFO(){return(this.mode&o.S_IFMT)===o.S_IFIFO}isSocket(){return(this.mode&o.S_IFMT)===o.S_IFSOCK}}function attrsToBytes(e){let t=0;let n=0;if(typeof e==="object"&&e!==null){if(typeof e.size==="number"){t|=b.SIZE;const i=e.size;w[n++]=i/72057594037927940;w[n++]=i/281474976710656;w[n++]=i/1099511627776;w[n++]=i/4294967296;w[n++]=i/16777216;w[n++]=i/65536;w[n++]=i/256;w[n++]=i}if(typeof e.uid==="number"&&typeof e.gid==="number"){t|=b.UIDGID;const i=e.uid;const s=e.gid;w[n++]=i>>>24;w[n++]=i>>>16;w[n++]=i>>>8;w[n++]=i;w[n++]=s>>>24;w[n++]=s>>>16;w[n++]=s>>>8;w[n++]=s}if(typeof e.mode==="number"||typeof e.mode==="string"){const i=modeNum(e.mode);t|=b.PERMISSIONS;w[n++]=i>>>24;w[n++]=i>>>16;w[n++]=i>>>8;w[n++]=i}if((typeof e.atime==="number"||h(e.atime))&&(typeof e.mtime==="number"||h(e.mtime))){const i=toUnixTimestamp(e.atime);const s=toUnixTimestamp(e.mtime);t|=b.ACMODTIME;w[n++]=i>>>24;w[n++]=i>>>16;w[n++]=i>>>8;w[n++]=i;w[n++]=s>>>24;w[n++]=s>>>16;w[n++]=s>>>8;w[n++]=s}}return{flags:t,nb:n}}function toUnixTimestamp(e){if(typeof e==="number"&&e===e)return e;if(h(e))return parseInt(e.getTime()/1e3,10);throw new Error(`Cannot parse time: ${e}`)}function modeNum(e){if(typeof e==="number"&&e===e)return e;if(typeof e==="string")return modeNum(parseInt(e,8));throw new Error(`Cannot parse mode: ${e}`)}const W={r:B.READ,"r+":B.READ|B.WRITE,w:B.TRUNC|B.CREAT|B.WRITE,wx:B.TRUNC|B.CREAT|B.WRITE|B.EXCL,xw:B.TRUNC|B.CREAT|B.WRITE|B.EXCL,"w+":B.TRUNC|B.CREAT|B.READ|B.WRITE,"wx+":B.TRUNC|B.CREAT|B.READ|B.WRITE|B.EXCL,"xw+":B.TRUNC|B.CREAT|B.READ|B.WRITE|B.EXCL,a:B.APPEND|B.CREAT|B.WRITE,ax:B.APPEND|B.CREAT|B.WRITE|B.EXCL,xa:B.APPEND|B.CREAT|B.WRITE|B.EXCL,"a+":B.APPEND|B.CREAT|B.READ|B.WRITE,"ax+":B.APPEND|B.CREAT|B.READ|B.WRITE|B.EXCL,"xa+":B.APPEND|B.CREAT|B.READ|B.WRITE|B.EXCL};function stringToFlags(e){const t=W[e];return t!==undefined?t:null}const $=(()=>{const e=Object.keys(W);return t=>{for(let n=0;n<e.length;++n){const i=e[n];if(W[i]===t)return i}return null}})();function readAttrs(e){const t=x.readUInt32BE();if(t===undefined)return;const n=new Stats;if(t&b.SIZE){const t=x.readUInt64BE(e);if(t===undefined)return;n.size=t}if(t&b.UIDGID){const e=x.readUInt32BE();const t=x.readUInt32BE();if(t===undefined)return;n.uid=e;n.gid=t}if(t&b.PERMISSIONS){const e=x.readUInt32BE();if(e===undefined)return;n.mode=e}if(t&b.ACMODTIME){const e=x.readUInt32BE();const t=x.readUInt32BE();if(t===undefined)return;n.atime=e;n.mtime=t}if(t&b.EXTENDED){const e=x.readUInt32BE();if(e===undefined)return;const t={};for(let n=0;n<e;++n){const e=x.readString(true);const n=x.readString();if(n===undefined)return;t[e]=n}n.extended=t}return n}function sendOrBuffer(e,t){const n=tryWritePayload(e,t);if(n!==undefined){e._buffer.push(n);return false}return true}function tryWritePayload(e,t){const n=e.outgoing;if(n.state!=="open")return;if(n.window===0){e._waitWindow=true;e._chunkcb=drainBuffer;return t}let i;const s=t.length;let o=0;while(s-o>0&&n.window>0){const i=Math.min(s-o,n.window,n.packetSize);n.window-=i;if(n.window===0){e._waitWindow=true;e._chunkcb=drainBuffer}if(o===0&&i===s){e._protocol.channelData(e.outgoing.id,t)}else{e._protocol.channelData(e.outgoing.id,_(t,o,o+i))}o+=i}if(s-o>0){if(o>0)i=_(t,o,s);else i=t}return i}function drainBuffer(){this._chunkcb=undefined;const e=this._buffer;let t=0;while(t<e.length){const n=e[t];const i=tryWritePayload(this,n);if(i!==undefined){if(i!==n)e[t]=i;if(t>0)this._buffer=e.slice(t);return}++t}if(t>0)this._buffer=[]}function doFatalSFTPError(e,t,n){const i=new Error(t);i.level="sftp-protocol";if(!n&&e._debug)e._debug(`SFTP: Inbound: ${t}`);e.emit("error",i);e.destroy();cleanupRequests(e);return false}function cleanupRequests(e){const t=Object.keys(e._requests);if(t.length===0)return;const n=e._requests;e._requests={};const i=new Error("No response from server");for(let e=0;e<t.length;++e){const s=n[t[e]];if(typeof s.cb==="function")s.cb(i)}}function requestLimits(e,t){let n=9;const i=Buffer.allocUnsafe(4+1+4+4+18);y(i,i.length-4,0);i[4]=k.EXTENDED;const s=e._writeReqid=e._writeReqid+1&O;y(i,s,5);y(i,18,n);i.utf8Write("limits@openssh.com",n+=4,18);e._requests[s]={extended:"limits@openssh.com",cb:t};const o=sendOrBuffer(e,i);if(e._debug){const t=o?"Buffered":"Sending";e._debug(`SFTP: Outbound: ${t} limits@openssh.com`)}}const q={[R.VERSION]:(e,t)=>{if(e._version!==-1)return doFatalSFTPError(e,"Duplicate VERSION packet");const n={};x.init(t,1);let i=x.readUInt32BE();while(x.avail()){const e=x.readString(true);const t=x.readString(true);if(t===undefined){i=undefined;break}n[e]=t}x.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed VERSION packet");if(e._debug){const t=Object.keys(n);if(t.length){e._debug(`SFTP: Inbound: Received VERSION (v${i}, exts:${t})`)}else{e._debug(`SFTP: Inbound: Received VERSION (v${i})`)}}e._version=i;e._extensions=n;if(n["limits@openssh.com"]==="1"){return requestLimits(e,((t,n)=>{if(!t){if(n.maxPktLen>0)e._maxOutPktLen=n.maxPktLen;if(n.maxReadLen>0)e._maxReadLen=n.maxReadLen;if(n.maxWriteLen>0)e._maxWriteLen=n.maxWriteLen;e.maxOpenHandles=n.maxOpenHandles>0?n.maxOpenHandles:Infinity}e.emit("ready")}))}e.emit("ready")},[R.STATUS]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readUInt32BE();const s=x.readString(true);x.clear();if(e._debug){const t=JSON.stringify(s);e._debug(`SFTP: Inbound: Received STATUS (id:${n}, ${i}, ${t})`)}const o=e._requests[n];delete e._requests[n];if(o&&typeof o.cb==="function"){if(i===I.OK){o.cb();return}const e=new Error(s||v[i]||"Unknown status");e.code=i;o.cb(e)}},[R.HANDLE]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString();x.clear();if(i===undefined){if(n!==undefined)delete e._requests[n];return doFatalSFTPError(e,"Malformed HANDLE packet")}e._debug&&e._debug(`SFTP: Inbound: Received HANDLE (id:${n})`);const s=e._requests[n];delete e._requests[n];if(s&&typeof s.cb==="function")s.cb(undefined,i)},[R.DATA]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();let i;if(n!==undefined){i=e._requests[n];delete e._requests[n]}if(i&&typeof i.cb==="function"){if(i.buffer){const t=x.readString(i.buffer);x.clear();if(t!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received DATA (id:${n}, ${t})`);i.cb(undefined,i.buffer,t);return}}else{const t=x.readString();x.clear();if(t!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received DATA (id:${n}, ${t.length})`);i.cb(undefined,t);return}}}else{const t=x.skipString();x.clear();if(t!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received DATA (id:${n}, ${t})`);return}}return doFatalSFTPError(e,"Malformed DATA packet")},[R.NAME]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();let i;if(n!==undefined){i=e._requests[n];delete e._requests[n]}const s=x.readUInt32BE();if(s!==undefined){let t=[];for(let n=0;n<s;++n){const n=x.readString(true);const i=x.readString(true);const s=readAttrs(e._biOpt);if(s===undefined){t=undefined;break}t.push({filename:n,longname:i,attrs:s})}if(t!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received NAME (id:${n}, ${t.length})`);x.clear();if(i&&typeof i.cb==="function")i.cb(undefined,t);return}}x.clear();return doFatalSFTPError(e,"Malformed NAME packet")},[R.ATTRS]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();let i;if(n!==undefined){i=e._requests[n];delete e._requests[n]}const s=readAttrs(e._biOpt);x.clear();if(s!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received ATTRS (id:${n})`);if(i&&typeof i.cb==="function")i.cb(undefined,s);return}return doFatalSFTPError(e,"Malformed ATTRS packet")},[R.EXTENDED]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();if(n!==undefined){const t=e._requests[n];if(t){delete e._requests[n];switch(t.extended){case"statvfs@openssh.com":case"fstatvfs@openssh.com":{const i=e._biOpt;const s={f_bsize:x.readUInt64BE(i),f_frsize:x.readUInt64BE(i),f_blocks:x.readUInt64BE(i),f_bfree:x.readUInt64BE(i),f_bavail:x.readUInt64BE(i),f_files:x.readUInt64BE(i),f_ffree:x.readUInt64BE(i),f_favail:x.readUInt64BE(i),f_sid:x.readUInt64BE(i),f_flag:x.readUInt64BE(i),f_namemax:x.readUInt64BE(i)};if(s.f_namemax===undefined)break;if(e._debug){e._debug("SFTP: Inbound: Received EXTENDED_REPLY "+`(id:${n}, ${t.extended})`)}x.clear();if(typeof t.cb==="function")t.cb(undefined,s);return}case"limits@openssh.com":{const i={maxPktLen:x.readUInt64BE(),maxReadLen:x.readUInt64BE(),maxWriteLen:x.readUInt64BE(),maxOpenHandles:x.readUInt64BE()};if(i.maxOpenHandles===undefined)break;if(e._debug){e._debug("SFTP: Inbound: Received EXTENDED_REPLY "+`(id:${n}, ${t.extended})`)}x.clear();if(typeof t.cb==="function")t.cb(undefined,i);return}default:e._debug&&e._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${n}, ???)`);x.clear();if(typeof t.cb==="function")t.cb();return}}else{e._debug&&e._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${n}, ???)`);x.clear();return}}x.clear();return doFatalSFTPError(e,"Malformed EXTENDED_REPLY packet")}};const G={[k.INIT]:(e,t)=>{if(e._version!==-1)return doFatalSFTPError(e,"Duplicate INIT packet");const n={};x.init(t,1);let i=x.readUInt32BE();while(x.avail()){const e=x.readString(true);const t=x.readString(true);if(t===undefined){i=undefined;break}n[e]=t}x.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed INIT packet");if(e._debug){const t=Object.keys(n);if(t.length){e._debug(`SFTP: Inbound: Received INIT (v${i}, exts:${t})`)}else{e._debug(`SFTP: Inbound: Received INIT (v${i})`)}}sendOrBuffer(e,L);e._version=i;e._extensions=n;e.emit("ready")},[k.OPEN]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString(true);const s=x.readUInt32BE();const o=readAttrs(e._biOpt);x.clear();if(o===undefined)return doFatalSFTPError(e,"Malformed OPEN packet");e._debug&&e._debug(`SFTP: Inbound: Received OPEN (id:${n})`);if(!e.emit("OPEN",n,i,s,o)){e.status(n,I.OP_UNSUPPORTED)}},[k.CLOSE]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString();x.clear();if(i===undefined||i.length>256)return doFatalSFTPError(e,"Malformed CLOSE packet");e._debug&&e._debug(`SFTP: Inbound: Received CLOSE (id:${n})`);if(!e.emit("CLOSE",n,i)){e.status(n,I.OP_UNSUPPORTED)}},[k.READ]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString();const s=x.readUInt64BE(e._biOpt);const o=x.readUInt32BE();x.clear();if(o===undefined||i.length>256)return doFatalSFTPError(e,"Malformed READ packet");e._debug&&e._debug(`SFTP: Inbound: Received READ (id:${n})`);if(!e.emit("READ",n,i,s,o)){e.status(n,I.OP_UNSUPPORTED)}},[k.WRITE]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString();const s=x.readUInt64BE(e._biOpt);const o=x.readString();x.clear();if(o===undefined||i.length>256)return doFatalSFTPError(e,"Malformed WRITE packet");e._debug&&e._debug(`SFTP: Inbound: Received WRITE (id:${n})`);if(!e.emit("WRITE",n,i,s,o)){e.status(n,I.OP_UNSUPPORTED)}},[k.LSTAT]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString(true);x.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed LSTAT packet");e._debug&&e._debug(`SFTP: Inbound: Received LSTAT (id:${n})`);if(!e.emit("LSTAT",n,i)){e.status(n,I.OP_UNSUPPORTED)}},[k.FSTAT]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString();x.clear();if(i===undefined||i.length>256)return doFatalSFTPError(e,"Malformed FSTAT packet");e._debug&&e._debug(`SFTP: Inbound: Received FSTAT (id:${n})`);if(!e.emit("FSTAT",n,i)){e.status(n,I.OP_UNSUPPORTED)}},[k.SETSTAT]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString(true);const s=readAttrs(e._biOpt);x.clear();if(s===undefined)return doFatalSFTPError(e,"Malformed SETSTAT packet");e._debug&&e._debug(`SFTP: Inbound: Received SETSTAT (id:${n})`);if(!e.emit("SETSTAT",n,i,s)){e.status(n,I.OP_UNSUPPORTED)}},[k.FSETSTAT]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString();const s=readAttrs(e._biOpt);x.clear();if(s===undefined||i.length>256)return doFatalSFTPError(e,"Malformed FSETSTAT packet");e._debug&&e._debug(`SFTP: Inbound: Received FSETSTAT (id:${n})`);if(!e.emit("FSETSTAT",n,i,s)){e.status(n,I.OP_UNSUPPORTED)}},[k.OPENDIR]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString(true);x.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed OPENDIR packet");e._debug&&e._debug(`SFTP: Inbound: Received OPENDIR (id:${n})`);if(!e.emit("OPENDIR",n,i)){e.status(n,I.OP_UNSUPPORTED)}},[k.READDIR]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString();x.clear();if(i===undefined||i.length>256)return doFatalSFTPError(e,"Malformed READDIR packet");e._debug&&e._debug(`SFTP: Inbound: Received READDIR (id:${n})`);if(!e.emit("READDIR",n,i)){e.status(n,I.OP_UNSUPPORTED)}},[k.REMOVE]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString(true);x.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed REMOVE packet");e._debug&&e._debug(`SFTP: Inbound: Received REMOVE (id:${n})`);if(!e.emit("REMOVE",n,i)){e.status(n,I.OP_UNSUPPORTED)}},[k.MKDIR]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString(true);const s=readAttrs(e._biOpt);x.clear();if(s===undefined)return doFatalSFTPError(e,"Malformed MKDIR packet");e._debug&&e._debug(`SFTP: Inbound: Received MKDIR (id:${n})`);if(!e.emit("MKDIR",n,i,s)){e.status(n,I.OP_UNSUPPORTED)}},[k.RMDIR]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString(true);x.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed RMDIR packet");e._debug&&e._debug(`SFTP: Inbound: Received RMDIR (id:${n})`);if(!e.emit("RMDIR",n,i)){e.status(n,I.OP_UNSUPPORTED)}},[k.REALPATH]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString(true);x.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed REALPATH packet");e._debug&&e._debug(`SFTP: Inbound: Received REALPATH (id:${n})`);if(!e.emit("REALPATH",n,i)){e.status(n,I.OP_UNSUPPORTED)}},[k.STAT]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString(true);x.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed STAT packet");e._debug&&e._debug(`SFTP: Inbound: Received STAT (id:${n})`);if(!e.emit("STAT",n,i)){e.status(n,I.OP_UNSUPPORTED)}},[k.RENAME]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString(true);const s=x.readString(true);x.clear();if(s===undefined)return doFatalSFTPError(e,"Malformed RENAME packet");e._debug&&e._debug(`SFTP: Inbound: Received RENAME (id:${n})`);if(!e.emit("RENAME",n,i,s)){e.status(n,I.OP_UNSUPPORTED)}},[k.READLINK]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString(true);x.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed READLINK packet");e._debug&&e._debug(`SFTP: Inbound: Received READLINK (id:${n})`);if(!e.emit("READLINK",n,i)){e.status(n,I.OP_UNSUPPORTED)}},[k.SYMLINK]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString(true);const s=x.readString(true);x.clear();if(s===undefined)return doFatalSFTPError(e,"Malformed SYMLINK packet");e._debug&&e._debug(`SFTP: Inbound: Received SYMLINK (id:${n})`);let o;if(e._isOpenSSH){o=e.emit("SYMLINK",n,s,i)}else{o=e.emit("SYMLINK",n,i,s)}if(!o){e.status(n,I.OP_UNSUPPORTED)}},[k.EXTENDED]:(e,t)=>{x.init(t,1);const n=x.readUInt32BE();const i=x.readString(true);if(i===undefined){x.clear();return doFatalSFTPError(e,"Malformed EXTENDED packet")}let s;if(x.avail())s=x.readRaw();x.clear();e._debug&&e._debug(`SFTP: Inbound: Received EXTENDED (id:${n})`);if(!e.emit("EXTENDED",n,i,s)){e.status(n,I.OP_UNSUPPORTED)}}};const{ERR_INVALID_ARG_TYPE:j,ERR_OUT_OF_RANGE:Y,validateNumber:V}=n(7609);const z=128;let J;const ee=[];function allocNewPool(e){if(ee.length>0)J=ee.pop();else J=Buffer.allocUnsafe(e);J.used=0}function checkPosition(e,t){if(!Number.isSafeInteger(e)){V(e,t);if(!Number.isInteger(e))throw new Y(t,"an integer",e);throw new Y(t,">= 0 and <= 2 ** 53 - 1",e)}if(e<0)throw new Y(t,">= 0 and <= 2 ** 53 - 1",e)}function roundUpToMultipleOf8(e){return e+7&~7}function ReadStream(e,t,n){if(n===undefined)n={};else if(typeof n==="string")n={encoding:n};else if(n===null||typeof n!=="object")throw new TypeError('"options" argument must be a string or an object');else n=Object.create(n);if(n.highWaterMark===undefined)n.highWaterMark=64*1024;n.emitClose=false;n.autoDestroy=false;f.call(this,n);this.path=t;this.flags=n.flags===undefined?"r":n.flags;this.mode=n.mode===undefined?438:n.mode;this.start=n.start;this.end=n.end;this.autoClose=n.autoClose===undefined?true:n.autoClose;this.pos=0;this.bytesRead=0;this.isClosed=false;this.handle=n.handle===undefined?null:n.handle;this.sftp=e;this._opening=false;if(this.start!==undefined){checkPosition(this.start,"start");this.pos=this.start}if(this.end===undefined){this.end=Infinity}else if(this.end!==Infinity){checkPosition(this.end,"end");if(this.start!==undefined&&this.start>this.end){throw new Y("start",`<= "end" (here: ${this.end})`,this.start)}}this.on("end",(function(){if(this.autoClose)this.destroy()}));if(!Buffer.isBuffer(this.handle))this.open()}l(ReadStream,f);ReadStream.prototype.open=function(){if(this._opening)return;this._opening=true;this.sftp.open(this.path,this.flags,this.mode,((e,t)=>{this._opening=false;if(e){this.emit("error",e);if(this.autoClose)this.destroy();return}this.handle=t;this.emit("open",t);this.emit("ready");this.read()}))};ReadStream.prototype._read=function(e){if(!Buffer.isBuffer(this.handle))return this.once("open",(()=>this._read(e)));if(this.destroyed)return;if(!J||J.length-J.used<z){allocNewPool(this.readableHighWaterMark||this._readableState.highWaterMark)}const t=J;let n=Math.min(J.length-J.used,e);const i=J.used;if(this.end!==undefined)n=Math.min(this.end-this.pos+1,n);if(n<=0)return this.push(null);this.sftp.read(this.handle,J,J.used,n,this.pos,((e,s)=>{if(e){this.emit("error",e);if(this.autoClose)this.destroy();return}let o=null;if(i+n===t.used&&t===J){t.used=roundUpToMultipleOf8(t.used+s-n)}else{const e=i+n&~7;const o=roundUpToMultipleOf8(i+s);if(e-o>=z)ee.push(t.slice(o,e))}if(s>0){this.bytesRead+=s;o=t.slice(i,i+s)}this.pos+=s;this.push(o)}));J.used=roundUpToMultipleOf8(J.used+n)};ReadStream.prototype._destroy=function(e,t){if(this._opening&&!Buffer.isBuffer(this.handle)){this.once("open",closeStream.bind(null,this,t,e));return}closeStream(this,t,e);this.handle=null;this._opening=false};function closeStream(e,t,n){if(!e.handle)return onclose();e.sftp.close(e.handle,onclose);function onclose(i){i=i||n;t(i);e.isClosed=true;if(!i)e.emit("close")}}ReadStream.prototype.close=function(e){this.destroy(null,e)};Object.defineProperty(ReadStream.prototype,"pending",{get(){return this.handle===null},configurable:true});function WriteStream(e,t,n){if(n===undefined)n={};else if(typeof n==="string")n={encoding:n};else if(n===null||typeof n!=="object")throw new TypeError('"options" argument must be a string or an object');else n=Object.create(n);n.emitClose=false;n.autoDestroy=false;u.call(this,n);this.path=t;this.flags=n.flags===undefined?"w":n.flags;this.mode=n.mode===undefined?438:n.mode;this.start=n.start;this.autoClose=n.autoClose===undefined?true:n.autoClose;this.pos=0;this.bytesWritten=0;this.isClosed=false;this.handle=n.handle===undefined?null:n.handle;this.sftp=e;this._opening=false;if(this.start!==undefined){checkPosition(this.start,"start");this.pos=this.start}if(n.encoding)this.setDefaultEncoding(n.encoding);this.on("finish",(function(){if(this._writableState.finalCalled)return;if(this.autoClose)this.destroy()}));if(!Buffer.isBuffer(this.handle))this.open()}l(WriteStream,u);WriteStream.prototype._final=function(e){if(this.autoClose)this.destroy();e()};WriteStream.prototype.open=function(){if(this._opening)return;this._opening=true;this.sftp.open(this.path,this.flags,this.mode,((e,t)=>{this._opening=false;if(e){this.emit("error",e);if(this.autoClose)this.destroy();return}this.handle=t;const tryAgain=e=>{if(e){this.sftp.chmod(this.path,this.mode,(e=>tryAgain()));return}if(this.flags[0]==="a"){const tryStat=(e,n)=>{if(e){this.sftp.stat(this.path,((t,n)=>{if(t){this.destroy();this.emit("error",e);return}tryStat(null,n)}));return}this.pos=n.size;this.emit("open",t);this.emit("ready")};this.sftp.fstat(t,tryStat);return}this.emit("open",t);this.emit("ready")};this.sftp.fchmod(t,this.mode,tryAgain)}))};WriteStream.prototype._write=function(e,t,n){if(!Buffer.isBuffer(e)){const t=new j("data","Buffer",e);return this.emit("error",t)}if(!Buffer.isBuffer(this.handle)){return this.once("open",(function(){this._write(e,t,n)}))}this.sftp.write(this.handle,e,0,e.length,this.pos,((e,t)=>{if(e){if(this.autoClose)this.destroy();return n(e)}this.bytesWritten+=t;n()}));this.pos+=e.length};WriteStream.prototype._writev=function(e,t){if(!Buffer.isBuffer(this.handle)){return this.once("open",(function(){this._writev(e,t)}))}const n=this.sftp;const i=this.handle;let s=e.length;const onwrite=(e,n)=>{if(e){this.destroy();return t(e)}this.bytesWritten+=n;if(--s===0)t()};for(let t=0;t<e.length;++t){const s=e[t].chunk;n.write(i,s,0,s.length,this.pos,onwrite);this.pos+=s.length}};if(typeof u.prototype.destroy!=="function")WriteStream.prototype.destroy=ReadStream.prototype.destroy;WriteStream.prototype._destroy=ReadStream.prototype._destroy;WriteStream.prototype.close=function(e){if(e){if(this.isClosed){process.nextTick(e);return}this.on("close",e)}if(!this.autoClose)this.on("finish",this.destroy.bind(this));this.end()};WriteStream.prototype.destroySoon=WriteStream.prototype.end;Object.defineProperty(WriteStream.prototype,"pending",{get(){return this.handle===null},configurable:true});e.exports={flagsToString:$,OPEN_MODE:B,SFTP:SFTP,Stats:Stats,STATUS_CODE:I,stringToFlags:stringToFlags}},6832:(e,t,n)=>{"use strict";const i=n(6113);let s;try{s=n(4137)()}catch{}const{bindingAvailable:o,CIPHER_INFO:f,MAC_INFO:u}=n(5708);const l=(()=>{if(typeof i.sign==="function"&&typeof i.verify==="function"){const e="-----BEGIN PRIVATE KEY-----\r\nMC4CAQAwBQYDK2VwBCIEIHKj+sVa9WcD"+"/q2DJUJaf43Kptc8xYuUQA4bOFj9vC8T\r\n-----END PRIVATE KEY-----";const t=Buffer.from("a");let n;let s;try{n=i.sign(null,t,e);s=i.verify(null,t,e,n)}catch{}return Buffer.isBuffer(n)&&n.length===64&&s===true}return false})();const h=typeof i.diffieHellman==="function"&&typeof i.generateKeyPairSync==="function"&&typeof i.createPublicKey==="function";const p=["ecdh-sha2-nistp256","ecdh-sha2-nistp384","ecdh-sha2-nistp521","diffie-hellman-group-exchange-sha256","diffie-hellman-group14-sha256","diffie-hellman-group15-sha512","diffie-hellman-group16-sha512","diffie-hellman-group17-sha512","diffie-hellman-group18-sha512"];if(h){p.unshift("curve25519-sha256");p.unshift("curve25519-sha256@libssh.org")}const g=p.concat(["diffie-hellman-group-exchange-sha1","diffie-hellman-group14-sha1","diffie-hellman-group1-sha1"]);const _=["ecdsa-sha2-nistp256","ecdsa-sha2-nistp384","ecdsa-sha2-nistp521","rsa-sha2-512","rsa-sha2-256","ssh-rsa"];if(l)_.unshift("ssh-ed25519");const E=_.concat(["ssh-dss"]);const y=(()=>{const e=i.getCiphers();return t=>e.includes(f[t].sslName)})();let b=["aes128-gcm@openssh.com","aes256-gcm@openssh.com","aes128-ctr","aes192-ctr","aes256-ctr"];if(s&&s.flags&&!s.flags.aes){if(o)b.unshift("chacha20-poly1305@openssh.com");else b.push("chacha20-poly1305@openssh.com")}else if(o&&s&&s.arch==="x86"){b.splice(4,0,"chacha20-poly1305@openssh.com")}else{b.push("chacha20-poly1305@openssh.com")}b=b.filter(y);const w=b.concat(["aes256-cbc","aes192-cbc","aes128-cbc","blowfish-cbc","3des-cbc","aes128-gcm","aes256-gcm","arcfour256","arcfour128","cast128-cbc","arcfour"].filter(y));const I=(()=>{const e=i.getHashes();return t=>e.includes(u[t].sslName)})();const C=["hmac-sha2-256-etm@openssh.com","hmac-sha2-512-etm@openssh.com","hmac-sha1-etm@openssh.com","hmac-sha2-256","hmac-sha2-512","hmac-sha1"].filter(I);const v=C.concat(["hmac-md5","hmac-sha2-256-96","hmac-sha2-512-96","hmac-ripemd160","hmac-sha1-96","hmac-md5-96"].filter(I));const k=["none","zlib@openssh.com","zlib"];const R=k.concat([]);const B={BAD_DHGEX:1<<0,OLD_EXIT:1<<1,DYN_RPORT_BUG:1<<2,BUG_DHGEX_LARGE:1<<3};e.exports={MESSAGE:{DISCONNECT:1,IGNORE:2,UNIMPLEMENTED:3,DEBUG:4,SERVICE_REQUEST:5,SERVICE_ACCEPT:6,KEXINIT:20,NEWKEYS:21,KEXDH_INIT:30,KEXDH_REPLY:31,KEXDH_GEX_GROUP:31,KEXDH_GEX_INIT:32,KEXDH_GEX_REPLY:33,KEXDH_GEX_REQUEST:34,KEXECDH_INIT:30,KEXECDH_REPLY:31,USERAUTH_REQUEST:50,USERAUTH_FAILURE:51,USERAUTH_SUCCESS:52,USERAUTH_BANNER:53,USERAUTH_PASSWD_CHANGEREQ:60,USERAUTH_PK_OK:60,USERAUTH_INFO_REQUEST:60,USERAUTH_INFO_RESPONSE:61,GLOBAL_REQUEST:80,REQUEST_SUCCESS:81,REQUEST_FAILURE:82,CHANNEL_OPEN:90,CHANNEL_OPEN_CONFIRMATION:91,CHANNEL_OPEN_FAILURE:92,CHANNEL_WINDOW_ADJUST:93,CHANNEL_DATA:94,CHANNEL_EXTENDED_DATA:95,CHANNEL_EOF:96,CHANNEL_CLOSE:97,CHANNEL_REQUEST:98,CHANNEL_SUCCESS:99,CHANNEL_FAILURE:100},DISCONNECT_REASON:{HOST_NOT_ALLOWED_TO_CONNECT:1,PROTOCOL_ERROR:2,KEY_EXCHANGE_FAILED:3,RESERVED:4,MAC_ERROR:5,COMPRESSION_ERROR:6,SERVICE_NOT_AVAILABLE:7,PROTOCOL_VERSION_NOT_SUPPORTED:8,HOST_KEY_NOT_VERIFIABLE:9,CONNECTION_LOST:10,BY_APPLICATION:11,TOO_MANY_CONNECTIONS:12,AUTH_CANCELED_BY_USER:13,NO_MORE_AUTH_METHODS_AVAILABLE:14,ILLEGAL_USER_NAME:15},DISCONNECT_REASON_STR:undefined,CHANNEL_OPEN_FAILURE:{ADMINISTRATIVELY_PROHIBITED:1,CONNECT_FAILED:2,UNKNOWN_CHANNEL_TYPE:3,RESOURCE_SHORTAGE:4},TERMINAL_MODE:{TTY_OP_END:0,VINTR:1,VQUIT:2,VERASE:3,VKILL:4,VEOF:5,VEOL:6,VEOL2:7,VSTART:8,VSTOP:9,VSUSP:10,VDSUSP:11,VREPRINT:12,VWERASE:13,VLNEXT:14,VFLUSH:15,VSWTCH:16,VSTATUS:17,VDISCARD:18,IGNPAR:30,PARMRK:31,INPCK:32,ISTRIP:33,INLCR:34,IGNCR:35,ICRNL:36,IUCLC:37,IXON:38,IXANY:39,IXOFF:40,IMAXBEL:41,ISIG:50,ICANON:51,XCASE:52,ECHO:53,ECHOE:54,ECHOK:55,ECHONL:56,NOFLSH:57,TOSTOP:58,IEXTEN:59,ECHOCTL:60,ECHOKE:61,PENDIN:62,OPOST:70,OLCUC:71,ONLCR:72,OCRNL:73,ONOCR:74,ONLRET:75,CS7:90,CS8:91,PARENB:92,PARODD:93,TTY_OP_ISPEED:128,TTY_OP_OSPEED:129},CHANNEL_EXTENDED_DATATYPE:{STDERR:1},SIGNALS:["ABRT","ALRM","FPE","HUP","ILL","INT","QUIT","SEGV","TERM","USR1","USR2","KILL","PIPE"].reduce(((e,t)=>({...e,[t]:1})),{}),COMPAT:B,COMPAT_CHECKS:[["Cisco-1.25",B.BAD_DHGEX],[/^Cisco-1\./,B.BUG_DHGEX_LARGE],[/^[0-9.]+$/,B.OLD_EXIT],[/^OpenSSH_5\.\d+/,B.DYN_RPORT_BUG]],DEFAULT_KEX:p,SUPPORTED_KEX:g,DEFAULT_SERVER_HOST_KEY:_,SUPPORTED_SERVER_HOST_KEY:E,DEFAULT_CIPHER:b,SUPPORTED_CIPHER:w,DEFAULT_MAC:C,SUPPORTED_MAC:v,DEFAULT_COMPRESSION:k,SUPPORTED_COMPRESSION:R,curve25519Supported:h,eddsaSupported:l};e.exports.DISCONNECT_REASON_BY_VALUE=Array.from(Object.entries(e.exports.DISCONNECT_REASON)).reduce(((e,[t,n])=>({...e,[n]:t})),{})},5708:(e,t,n)=>{"use strict";const{createCipheriv:i,createDecipheriv:s,createHmac:o,randomFillSync:f,timingSafeEqual:u}=n(6113);const{readUInt32BE:l,writeUInt32BE:h}=n(9475);const p=Buffer[Symbol.species];const g=2**32-1;const _=Buffer.alloc(0);const E=Buffer.alloc(4);const y=new Map;const b=35e3;let w;let I;let C;let v;let k;let R;let B;try{w=n(9041);({AESGCMCipher:I,ChaChaPolyCipher:C,GenericCipher:v,AESGCMDecipher:k,ChaChaPolyDecipher:R,GenericDecipher:B}=w)}catch{}const T=1<<0;const O=(()=>{function info(e,t,n,i,s,o,f){return{sslName:e,blockLen:t,keyLen:n,ivLen:i!==0||f&T?i:t,authLen:s,discardLen:o,stream:!!(f&T)}}return{"chacha20-poly1305@openssh.com":info("chacha20",8,64,0,16,0,T),"aes128-gcm":info("aes-128-gcm",16,16,12,16,0,T),"aes256-gcm":info("aes-256-gcm",16,32,12,16,0,T),"aes128-gcm@openssh.com":info("aes-128-gcm",16,16,12,16,0,T),"aes256-gcm@openssh.com":info("aes-256-gcm",16,32,12,16,0,T),"aes128-cbc":info("aes-128-cbc",16,16,0,0,0,0),"aes192-cbc":info("aes-192-cbc",16,24,0,0,0,0),"aes256-cbc":info("aes-256-cbc",16,32,0,0,0,0),"rijndael-cbc@lysator.liu.se":info("aes-256-cbc",16,32,0,0,0,0),"3des-cbc":info("des-ede3-cbc",8,24,0,0,0,0),"blowfish-cbc":info("bf-cbc",8,16,0,0,0,0),"idea-cbc":info("idea-cbc",8,16,0,0,0,0),"cast128-cbc":info("cast-cbc",8,16,0,0,0,0),"aes128-ctr":info("aes-128-ctr",16,16,16,0,0,T),"aes192-ctr":info("aes-192-ctr",16,24,16,0,0,T),"aes256-ctr":info("aes-256-ctr",16,32,16,0,0,T),"3des-ctr":info("des-ede3",8,24,8,0,0,T),"blowfish-ctr":info("bf-ecb",8,16,8,0,0,T),"cast128-ctr":info("cast5-ecb",8,16,8,0,0,T),arcfour:info("rc4",8,16,0,0,1536,T),arcfour128:info("rc4",8,16,0,0,1536,T),arcfour256:info("rc4",8,32,0,0,1536,T),arcfour512:info("rc4",8,64,0,0,1536,T)}})();const P=(()=>{function info(e,t,n,i){return{sslName:e,len:t,actualLen:n,isETM:i}}return{"hmac-md5":info("md5",16,16,false),"hmac-md5-96":info("md5",16,12,false),"hmac-ripemd160":info("ripemd160",20,20,false),"hmac-sha1":info("sha1",20,20,false),"hmac-sha1-etm@openssh.com":info("sha1",20,20,true),"hmac-sha1-96":info("sha1",20,12,false),"hmac-sha2-256":info("sha256",32,32,false),"hmac-sha2-256-etm@openssh.com":info("sha256",32,32,true),"hmac-sha2-256-96":info("sha256",32,12,false),"hmac-sha2-512":info("sha512",64,64,false),"hmac-sha2-512-etm@openssh.com":info("sha512",64,64,true),"hmac-sha2-512-96":info("sha512",64,12,false)}})();class NullCipher{constructor(e,t){this.outSeqno=e;this._onWrite=t;this._dead=false}free(){this._dead=true}allocPacket(e){let t=4+1+e;let n=8-(t&8-1);if(n<4)n+=8;t+=n;const i=Buffer.allocUnsafe(t);h(i,t-4,0);i[4]=n;f(i,5+e,n);return i}encrypt(e){if(this._dead)return;this._onWrite(e);this.outSeqno=this.outSeqno+1>>>0}}const L=Buffer.alloc(32);const U=Buffer.alloc(16);let D;let x;let Q;class ChaChaPolyCipherNative{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._encKeyMain=t.cipherKey.slice(0,32);this._encKeyPktLen=t.cipherKey.slice(32);this._dead=false}free(){this._dead=true}allocPacket(e){let t=4+1+e;let n=8-(t-4&8-1);if(n<4)n+=8;t+=n;const i=Buffer.allocUnsafe(t);h(i,t-4,0);i[4]=n;f(i,5+e,n);return i}encrypt(e){if(this._dead)return;U[0]=0;h(U,this.outSeqno,12);const t=i("chacha20",this._encKeyMain,U).update(L);const n=i("chacha20",this._encKeyPktLen,U).update(e.slice(0,4));this._onWrite(n);U[0]=1;const s=i("chacha20",this._encKeyMain,U).update(e.slice(4));this._onWrite(s);Q(x,n,n.length,s,s.length,t);const o=Buffer.allocUnsafe(16);o.set(new Uint8Array(D.HEAPU8.buffer,x,16),0);this._onWrite(o);this.outSeqno=this.outSeqno+1>>>0}}class ChaChaPolyCipherBinding{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._instance=new C(t.cipherKey);this._dead=false}free(){this._dead=true;this._instance.free()}allocPacket(e){let t=4+1+e;let n=8-(t-4&8-1);if(n<4)n+=8;t+=n;const i=Buffer.allocUnsafe(t+16);h(i,t-4,0);i[4]=n;f(i,5+e,n);return i}encrypt(e){if(this._dead)return;this._instance.encrypt(e,this.outSeqno);this._onWrite(e);this.outSeqno=this.outSeqno+1>>>0}}class AESGCMCipherNative{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._encSSLName=t.cipherInfo.sslName;this._encKey=t.cipherKey;this._encIV=t.cipherIV;this._dead=false}free(){this._dead=true}allocPacket(e){let t=4+1+e;let n=16-(t-4&16-1);if(n<4)n+=16;t+=n;const i=Buffer.allocUnsafe(t);h(i,t-4,0);i[4]=n;f(i,5+e,n);return i}encrypt(e){if(this._dead)return;const t=i(this._encSSLName,this._encKey,this._encIV);t.setAutoPadding(false);const n=e.slice(0,4);t.setAAD(n);this._onWrite(n);const s=t.update(e.slice(4));this._onWrite(s);const o=t.final();if(o.length)this._onWrite(o);const f=t.getAuthTag();this._onWrite(f);ivIncrement(this._encIV);this.outSeqno=this.outSeqno+1>>>0}}class AESGCMCipherBinding{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._instance=new I(t.cipherInfo.sslName,t.cipherKey,t.cipherIV);this._dead=false}free(){this._dead=true;this._instance.free()}allocPacket(e){let t=4+1+e;let n=16-(t-4&16-1);if(n<4)n+=16;t+=n;const i=Buffer.allocUnsafe(t+16);h(i,t-4,0);i[4]=n;f(i,5+e,n);return i}encrypt(e){if(this._dead)return;this._instance.encrypt(e);this._onWrite(e);this.outSeqno=this.outSeqno+1>>>0}}class GenericCipherNative{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._encBlockLen=t.cipherInfo.blockLen;this._cipherInstance=i(t.cipherInfo.sslName,t.cipherKey,t.cipherIV);this._macSSLName=t.macInfo.sslName;this._macKey=t.macKey;this._macActualLen=t.macInfo.actualLen;this._macETM=t.macInfo.isETM;this._aadLen=this._macETM?4:0;this._dead=false;const n=t.cipherInfo.discardLen;if(n){let e=y.get(n);if(e===undefined){e=Buffer.alloc(n);y.set(n,e)}this._cipherInstance.update(e)}}free(){this._dead=true}allocPacket(e){const t=this._encBlockLen;let n=4+1+e;let i=t-(n-this._aadLen&t-1);if(i<4)i+=t;n+=i;const s=Buffer.allocUnsafe(n);h(s,n-4,0);s[4]=i;f(s,5+e,i);return s}encrypt(e){if(this._dead)return;let t;if(this._macETM){const n=new Uint8Array(e.buffer,e.byteOffset,4);const i=this._cipherInstance.update(new Uint8Array(e.buffer,e.byteOffset+4,e.length-4));this._onWrite(n);this._onWrite(i);t=o(this._macSSLName,this._macKey);h(E,this.outSeqno,0);t.update(E);t.update(n);t.update(i)}else{const n=this._cipherInstance.update(e);this._onWrite(n);t=o(this._macSSLName,this._macKey);h(E,this.outSeqno,0);t.update(E);t.update(e)}let n=t.digest();if(n.length>this._macActualLen)n=n.slice(0,this._macActualLen);this._onWrite(n);this.outSeqno=this.outSeqno+1>>>0}}class GenericCipherBinding{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._encBlockLen=t.cipherInfo.blockLen;this._macLen=t.macInfo.len;this._macActualLen=t.macInfo.actualLen;this._aadLen=t.macInfo.isETM?4:0;this._instance=new v(t.cipherInfo.sslName,t.cipherKey,t.cipherIV,t.macInfo.sslName,t.macKey,t.macInfo.isETM);this._dead=false}free(){this._dead=true;this._instance.free()}allocPacket(e){const t=this._encBlockLen;let n=4+1+e;let i=t-(n-this._aadLen&t-1);if(i<4)i+=t;n+=i;const s=Buffer.allocUnsafe(n+this._macLen);h(s,n-4,0);s[4]=i;f(s,5+e,i);return s}encrypt(e){if(this._dead)return;this._instance.encrypt(e,this.outSeqno);if(this._macActualLen<this._macLen){e=new p(e.buffer,e.byteOffset,e.length-(this._macLen-this._macActualLen))}this._onWrite(e);this.outSeqno=this.outSeqno+1>>>0}}class NullDecipher{constructor(e,t){this.inSeqno=e;this._onPayload=t;this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0}free(){}decrypt(e,t,n){while(t<n){if(this._lenBytes<4){let i=Math.min(4-this._lenBytes,n-t);this._lenBytes+=i;while(i--)this._len=(this._len<<8)+e[t++];if(this._lenBytes<4)return;if(this._len>b||this._len<8||(4+this._len&7)!==0){throw new Error("Bad packet length")}if(t>=n)return}if(this._packetPos<this._len){const i=Math.min(this._len-this._packetPos,n-t);let s;if(t!==0||i!==n)s=new Uint8Array(e.buffer,e.byteOffset+t,i);else s=e;if(i===this._len){this._packet=s}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(s,this._packetPos)}t+=i;this._packetPos+=i;if(this._packetPos<this._len)return}const i=!this._packet?_:new p(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0;{const e=this._onPayload(i);if(e!==undefined)return e===false?t:e}}}}class ChaChaPolyDecipherNative{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._decKeyMain=t.decipherKey.slice(0,32);this._decKeyPktLen=t.decipherKey.slice(32);this._len=0;this._lenBuf=Buffer.alloc(4);this._lenPos=0;this._packet=null;this._pktLen=0;this._mac=Buffer.allocUnsafe(16);this._calcMac=Buffer.allocUnsafe(16);this._macPos=0}free(){}decrypt(e,t,n){while(t<n){if(this._lenPos<4){let i=Math.min(4-this._lenPos,n-t);while(i--)this._lenBuf[this._lenPos++]=e[t++];if(this._lenPos<4)return;U[0]=0;h(U,this.inSeqno,12);const o=s("chacha20",this._decKeyPktLen,U).update(this._lenBuf);this._len=l(o,0);if(this._len>b||this._len<8||(this._len&7)!==0){throw new Error("Bad packet length")}}if(this._pktLen<this._len){if(t>=n)return;const i=Math.min(this._len-this._pktLen,n-t);let s;if(t!==0||i!==n)s=new Uint8Array(e.buffer,e.byteOffset+t,i);else s=e;if(i===this._len){this._packet=s}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(s,this._pktLen)}t+=i;this._pktLen+=i;if(this._pktLen<this._len||t>=n)return}{const i=Math.min(16-this._macPos,n-t);if(t!==0||i!==n){this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,i),this._macPos)}else{this._mac.set(e,this._macPos)}t+=i;this._macPos+=i;if(this._macPos<16)return}U[0]=0;h(U,this.inSeqno,12);const o=i("chacha20",this._decKeyMain,U).update(L);Q(x,this._lenBuf,4,this._packet,this._packet.length,o);this._calcMac.set(new Uint8Array(D.HEAPU8.buffer,x,16),0);if(!u(this._calcMac,this._mac))throw new Error("Invalid MAC");U[0]=1;const f=s("chacha20",this._decKeyMain,U).update(this._packet);const g=new p(f.buffer,f.byteOffset+1,f.length-f[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenPos=0;this._packet=null;this._pktLen=0;this._macPos=0;{const e=this._onPayload(g);if(e!==undefined)return e===false?t:e}}}}class ChaChaPolyDecipherBinding{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._instance=new R(t.decipherKey);this._len=0;this._lenBuf=Buffer.alloc(4);this._lenPos=0;this._packet=null;this._pktLen=0;this._mac=Buffer.allocUnsafe(16);this._macPos=0}free(){this._instance.free()}decrypt(e,t,n){while(t<n){if(this._lenPos<4){let i=Math.min(4-this._lenPos,n-t);while(i--)this._lenBuf[this._lenPos++]=e[t++];if(this._lenPos<4)return;this._len=this._instance.decryptLen(this._lenBuf,this.inSeqno);if(this._len>b||this._len<8||(this._len&7)!==0){throw new Error("Bad packet length")}if(t>=n)return}if(this._pktLen<this._len){const i=Math.min(this._len-this._pktLen,n-t);let s;if(t!==0||i!==n)s=new Uint8Array(e.buffer,e.byteOffset+t,i);else s=e;if(i===this._len){this._packet=s}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(s,this._pktLen)}t+=i;this._pktLen+=i;if(this._pktLen<this._len||t>=n)return}{const i=Math.min(16-this._macPos,n-t);if(t!==0||i!==n){this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,i),this._macPos)}else{this._mac.set(e,this._macPos)}t+=i;this._macPos+=i;if(this._macPos<16)return}this._instance.decrypt(this._packet,this._mac,this.inSeqno);const i=new p(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenPos=0;this._packet=null;this._pktLen=0;this._macPos=0;{const e=this._onPayload(i);if(e!==undefined)return e===false?t:e}}}}class AESGCMDecipherNative{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._decipherInstance=null;this._decipherSSLName=t.decipherInfo.sslName;this._decipherKey=t.decipherKey;this._decipherIV=t.decipherIV;this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._tag=Buffer.allocUnsafe(16);this._tagPos=0}free(){}decrypt(e,t,n){while(t<n){if(this._lenBytes<4){let i=Math.min(4-this._lenBytes,n-t);this._lenBytes+=i;while(i--)this._len=(this._len<<8)+e[t++];if(this._lenBytes<4)return;if(this._len+20>b||this._len<16||(this._len&15)!==0){throw new Error("Bad packet length")}this._decipherInstance=s(this._decipherSSLName,this._decipherKey,this._decipherIV);this._decipherInstance.setAutoPadding(false);this._decipherInstance.setAAD(W(this._len))}if(this._pktLen<this._len){if(t>=n)return;const i=Math.min(this._len-this._pktLen,n-t);let s;if(t!==0||i!==n){s=this._decipherInstance.update(new Uint8Array(e.buffer,e.byteOffset+t,i))}else{s=this._decipherInstance.update(e)}if(s.length){if(i===this._len){this._packet=s}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(s,this._packetPos)}this._packetPos+=s.length}t+=i;this._pktLen+=i;if(this._pktLen<this._len||t>=n)return}{const i=Math.min(16-this._tagPos,n-t);if(t!==0||i!==n){this._tag.set(new Uint8Array(e.buffer,e.byteOffset+t,i),this._tagPos)}else{this._tag.set(e,this._tagPos)}t+=i;this._tagPos+=i;if(this._tagPos<16)return}{this._decipherInstance.setAuthTag(this._tag);const e=this._decipherInstance.final();if(e.length){if(this._packet)this._packet.set(e,this._packetPos);else this._packet=e}}const i=!this._packet?_:new p(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;ivIncrement(this._decipherIV);this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._tagPos=0;{const e=this._onPayload(i);if(e!==undefined)return e===false?t:e}}}}class AESGCMDecipherBinding{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._instance=new k(t.decipherInfo.sslName,t.decipherKey,t.decipherIV);this._len=0;this._lenBytes=0;this._packet=null;this._pktLen=0;this._tag=Buffer.allocUnsafe(16);this._tagPos=0}free(){}decrypt(e,t,n){while(t<n){if(this._lenBytes<4){let i=Math.min(4-this._lenBytes,n-t);this._lenBytes+=i;while(i--)this._len=(this._len<<8)+e[t++];if(this._lenBytes<4)return;if(this._len+20>b||this._len<16||(this._len&15)!==0){throw new Error(`Bad packet length: ${this._len}`)}}if(this._pktLen<this._len){if(t>=n)return;const i=Math.min(this._len-this._pktLen,n-t);let s;if(t!==0||i!==n)s=new Uint8Array(e.buffer,e.byteOffset+t,i);else s=e;if(i===this._len){this._packet=s}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(s,this._pktLen)}t+=i;this._pktLen+=i;if(this._pktLen<this._len||t>=n)return}{const i=Math.min(16-this._tagPos,n-t);if(t!==0||i!==n){this._tag.set(new Uint8Array(e.buffer,e.byteOffset+t,i),this._tagPos)}else{this._tag.set(e,this._tagPos)}t+=i;this._tagPos+=i;if(this._tagPos<16)return}this._instance.decrypt(this._packet,this._len,this._tag);const i=new p(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenBytes=0;this._packet=null;this._pktLen=0;this._tagPos=0;{const e=this._onPayload(i);if(e!==undefined)return e===false?t:e}}}}class GenericDecipherNative{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._decipherInstance=s(t.decipherInfo.sslName,t.decipherKey,t.decipherIV);this._decipherInstance.setAutoPadding(false);this._block=Buffer.allocUnsafe(t.macInfo.isETM?4:t.decipherInfo.blockLen);this._blockSize=t.decipherInfo.blockLen;this._blockPos=0;this._len=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._mac=Buffer.allocUnsafe(t.macInfo.actualLen);this._macPos=0;this._macSSLName=t.macInfo.sslName;this._macKey=t.macKey;this._macActualLen=t.macInfo.actualLen;this._macETM=t.macInfo.isETM;this._macInstance=null;const n=t.decipherInfo.discardLen;if(n){let e=y.get(n);if(e===undefined){e=Buffer.alloc(n);y.set(n,e)}this._decipherInstance.update(e)}}free(){}decrypt(e,t,n){while(t<n){if(this._blockPos<this._block.length){const i=Math.min(this._block.length-this._blockPos,n-t);if(t!==0||i!==n||i<e.length){this._block.set(new Uint8Array(e.buffer,e.byteOffset+t,i),this._blockPos)}else{this._block.set(e,this._blockPos)}t+=i;this._blockPos+=i;if(this._blockPos<this._block.length)return;let s;let f;if(this._macETM){this._len=f=l(this._block,0)}else{s=this._decipherInstance.update(this._block);this._len=l(s,0);f=4+this._len-this._blockSize}if(this._len>b||this._len<5||(f&this._blockSize-1)!==0){throw new Error("Bad packet length")}this._macInstance=o(this._macSSLName,this._macKey);h(E,this.inSeqno,0);this._macInstance.update(E);if(this._macETM){this._macInstance.update(this._block)}else{this._macInstance.update(new Uint8Array(s.buffer,s.byteOffset,4));this._pktLen=s.length-4;this._packetPos=this._pktLen;this._packet=Buffer.allocUnsafe(this._len);this._packet.set(new Uint8Array(s.buffer,s.byteOffset+4,this._packetPos),0)}if(t>=n)return}if(this._pktLen<this._len){const i=Math.min(this._len-this._pktLen,n-t);let s;if(t!==0||i!==n)s=new Uint8Array(e.buffer,e.byteOffset+t,i);else s=e;if(this._macETM)this._macInstance.update(s);const o=this._decipherInstance.update(s);if(o.length){if(i===this._len){this._packet=o}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(o,this._packetPos)}this._packetPos+=o.length}t+=i;this._pktLen+=i;if(this._pktLen<this._len||t>=n)return}{const i=Math.min(this._macActualLen-this._macPos,n-t);if(t!==0||i!==n){this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,i),this._macPos)}else{this._mac.set(e,this._macPos)}t+=i;this._macPos+=i;if(this._macPos<this._macActualLen)return}if(!this._macETM)this._macInstance.update(this._packet);let i=this._macInstance.digest();if(this._macActualLen<i.length){i=new Uint8Array(i.buffer,i.byteOffset,this._macActualLen)}if(!timingSafeEquals(i,this._mac))throw new Error("Invalid MAC");const s=new p(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._blockPos=0;this._len=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._macPos=0;this._macInstance=null;{const e=this._onPayload(s);if(e!==undefined)return e===false?t:e}}}}class GenericDecipherBinding{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._instance=new B(t.decipherInfo.sslName,t.decipherKey,t.decipherIV,t.macInfo.sslName,t.macKey,t.macInfo.isETM,t.macInfo.actualLen);this._block=Buffer.allocUnsafe(t.macInfo.isETM||t.decipherInfo.stream?4:t.decipherInfo.blockLen);this._blockPos=0;this._len=0;this._packet=null;this._pktLen=0;this._mac=Buffer.allocUnsafe(t.macInfo.actualLen);this._macPos=0;this._macActualLen=t.macInfo.actualLen;this._macETM=t.macInfo.isETM}free(){this._instance.free()}decrypt(e,t,n){while(t<n){if(this._blockPos<this._block.length){const i=Math.min(this._block.length-this._blockPos,n-t);if(t!==0||i!==n||i<e.length){this._block.set(new Uint8Array(e.buffer,e.byteOffset+t,i),this._blockPos)}else{this._block.set(e,this._blockPos)}t+=i;this._blockPos+=i;if(this._blockPos<this._block.length)return;let s;if(this._macETM){this._len=s=l(this._block,0)}else{this._instance.decryptBlock(this._block);this._len=l(this._block,0);s=4+this._len-this._block.length}if(this._len>b||this._len<5||(s&this._block.length-1)!==0){throw new Error("Bad packet length")}if(!this._macETM){this._pktLen=this._block.length-4;if(this._pktLen){this._packet=Buffer.allocUnsafe(this._len);this._packet.set(new Uint8Array(this._block.buffer,this._block.byteOffset+4,this._pktLen),0)}}if(t>=n)return}if(this._pktLen<this._len){const i=Math.min(this._len-this._pktLen,n-t);let s;if(t!==0||i!==n)s=new Uint8Array(e.buffer,e.byteOffset+t,i);else s=e;if(i===this._len){this._packet=s}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(s,this._pktLen)}t+=i;this._pktLen+=i;if(this._pktLen<this._len||t>=n)return}{const i=Math.min(this._macActualLen-this._macPos,n-t);if(t!==0||i!==n){this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,i),this._macPos)}else{this._mac.set(e,this._macPos)}t+=i;this._macPos+=i;if(this._macPos<this._macActualLen)return}this._instance.decrypt(this._packet,this.inSeqno,this._block,this._mac);const i=new p(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._blockPos=0;this._len=0;this._packet=null;this._pktLen=0;this._macPos=0;this._macInstance=null;{const e=this._onPayload(i);if(e!==undefined)return e===false?t:e}}}}function ivIncrement(e){++e[11]>>>8&&++e[10]>>>8&&++e[9]>>>8&&++e[8]>>>8&&++e[7]>>>8&&++e[6]>>>8&&++e[5]>>>8&&++e[4]>>>8}const W=(()=>{const e=Buffer.alloc(4);return t=>{e[0]=t>>>24;e[1]=t>>>16;e[2]=t>>>8;e[3]=t;return e}})();function timingSafeEquals(e,t){if(e.length!==t.length){u(e,e);return false}return u(e,t)}function createCipher(e){if(typeof e!=="object"||e===null)throw new Error("Invalid config");if(typeof e.outbound!=="object"||e.outbound===null)throw new Error("Invalid outbound");const t=e.outbound;if(typeof t.onWrite!=="function")throw new Error("Invalid outbound.onWrite");if(typeof t.cipherInfo!=="object"||t.cipherInfo===null)throw new Error("Invalid outbound.cipherInfo");if(!Buffer.isBuffer(t.cipherKey)||t.cipherKey.length!==t.cipherInfo.keyLen){throw new Error("Invalid outbound.cipherKey")}if(t.cipherInfo.ivLen&&(!Buffer.isBuffer(t.cipherIV)||t.cipherIV.length!==t.cipherInfo.ivLen)){throw new Error("Invalid outbound.cipherIV")}if(typeof t.seqno!=="number"||t.seqno<0||t.seqno>g){throw new Error("Invalid outbound.seqno")}const n=!!t.forceNative;switch(t.cipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return I&&!n?new AESGCMCipherBinding(e):new AESGCMCipherNative(e);case"chacha20":return C&&!n?new ChaChaPolyCipherBinding(e):new ChaChaPolyCipherNative(e);default:{if(typeof t.macInfo!=="object"||t.macInfo===null)throw new Error("Invalid outbound.macInfo");if(!Buffer.isBuffer(t.macKey)||t.macKey.length!==t.macInfo.len){throw new Error("Invalid outbound.macKey")}return v&&!n?new GenericCipherBinding(e):new GenericCipherNative(e)}}}function createDecipher(e){if(typeof e!=="object"||e===null)throw new Error("Invalid config");if(typeof e.inbound!=="object"||e.inbound===null)throw new Error("Invalid inbound");const t=e.inbound;if(typeof t.onPayload!=="function")throw new Error("Invalid inbound.onPayload");if(typeof t.decipherInfo!=="object"||t.decipherInfo===null){throw new Error("Invalid inbound.decipherInfo")}if(!Buffer.isBuffer(t.decipherKey)||t.decipherKey.length!==t.decipherInfo.keyLen){throw new Error("Invalid inbound.decipherKey")}if(t.decipherInfo.ivLen&&(!Buffer.isBuffer(t.decipherIV)||t.decipherIV.length!==t.decipherInfo.ivLen)){throw new Error("Invalid inbound.decipherIV")}if(typeof t.seqno!=="number"||t.seqno<0||t.seqno>g){throw new Error("Invalid inbound.seqno")}const n=!!t.forceNative;switch(t.decipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return k&&!n?new AESGCMDecipherBinding(e):new AESGCMDecipherNative(e);case"chacha20":return R&&!n?new ChaChaPolyDecipherBinding(e):new ChaChaPolyDecipherNative(e);default:{if(typeof t.macInfo!=="object"||t.macInfo===null)throw new Error("Invalid inbound.macInfo");if(!Buffer.isBuffer(t.macKey)||t.macKey.length!==t.macInfo.len){throw new Error("Invalid inbound.macKey")}return B&&!n?new GenericDecipherBinding(e):new GenericDecipherNative(e)}}}e.exports={CIPHER_INFO:O,MAC_INFO:P,bindingAvailable:!!w,init:(()=>new Promise((async(e,t)=>{try{D=await n(4989)();x=D._malloc(16);Q=D.cwrap("poly1305_auth",null,["number","array","number","array","number","array"])}catch(e){return t(e)}e()})))(),NullCipher:NullCipher,createCipher:createCipher,NullDecipher:NullDecipher,createDecipher:createDecipher}},4989:(e,t,n)=>{var i=function(){var e=typeof document!=="undefined"&&document.currentScript?document.currentScript.src:undefined;if(typeof __filename!=="undefined")e=e||__filename;return function(t){t=t||{};var i;i||(i=typeof t!=="undefined"?t:{});var s,o;i.ready=new Promise((function(e,t){s=e;o=t}));var f={},u;for(u in i)i.hasOwnProperty(u)&&(f[u]=i[u]);var l="object"===typeof window,h="function"===typeof importScripts,p="object"===typeof process&&"object"===typeof process.versions&&"string"===typeof process.versions.node,g="",_,E,y,b,w;if(p)g=h?n(1017).dirname(g)+"/":__dirname+"/",_=function(e,t){var i=H(e);if(i)return t?i:i.toString();b||(b=n(7147));w||(w=n(1017));e=w.normalize(e);return b.readFileSync(e,t?null:"utf8")},y=function(e){e=_(e,!0);e.buffer||(e=new Uint8Array(e));assert(e.buffer);return e},E=function(e,t,i){var s=H(e);s&&t(s);b||(b=n(7147));w||(w=n(1017));e=w.normalize(e);b.readFile(e,(function(e,n){e?i(e):t(n.buffer)}))},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),i.inspect=function(){return"[Emscripten Module object]"};else if(l||h)h?g=self.location.href:"undefined"!==typeof document&&document.currentScript&&(g=document.currentScript.src),e&&(g=e),0!==g.indexOf("blob:")?g=g.substr(0,g.lastIndexOf("/")+1):g="",_=function(e){try{var t=new XMLHttpRequest;t.open("GET",e,!1);t.send(null);return t.responseText}catch(s){if(e=H(e)){t=[];for(var n=0;n<e.length;n++){var i=e[n];255<i&&(Y&&assert(!1,"Character code "+i+" ("+String.fromCharCode(i)+")  at offset "+n+" not in 0x00-0xFF."),i&=255);t.push(String.fromCharCode(i))}return t.join("")}throw s}},h&&(y=function(e){try{var t=new XMLHttpRequest;t.open("GET",e,!1);t.responseType="arraybuffer";t.send(null);return new Uint8Array(t.response)}catch(t){if(e=H(e))return e;throw t}}),E=function(e,t,n){var i=new XMLHttpRequest;i.open("GET",e,!0);i.responseType="arraybuffer";i.onload=function(){if(200==i.status||0==i.status&&i.response)t(i.response);else{var s=H(e);s?t(s.buffer):n()}};i.onerror=n;i.send(null)};i.print||console.log.bind(console);var I=i.printErr||console.warn.bind(console);for(u in f)f.hasOwnProperty(u)&&(i[u]=f[u]);f=null;var C;i.wasmBinary&&(C=i.wasmBinary);var v=i.noExitRuntime||!0;"object"!==typeof WebAssembly&&K("no native wasm support detected");var k,R=!1;function assert(e,t){e||K("Assertion failed: "+t)}function N(e){var t=i["_"+e];assert(t,"Cannot call unknown function "+e+", make sure it is exported");return t}function ca(e,t,n,i){var s={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var n=(e.length<<2)+1;t=te(n);var i=t,s=P;if(0<n){n=i+n-1;for(var o=0;o<e.length;++o){var f=e.charCodeAt(o);if(55296<=f&&57343>=f){var u=e.charCodeAt(++o);f=65536+((f&1023)<<10)|u&1023}if(127>=f){if(i>=n)break;s[i++]=f}else{if(2047>=f){if(i+1>=n)break;s[i++]=192|f>>6}else{if(65535>=f){if(i+2>=n)break;s[i++]=224|f>>12}else{if(i+3>=n)break;s[i++]=240|f>>18;s[i++]=128|f>>12&63}s[i++]=128|f>>6&63}s[i++]=128|f&63}}s[i]=0}}return t},array:function(e){var t=te(e.length);O.set(e,t);return t}},o=N(e),f=[];e=0;if(i)for(var u=0;u<i.length;u++){var l=s[n[u]];l?(0===e&&(e=J()),f[u]=l(i[u])):f[u]=i[u]}n=o.apply(null,f);n=function(e){if("string"===t)if(e){for(var n=P,i=e+NaN,s=e;n[s]&&!(s>=i);)++s;if(16<s-e&&n.subarray&&B)e=B.decode(n.subarray(e,s));else{for(i="";e<s;){var o=n[e++];if(o&128){var f=n[e++]&63;if(192==(o&224))i+=String.fromCharCode((o&31)<<6|f);else{var u=n[e++]&63;o=224==(o&240)?(o&15)<<12|f<<6|u:(o&7)<<18|f<<12|u<<6|n[e++]&63;65536>o?i+=String.fromCharCode(o):(o-=65536,i+=String.fromCharCode(55296|o>>10,56320|o&1023))}}else i+=String.fromCharCode(o)}e=i}}else e="";else e="boolean"===t?!!e:e;return e}(n);0!==e&&ee(e);return n}var B="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0,T,O,P;function ia(){var e=k.buffer;T=e;i.HEAP8=O=new Int8Array(e);i.HEAP16=new Int16Array(e);i.HEAP32=new Int32Array(e);i.HEAPU8=P=new Uint8Array(e);i.HEAPU16=new Uint16Array(e);i.HEAPU32=new Uint32Array(e);i.HEAPF32=new Float32Array(e);i.HEAPF64=new Float64Array(e)}var L,U=[],D=[],x=[];function ma(){var e=i.preRun.shift();U.unshift(e)}var Q=0,W=null,$=null;i.preloadedImages={};i.preloadedAudios={};function K(e){if(i.onAbort)i.onAbort(e);I(e);R=!0;e=new WebAssembly.RuntimeError("abort("+e+"). Build with -s ASSERTIONS=1 for more info.");o(e);throw e}var q="data:application/octet-stream;base64,",G;G="data:application/octet-stream;base64,AGFzbQEAAAABIAZgAX8Bf2ADf39/AGABfwBgAABgAAF/YAZ/f39/f38AAgcBAWEBYQAAAwsKAAEDAQAAAgQFAgQFAXABAQEFBwEBgAKAgAIGCQF/AUGAjMACCwclCQFiAgABYwADAWQACQFlAAgBZgAHAWcABgFoAAUBaQAKAWoBAAqGTQpPAQJ/QYAIKAIAIgEgAEEDakF8cSICaiEAAkAgAkEAIAAgAU0bDQAgAD8AQRB0SwRAIAAQAEUNAQtBgAggADYCACABDwtBhAhBMDYCAEF/C4wFAg5+Cn8gACgCJCEUIAAoAiAhFSAAKAIcIREgACgCGCESIAAoAhQhEyACQRBPBEAgAC0ATEVBGHQhFyAAKAIEIhZBBWytIQ8gACgCCCIYQQVsrSENIAAoAgwiGUEFbK0hCyAAKAIQIhpBBWytIQkgADUCACEIIBqtIRAgGa0hDiAYrSEMIBatIQoDQCASIAEtAAMiEiABLQAEQQh0ciABLQAFQRB0ciABLQAGIhZBGHRyQQJ2Qf///x9xaq0iAyAOfiABLwAAIAEtAAJBEHRyIBNqIBJBGHRBgICAGHFqrSIEIBB+fCARIAEtAAdBCHQgFnIgAS0ACEEQdHIgAS0ACSIRQRh0ckEEdkH///8fcWqtIgUgDH58IAEtAApBCHQgEXIgAS0AC0EQdHIgAS0ADEEYdHJBBnYgFWqtIgYgCn58IBQgF2ogAS8ADSABLQAPQRB0cmqtIgcgCH58IAMgDH4gBCAOfnwgBSAKfnwgBiAIfnwgByAJfnwgAyAKfiAEIAx+fCAFIAh+fCAGIAl+fCAHIAt+fCADIAh+IAQgCn58IAUgCX58IAYgC358IAcgDX58IAMgCX4gBCAIfnwgBSALfnwgBiANfnwgByAPfnwiA0IaiEL/////D4N8IgRCGohC/////w+DfCIFQhqIQv////8Pg3wiBkIaiEL/////D4N8IgdCGoinQQVsIAOnQf///x9xaiITQRp2IASnQf///x9xaiESIAWnQf///x9xIREgBqdB////H3EhFSAHp0H///8fcSEUIBNB////H3EhEyABQRBqIQEgAkEQayICQQ9LDQALCyAAIBQ2AiQgACAVNgIgIAAgETYCHCAAIBI2AhggACATNgIUCwMAAQu2BAEGfwJAIAAoAjgiBARAIABBPGohBQJAIAJBECAEayIDIAIgA0kbIgZFDQAgBkEDcSEHAkAgBkEBa0EDSQRAQQAhAwwBCyAGQXxxIQhBACEDA0AgBSADIARqaiABIANqLQAAOgAAIAUgA0EBciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0ECciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0EDciIEIAAoAjhqaiABIARqLQAAOgAAIANBBGohAyAAKAI4IQQgCEEEayIIDQALCyAHRQ0AA0AgBSADIARqaiABIANqLQAAOgAAIANBAWohAyAAKAI4IQQgB0EBayIHDQALCyAAIAQgBmoiAzYCOCADQRBJDQEgACAFQRAQAiAAQQA2AjggAiAGayECIAEgBmohAQsgAkEQTwRAIAAgASACQXBxIgMQAiACQQ9xIQIgASADaiEBCyACRQ0AIAJBA3EhBCAAQTxqIQVBACEDIAJBAWtBA08EQCACQXxxIQcDQCAFIAAoAjggA2pqIAEgA2otAAA6AAAgBSADQQFyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQJyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQNyIgYgACgCOGpqIAEgBmotAAA6AAAgA0EEaiEDIAdBBGsiBw0ACwsgBARAA0AgBSAAKAI4IANqaiABIANqLQAAOgAAIANBAWohAyAEQQFrIgQNAAsLIAAgACgCOCACajYCOAsLoS0BDH8jAEEQayIMJAACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgAEH0AU0EQEGICCgCACIFQRAgAEELakF4cSAAQQtJGyIIQQN2IgJ2IgFBA3EEQCABQX9zQQFxIAJqIgNBA3QiAUG4CGooAgAiBEEIaiEAAkAgBCgCCCICIAFBsAhqIgFGBEBBiAggBUF+IAN3cTYCAAwBCyACIAE2AgwgASACNgIICyAEIANBA3QiAUEDcjYCBCABIARqIgEgASgCBEEBcjYCBAwNCyAIQZAIKAIAIgpNDQEgAQRAAkBBAiACdCIAQQAgAGtyIAEgAnRxIgBBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2aiIDQQN0IgBBuAhqKAIAIgQoAggiASAAQbAIaiIARgRAQYgIIAVBfiADd3EiBTYCAAwBCyABIAA2AgwgACABNgIICyAEQQhqIQAgBCAIQQNyNgIEIAQgCGoiAiADQQN0IgEgCGsiA0EBcjYCBCABIARqIAM2AgAgCgRAIApBA3YiAUEDdEGwCGohB0GcCCgCACEEAn8gBUEBIAF0IgFxRQRAQYgIIAEgBXI2AgAgBwwBCyAHKAIICyEBIAcgBDYCCCABIAQ2AgwgBCAHNgIMIAQgATYCCAtBnAggAjYCAEGQCCADNgIADA0LQYwIKAIAIgZFDQEgBkEAIAZrcUEBayIAIABBDHZBEHEiAnYiAUEFdkEIcSIAIAJyIAEgAHYiAUECdkEEcSIAciABIAB2IgFBAXZBAnEiAHIgASAAdiIBQQF2QQFxIgByIAEgAHZqQQJ0QbgKaigCACIBKAIEQXhxIAhrIQMgASECA0ACQCACKAIQIgBFBEAgAigCFCIARQ0BCyAAKAIEQXhxIAhrIgIgAyACIANJIgIbIQMgACABIAIbIQEgACECDAELCyABIAhqIgkgAU0NAiABKAIYIQsgASABKAIMIgRHBEAgASgCCCIAQZgIKAIASRogACAENgIMIAQgADYCCAwMCyABQRRqIgIoAgAiAEUEQCABKAIQIgBFDQQgAUEQaiECCwNAIAIhByAAIgRBFGoiAigCACIADQAgBEEQaiECIAQoAhAiAA0ACyAHQQA2AgAMCwtBfyEIIABBv39LDQAgAEELaiIAQXhxIQhBjAgoAgAiCUUNAEEAIAhrIQMCQAJAAkACf0EAIAhBgAJJDQAaQR8gCEH///8HSw0AGiAAQQh2IgAgAEGA/j9qQRB2QQhxIgJ0IgAgAEGA4B9qQRB2QQRxIgF0IgAgAEGAgA9qQRB2QQJxIgB0QQ92IAEgAnIgAHJrIgBBAXQgCCAAQRVqdkEBcXJBHGoLIgVBAnRBuApqKAIAIgJFBEBBACEADAELQQAhACAIQQBBGSAFQQF2ayAFQR9GG3QhAQNAAkAgAigCBEF4cSAIayIHIANPDQAgAiEEIAciAw0AQQAhAyACIQAMAwsgACACKAIUIgcgByACIAFBHXZBBHFqKAIQIgJGGyAAIAcbIQAgAUEBdCEBIAINAAsLIAAgBHJFBEBBACEEQQIgBXQiAEEAIABrciAJcSIARQ0DIABBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2akECdEG4CmooAgAhAAsgAEUNAQsDQCAAKAIEQXhxIAhrIgEgA0khAiABIAMgAhshAyAAIAQgAhshBCAAKAIQIgEEfyABBSAAKAIUCyIADQALCyAERQ0AIANBkAgoAgAgCGtPDQAgBCAIaiIGIARNDQEgBCgCGCEFIAQgBCgCDCIBRwRAIAQoAggiAEGYCCgCAEkaIAAgATYCDCABIAA2AggMCgsgBEEUaiICKAIAIgBFBEAgBCgCECIARQ0EIARBEGohAgsDQCACIQcgACIBQRRqIgIoAgAiAA0AIAFBEGohAiABKAIQIgANAAsgB0EANgIADAkLIAhBkAgoAgAiAk0EQEGcCCgCACEDAkAgAiAIayIBQRBPBEBBkAggATYCAEGcCCADIAhqIgA2AgAgACABQQFyNgIEIAIgA2ogATYCACADIAhBA3I2AgQMAQtBnAhBADYCAEGQCEEANgIAIAMgAkEDcjYCBCACIANqIgAgACgCBEEBcjYCBAsgA0EIaiEADAsLIAhBlAgoAgAiBkkEQEGUCCAGIAhrIgE2AgBBoAhBoAgoAgAiAiAIaiIANgIAIAAgAUEBcjYCBCACIAhBA3I2AgQgAkEIaiEADAsLQQAhACAIQS9qIgkCf0HgCygCAARAQegLKAIADAELQewLQn83AgBB5AtCgKCAgICABDcCAEHgCyAMQQxqQXBxQdiq1aoFczYCAEH0C0EANgIAQcQLQQA2AgBBgCALIgFqIgVBACABayIHcSICIAhNDQpBwAsoAgAiBARAQbgLKAIAIgMgAmoiASADTQ0LIAEgBEsNCwtBxAstAABBBHENBQJAAkBBoAgoAgAiAwRAQcgLIQADQCADIAAoAgAiAU8EQCABIAAoAgRqIANLDQMLIAAoAggiAA0ACwtBABABIgFBf0YNBiACIQVB5AsoAgAiA0EBayIAIAFxBEAgAiABayAAIAFqQQAgA2txaiEFCyAFIAhNDQYgBUH+////B0sNBkHACygCACIEBEBBuAsoAgAiAyAFaiIAIANNDQcgACAESw0HCyAFEAEiACABRw0BDAgLIAUgBmsgB3EiBUH+////B0sNBSAFEAEiASAAKAIAIAAoAgRqRg0EIAEhAAsCQCAAQX9GDQAgCEEwaiAFTQ0AQegLKAIAIgEgCSAFa2pBACABa3EiAUH+////B0sEQCAAIQEMCAsgARABQX9HBEAgASAFaiEFIAAhAQwIC0EAIAVrEAEaDAULIAAiAUF/Rw0GDAQLAAtBACEEDAcLQQAhAQwFCyABQX9HDQILQcQLQcQLKAIAQQRyNgIACyACQf7///8HSw0BIAIQASEBQQAQASEAIAFBf0YNASAAQX9GDQEgACABTQ0BIAAgAWsiBSAIQShqTQ0BC0G4C0G4CygCACAFaiIANgIAQbwLKAIAIABJBEBBvAsgADYCAAsCQAJAAkBBoAgoAgAiBwRAQcgLIQADQCABIAAoAgAiAyAAKAIEIgJqRg0CIAAoAggiAA0ACwwCC0GYCCgCACIAQQAgACABTRtFBEBBmAggATYCAAtBACEAQcwLIAU2AgBByAsgATYCAEGoCEF/NgIAQawIQeALKAIANgIAQdQLQQA2AgADQCAAQQN0IgNBuAhqIANBsAhqIgI2AgAgA0G8CGogAjYCACAAQQFqIgBBIEcNAAtBlAggBUEoayIDQXggAWtBB3FBACABQQhqQQdxGyIAayICNgIAQaAIIAAgAWoiADYCACAAIAJBAXI2AgQgASADakEoNgIEQaQIQfALKAIANgIADAILIAAtAAxBCHENACADIAdLDQAgASAHTQ0AIAAgAiAFajYCBEGgCCAHQXggB2tBB3FBACAHQQhqQQdxGyIAaiICNgIAQZQIQZQIKAIAIAVqIgEgAGsiADYCACACIABBAXI2AgQgASAHakEoNgIEQaQIQfALKAIANgIADAELQZgIKAIAIAFLBEBBmAggATYCAAsgASAFaiECQcgLIQACQAJAAkACQAJAAkADQCACIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQcgLIQADQCAHIAAoAgAiAk8EQCACIAAoAgRqIgQgB0sNAwsgACgCCCEADAALAAsgACABNgIAIAAgACgCBCAFajYCBCABQXggAWtBB3FBACABQQhqQQdxG2oiCSAIQQNyNgIEIAJBeCACa0EHcUEAIAJBCGpBB3EbaiIFIAggCWoiBmshAiAFIAdGBEBBoAggBjYCAEGUCEGUCCgCACACaiIANgIAIAYgAEEBcjYCBAwDCyAFQZwIKAIARgRAQZwIIAY2AgBBkAhBkAgoAgAgAmoiADYCACAGIABBAXI2AgQgACAGaiAANgIADAMLIAUoAgQiAEEDcUEBRgRAIABBeHEhBwJAIABB/wFNBEAgBSgCCCIDIABBA3YiAEEDdEGwCGpGGiADIAUoAgwiAUYEQEGICEGICCgCAEF+IAB3cTYCAAwCCyADIAE2AgwgASADNgIIDAELIAUoAhghCAJAIAUgBSgCDCIBRwRAIAUoAggiACABNgIMIAEgADYCCAwBCwJAIAVBFGoiACgCACIDDQAgBUEQaiIAKAIAIgMNAEEAIQEMAQsDQCAAIQQgAyIBQRRqIgAoAgAiAw0AIAFBEGohACABKAIQIgMNAAsgBEEANgIACyAIRQ0AAkAgBSAFKAIcIgNBAnRBuApqIgAoAgBGBEAgACABNgIAIAENAUGMCEGMCCgCAEF+IAN3cTYCAAwCCyAIQRBBFCAIKAIQIAVGG2ogATYCACABRQ0BCyABIAg2AhggBSgCECIABEAgASAANgIQIAAgATYCGAsgBSgCFCIARQ0AIAEgADYCFCAAIAE2AhgLIAUgB2ohBSACIAdqIQILIAUgBSgCBEF+cTYCBCAGIAJBAXI2AgQgAiAGaiACNgIAIAJB/wFNBEAgAkEDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwDC0EfIQAgAkH///8HTQRAIAJBCHYiACAAQYD+P2pBEHZBCHEiA3QiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASADciAAcmsiAEEBdCACIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQQCQEGMCCgCACIDQQEgAHQiAXFFBEBBjAggASADcjYCACAEIAY2AgAgBiAENgIYDAELIAJBAEEZIABBAXZrIABBH0YbdCEAIAQoAgAhAQNAIAEiAygCBEF4cSACRg0DIABBHXYhASAAQQF0IQAgAyABQQRxaiIEKAIQIgENAAsgBCAGNgIQIAYgAzYCGAsgBiAGNgIMIAYgBjYCCAwCC0GUCCAFQShrIgNBeCABa0EHcUEAIAFBCGpBB3EbIgBrIgI2AgBBoAggACABaiIANgIAIAAgAkEBcjYCBCABIANqQSg2AgRBpAhB8AsoAgA2AgAgByAEQScgBGtBB3FBACAEQSdrQQdxG2pBL2siACAAIAdBEGpJGyICQRs2AgQgAkHQCykCADcCECACQcgLKQIANwIIQdALIAJBCGo2AgBBzAsgBTYCAEHICyABNgIAQdQLQQA2AgAgAkEYaiEAA0AgAEEHNgIEIABBCGohASAAQQRqIQAgASAESQ0ACyACIAdGDQMgAiACKAIEQX5xNgIEIAcgAiAHayIEQQFyNgIEIAIgBDYCACAEQf8BTQRAIARBA3YiAEEDdEGwCGohAgJ/QYgIKAIAIgFBASAAdCIAcUUEQEGICCAAIAFyNgIAIAIMAQsgAigCCAshACACIAc2AgggACAHNgIMIAcgAjYCDCAHIAA2AggMBAtBHyEAIAdCADcCECAEQf///wdNBEAgBEEIdiIAIABBgP4/akEQdkEIcSICdCIAIABBgOAfakEQdkEEcSIBdCIAIABBgIAPakEQdkECcSIAdEEPdiABIAJyIAByayIAQQF0IAQgAEEVanZBAXFyQRxqIQALIAcgADYCHCAAQQJ0QbgKaiEDAkBBjAgoAgAiAkEBIAB0IgFxRQRAQYwIIAEgAnI2AgAgAyAHNgIAIAcgAzYCGAwBCyAEQQBBGSAAQQF2ayAAQR9GG3QhACADKAIAIQEDQCABIgIoAgRBeHEgBEYNBCAAQR12IQEgAEEBdCEAIAIgAUEEcWoiAygCECIBDQALIAMgBzYCECAHIAI2AhgLIAcgBzYCDCAHIAc2AggMAwsgAygCCCIAIAY2AgwgAyAGNgIIIAZBADYCGCAGIAM2AgwgBiAANgIICyAJQQhqIQAMBQsgAigCCCIAIAc2AgwgAiAHNgIIIAdBADYCGCAHIAI2AgwgByAANgIIC0GUCCgCACIAIAhNDQBBlAggACAIayIBNgIAQaAIQaAIKAIAIgIgCGoiADYCACAAIAFBAXI2AgQgAiAIQQNyNgIEIAJBCGohAAwDC0GECEEwNgIAQQAhAAwCCwJAIAVFDQACQCAEKAIcIgJBAnRBuApqIgAoAgAgBEYEQCAAIAE2AgAgAQ0BQYwIIAlBfiACd3EiCTYCAAwCCyAFQRBBFCAFKAIQIARGG2ogATYCACABRQ0BCyABIAU2AhggBCgCECIABEAgASAANgIQIAAgATYCGAsgBCgCFCIARQ0AIAEgADYCFCAAIAE2AhgLAkAgA0EPTQRAIAQgAyAIaiIAQQNyNgIEIAAgBGoiACAAKAIEQQFyNgIEDAELIAQgCEEDcjYCBCAGIANBAXI2AgQgAyAGaiADNgIAIANB/wFNBEAgA0EDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwBC0EfIQAgA0H///8HTQRAIANBCHYiACAAQYD+P2pBEHZBCHEiAnQiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASACciAAcmsiAEEBdCADIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQICQAJAIAlBASAAdCIBcUUEQEGMCCABIAlyNgIAIAIgBjYCACAGIAI2AhgMAQsgA0EAQRkgAEEBdmsgAEEfRht0IQAgAigCACEIA0AgCCIBKAIEQXhxIANGDQIgAEEddiECIABBAXQhACABIAJBBHFqIgIoAhAiCA0ACyACIAY2AhAgBiABNgIYCyAGIAY2AgwgBiAGNgIIDAELIAEoAggiACAGNgIMIAEgBjYCCCAGQQA2AhggBiABNgIMIAYgADYCCAsgBEEIaiEADAELAkAgC0UNAAJAIAEoAhwiAkECdEG4CmoiACgCACABRgRAIAAgBDYCACAEDQFBjAggBkF+IAJ3cTYCAAwCCyALQRBBFCALKAIQIAFGG2ogBDYCACAERQ0BCyAEIAs2AhggASgCECIABEAgBCAANgIQIAAgBDYCGAsgASgCFCIARQ0AIAQgADYCFCAAIAQ2AhgLAkAgA0EPTQRAIAEgAyAIaiIAQQNyNgIEIAAgAWoiACAAKAIEQQFyNgIEDAELIAEgCEEDcjYCBCAJIANBAXI2AgQgAyAJaiADNgIAIAoEQCAKQQN2IgBBA3RBsAhqIQRBnAgoAgAhAgJ/QQEgAHQiACAFcUUEQEGICCAAIAVyNgIAIAQMAQsgBCgCCAshACAEIAI2AgggACACNgIMIAIgBDYCDCACIAA2AggLQZwIIAk2AgBBkAggAzYCAAsgAUEIaiEACyAMQRBqJAAgAAsQACMAIABrQXBxIgAkACAACwYAIAAkAAsEACMAC4AJAgh/BH4jAEGQAWsiBiQAIAYgBS0AA0EYdEGAgIAYcSAFLwAAIAUtAAJBEHRycjYCACAGIAUoAANBAnZBg/7/H3E2AgQgBiAFKAAGQQR2Qf+B/x9xNgIIIAYgBSgACUEGdkH//8AfcTYCDCAFLwANIQggBS0ADyEJIAZCADcCFCAGQgA3AhwgBkEANgIkIAYgCCAJQRB0QYCAPHFyNgIQIAYgBSgAEDYCKCAGIAUoABQ2AiwgBiAFKAAYNgIwIAUoABwhBSAGQQA6AEwgBkEANgI4IAYgBTYCNCAGIAEgAhAEIAQEQCAGIAMgBBAECyAGKAI4IgEEQCAGQTxqIgIgAWpBAToAACABQQFqQQ9NBEAgASAGakE9aiEEAkBBDyABayIDRQ0AIAMgBGoiAUEBa0EAOgAAIARBADoAACADQQNJDQAgAUECa0EAOgAAIARBADoAASABQQNrQQA6AAAgBEEAOgACIANBB0kNACABQQRrQQA6AAAgBEEAOgADIANBCUkNACAEQQAgBGtBA3EiAWoiBEEANgIAIAQgAyABa0F8cSIBaiIDQQRrQQA2AgAgAUEJSQ0AIARBADYCCCAEQQA2AgQgA0EIa0EANgIAIANBDGtBADYCACABQRlJDQAgBEEANgIYIARBADYCFCAEQQA2AhAgBEEANgIMIANBEGtBADYCACADQRRrQQA2AgAgA0EYa0EANgIAIANBHGtBADYCACABIARBBHFBGHIiAWsiA0EgSQ0AIAEgBGohAQNAIAFCADcDGCABQgA3AxAgAUIANwMIIAFCADcDACABQSBqIQEgA0EgayIDQR9LDQALCwsgBkEBOgBMIAYgAkEQEAILIAY1AjQhECAGNQIwIREgBjUCLCEOIAAgBjUCKCAGKAIkIAYoAiAgBigCHCAGKAIYIgNBGnZqIgJBGnZqIgFBGnZqIgtBgICAYHIgAUH///8fcSINIAJB////H3EiCCAGKAIUIAtBGnZBBWxqIgFB////H3EiCUEFaiIFQRp2IANB////H3EgAUEadmoiA2oiAUEadmoiAkEadmoiBEEadmoiDEEfdSIHIANxIAEgDEEfdkEBayIDQf///x9xIgpxciIBQRp0IAUgCnEgByAJcXJyrXwiDzwAACAAIA9CGIg8AAMgACAPQhCIPAACIAAgD0IIiDwAASAAIA4gByAIcSACIApxciICQRR0IAFBBnZyrXwgD0IgiHwiDjwABCAAIA5CGIg8AAcgACAOQhCIPAAGIAAgDkIIiDwABSAAIBEgByANcSAEIApxciIBQQ50IAJBDHZyrXwgDkIgiHwiDjwACCAAIA5CGIg8AAsgACAOQhCIPAAKIAAgDkIIiDwACSAAIBAgAyAMcSAHIAtxckEIdCABQRJ2cq18IA5CIIh8Ig48AAwgACAOQhiIPAAPIAAgDkIQiDwADiAAIA5CCIg8AA0gBkIANwIwIAZCADcCKCAGQgA3AiAgBkIANwIYIAZCADcCECAGQgA3AgggBkIANwIAIAZBkAFqJAALpwwBB38CQCAARQ0AIABBCGsiAyAAQQRrKAIAIgFBeHEiAGohBQJAIAFBAXENACABQQNxRQ0BIAMgAygCACIBayIDQZgIKAIASQ0BIAAgAWohACADQZwIKAIARwRAIAFB/wFNBEAgAygCCCICIAFBA3YiBEEDdEGwCGpGGiACIAMoAgwiAUYEQEGICEGICCgCAEF+IAR3cTYCAAwDCyACIAE2AgwgASACNgIIDAILIAMoAhghBgJAIAMgAygCDCIBRwRAIAMoAggiAiABNgIMIAEgAjYCCAwBCwJAIANBFGoiAigCACIEDQAgA0EQaiICKAIAIgQNAEEAIQEMAQsDQCACIQcgBCIBQRRqIgIoAgAiBA0AIAFBEGohAiABKAIQIgQNAAsgB0EANgIACyAGRQ0BAkAgAyADKAIcIgJBAnRBuApqIgQoAgBGBEAgBCABNgIAIAENAUGMCEGMCCgCAEF+IAJ3cTYCAAwDCyAGQRBBFCAGKAIQIANGG2ogATYCACABRQ0CCyABIAY2AhggAygCECICBEAgASACNgIQIAIgATYCGAsgAygCFCICRQ0BIAEgAjYCFCACIAE2AhgMAQsgBSgCBCIBQQNxQQNHDQBBkAggADYCACAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAA8LIAMgBU8NACAFKAIEIgFBAXFFDQACQCABQQJxRQRAIAVBoAgoAgBGBEBBoAggAzYCAEGUCEGUCCgCACAAaiIANgIAIAMgAEEBcjYCBCADQZwIKAIARw0DQZAIQQA2AgBBnAhBADYCAA8LIAVBnAgoAgBGBEBBnAggAzYCAEGQCEGQCCgCACAAaiIANgIAIAMgAEEBcjYCBCAAIANqIAA2AgAPCyABQXhxIABqIQACQCABQf8BTQRAIAUoAggiAiABQQN2IgRBA3RBsAhqRhogAiAFKAIMIgFGBEBBiAhBiAgoAgBBfiAEd3E2AgAMAgsgAiABNgIMIAEgAjYCCAwBCyAFKAIYIQYCQCAFIAUoAgwiAUcEQCAFKAIIIgJBmAgoAgBJGiACIAE2AgwgASACNgIIDAELAkAgBUEUaiICKAIAIgQNACAFQRBqIgIoAgAiBA0AQQAhAQwBCwNAIAIhByAEIgFBFGoiAigCACIEDQAgAUEQaiECIAEoAhAiBA0ACyAHQQA2AgALIAZFDQACQCAFIAUoAhwiAkECdEG4CmoiBCgCAEYEQCAEIAE2AgAgAQ0BQYwIQYwIKAIAQX4gAndxNgIADAILIAZBEEEUIAYoAhAgBUYbaiABNgIAIAFFDQELIAEgBjYCGCAFKAIQIgIEQCABIAI2AhAgAiABNgIYCyAFKAIUIgJFDQAgASACNgIUIAIgATYCGAsgAyAAQQFyNgIEIAAgA2ogADYCACADQZwIKAIARw0BQZAIIAA2AgAPCyAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAAsgAEH/AU0EQCAAQQN2IgFBA3RBsAhqIQACf0GICCgCACICQQEgAXQiAXFFBEBBiAggASACcjYCACAADAELIAAoAggLIQIgACADNgIIIAIgAzYCDCADIAA2AgwgAyACNgIIDwtBHyECIANCADcCECAAQf///wdNBEAgAEEIdiIBIAFBgP4/akEQdkEIcSIBdCICIAJBgOAfakEQdkEEcSICdCIEIARBgIAPakEQdkECcSIEdEEPdiABIAJyIARyayIBQQF0IAAgAUEVanZBAXFyQRxqIQILIAMgAjYCHCACQQJ0QbgKaiEBAkACQAJAQYwIKAIAIgRBASACdCIHcUUEQEGMCCAEIAdyNgIAIAEgAzYCACADIAE2AhgMAQsgAEEAQRkgAkEBdmsgAkEfRht0IQIgASgCACEBA0AgASIEKAIEQXhxIABGDQIgAkEddiEBIAJBAXQhAiAEIAFBBHFqIgdBEGooAgAiAQ0ACyAHIAM2AhAgAyAENgIYCyADIAM2AgwgAyADNgIIDAELIAQoAggiACADNgIMIAQgAzYCCCADQQA2AhggAyAENgIMIAMgADYCCAtBqAhBqAgoAgBBAWsiAEF/IAAbNgIACwsLCQEAQYEICwIGUA==";if(!G.startsWith(q)){var j=G;G=i.locateFile?i.locateFile(j,g):g+j}function pa(){var e=G;try{if(e==G&&C)return new Uint8Array(C);var t=H(e);if(t)return t;if(y)return y(e);throw"both async and sync fetching of the wasm failed"}catch(e){K(e)}}function qa(){if(!C&&(l||h)){if("function"===typeof fetch&&!G.startsWith("file://"))return fetch(G,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+G+"'";return e.arrayBuffer()})).catch((function(){return pa()}));if(E)return new Promise((function(e,t){E(G,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return pa()}))}function X(e){for(;0<e.length;){var t=e.shift();if("function"==typeof t)t(i);else{var n=t.m;"number"===typeof n?void 0===t.l?L.get(n)():L.get(n)(t.l):n(void 0===t.l?null:t.l)}}}var Y=!1,V="function"===typeof atob?atob:function(e){var t="",n=0;e=e.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++));var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++));var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++));var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++));i=i<<2|s>>4;s=(s&15)<<4|o>>2;var u=(o&3)<<6|f;t+=String.fromCharCode(i);64!==o&&(t+=String.fromCharCode(s));64!==f&&(t+=String.fromCharCode(u))}while(n<e.length);return t};function H(e){if(e.startsWith(q)){e=e.slice(q.length);if("boolean"===typeof p&&p){var t=Buffer.from(e,"base64");t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}else try{var n=V(e),i=new Uint8Array(n.length);for(e=0;e<n.length;++e)i[e]=n.charCodeAt(e);t=i}catch(e){throw Error("Converting base64 string to bytes failed.")}return t}}var z={a:function(e){var t=P.length;e>>>=0;if(2147483648<e)return!1;for(var n=1;4>=n;n*=2){var i=t*(1+.2/n);i=Math.min(i,e+100663296);i=Math.max(e,i);0<i%65536&&(i+=65536-i%65536);e:{try{k.grow(Math.min(2147483648,i)-T.byteLength+65535>>>16);ia();var s=1;break e}catch(e){}s=void 0}if(s)return!0}return!1}};(function(){function a(e){i.asm=e.exports;k=i.asm.b;ia();L=i.asm.j;D.unshift(i.asm.c);Q--;i.monitorRunDependencies&&i.monitorRunDependencies(Q);0==Q&&(null!==W&&(clearInterval(W),W=null),$&&(e=$,$=null,e()))}function c(e){a(e.instance)}function d(t){return qa().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){I("failed to asynchronously prepare wasm: "+e);K(e)}))}var e={a:z};Q++;i.monitorRunDependencies&&i.monitorRunDependencies(Q);if(i.instantiateWasm)try{return i.instantiateWasm(e,a)}catch(e){return I("Module.instantiateWasm callback failed with error: "+e),!1}(function(){return C||"function"!==typeof WebAssembly.instantiateStreaming||G.startsWith(q)||G.startsWith("file://")||"function"!==typeof fetch?d(c):fetch(G,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(c,(function(e){I("wasm streaming compile failed: "+e);I("falling back to ArrayBuffer instantiation");return d(c)}))}))})().catch(o);return{}})();i.___wasm_call_ctors=function(){return(i.___wasm_call_ctors=i.asm.c).apply(null,arguments)};i._poly1305_auth=function(){return(i._poly1305_auth=i.asm.d).apply(null,arguments)};var J=i.stackSave=function(){return(J=i.stackSave=i.asm.e).apply(null,arguments)},ee=i.stackRestore=function(){return(ee=i.stackRestore=i.asm.f).apply(null,arguments)},te=i.stackAlloc=function(){return(te=i.stackAlloc=i.asm.g).apply(null,arguments)};i._malloc=function(){return(i._malloc=i.asm.h).apply(null,arguments)};i._free=function(){return(i._free=i.asm.i).apply(null,arguments)};i.cwrap=function(e,t,n,i){n=n||[];var s=n.every((function(e){return"number"===e}));return"string"!==t&&s&&!i?N(e):function(){return ca(e,t,n,arguments)}};var re;$=function ta(){re||Z();re||($=ta)};function Z(){function a(){if(!re&&(re=!0,i.calledRun=!0,!R)){X(D);s(i);if(i.onRuntimeInitialized)i.onRuntimeInitialized();if(i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;){var e=i.postRun.shift();x.unshift(e)}X(x)}}if(!(0<Q)){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)ma();X(U);0<Q||(i.setStatus?(i.setStatus("Running..."),setTimeout((function(){setTimeout((function(){i.setStatus("")}),1);a()}),1)):a())}}i.run=Z;if(i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);0<i.preInit.length;)i.preInit.pop()();Z();return t.ready}}();if(true)e.exports=i;else{}},172:(e,t,n)=>{"use strict";const i=new Array(256);[n(4126).HANDLERS,n(6475)].forEach((e=>{for(let[t,n]of Object.entries(e)){t=+t;if(isFinite(t)&&t>=0&&t<i.length)i[t]=n}}));e.exports=i},6475:(e,t,n)=>{"use strict";const{bufferSlice:i,bufferParser:s,doFatalError:o,sigSSHToASN1:f,writeUInt32BE:u}=n(9475);const{CHANNEL_OPEN_FAILURE:l,COMPAT:h,MESSAGE:p,TERMINAL_MODE:g}=n(6832);const{parseKey:_}=n(2218);const E=Array.from(Object.entries(g)).reduce(((e,[t,n])=>({...e,[t]:n})),{});e.exports={[p.DISCONNECT]:(e,t)=>{s.init(t,1);const n=s.readUInt32BE();const i=s.readString(true);const f=s.readString();s.clear();if(f===undefined){return o(e,"Inbound: Malformed DISCONNECT packet")}e._debug&&e._debug(`Inbound: Received DISCONNECT (${n}, "${i}")`);const u=e._handlers.DISCONNECT;u&&u(e,n,i)},[p.IGNORE]:(e,t)=>{e._debug&&e._debug("Inbound: Received IGNORE")},[p.UNIMPLEMENTED]:(e,t)=>{s.init(t,1);const n=s.readUInt32BE();s.clear();if(n===undefined){return o(e,"Inbound: Malformed UNIMPLEMENTED packet")}e._debug&&e._debug(`Inbound: Received UNIMPLEMENTED (seqno ${n})`)},[p.DEBUG]:(e,t)=>{s.init(t,1);const n=s.readBool();const i=s.readString(true);const f=s.readString();s.clear();if(f===undefined){return o(e,"Inbound: Malformed DEBUG packet")}e._debug&&e._debug("Inbound: Received DEBUG");const u=e._handlers.DEBUG;u&&u(e,n,i)},[p.SERVICE_REQUEST]:(e,t)=>{s.init(t,1);const n=s.readString(true);s.clear();if(n===undefined){return o(e,"Inbound: Malformed SERVICE_REQUEST packet")}e._debug&&e._debug(`Inbound: Received SERVICE_REQUEST (${n})`);const i=e._handlers.SERVICE_REQUEST;i&&i(e,n)},[p.SERVICE_ACCEPT]:(e,t)=>{s.init(t,1);const n=s.readString(true);s.clear();if(n===undefined){return o(e,"Inbound: Malformed SERVICE_ACCEPT packet")}e._debug&&e._debug(`Inbound: Received SERVICE_ACCEPT (${n})`);const i=e._handlers.SERVICE_ACCEPT;i&&i(e,n)},[p.USERAUTH_REQUEST]:(e,t)=>{s.init(t,1);const n=s.readString(true);const l=s.readString(true);const h=s.readString(true);let p;let g;switch(h){case"none":p=null;break;case"password":{const e=s.readBool();if(e!==undefined){p=s.readString(true);if(p!==undefined&&e){const e=s.readString(true);if(e!==undefined)p={oldPassword:p,newPassword:e};else p=undefined}}break}case"publickey":{const n=s.readBool();if(n!==undefined){const o=s.readString(true);const l=s.readString();if(n){const n=s.pos();let h=s.readString();if(h!==undefined){if(h.length>4+o.length+4&&h.utf8Slice(4,4+o.length)===o){h=i(h,4+o.length+4)}h=f(h,o);if(h){const i=e._kex.sessionID;const s=Buffer.allocUnsafe(4+i.length+n);u(s,i.length,0);s.set(i,4);s.set(new Uint8Array(t.buffer,t.byteOffset,n),4+i.length);p={keyAlgo:o,key:l,signature:h,blob:s}}}}else{p={keyAlgo:o,key:l};g="publickey -- check"}}break}case"hostbased":{const n=s.readString(true);const o=s.readString();const l=s.readString(true);const h=s.readString(true);const g=s.pos();let _=s.readString();if(_!==undefined){if(_.length>4+n.length+4&&_.utf8Slice(4,4+n.length)===n){_=i(_,4+n.length+4)}_=f(_,n);if(_!==undefined){const i=e._kex.sessionID;const s=Buffer.allocUnsafe(4+i.length+g);u(s,i.length,0);s.set(i,4);s.set(new Uint8Array(t.buffer,t.byteOffset,g),4+i.length);p={keyAlgo:n,key:o,signature:_,blob:s,localHostname:l,localUsername:h}}}break}case"keyboard-interactive":s.skipString();p=s.readList();break;default:if(h!==undefined)p=s.readRaw()}s.clear();if(p===undefined){return o(e,"Inbound: Malformed USERAUTH_REQUEST packet")}if(g===undefined)g=h;e._authsQueue.push(h);e._debug&&e._debug(`Inbound: Received USERAUTH_REQUEST (${g})`);const _=e._handlers.USERAUTH_REQUEST;_&&_(e,n,l,h,p)},[p.USERAUTH_FAILURE]:(e,t)=>{s.init(t,1);const n=s.readList();const i=s.readBool();s.clear();if(i===undefined){return o(e,"Inbound: Malformed USERAUTH_FAILURE packet")}e._debug&&e._debug(`Inbound: Received USERAUTH_FAILURE (${n})`);e._authsQueue.shift();const f=e._handlers.USERAUTH_FAILURE;f&&f(e,n,i)},[p.USERAUTH_SUCCESS]:(e,t)=>{e._debug&&e._debug("Inbound: Received USERAUTH_SUCCESS");e._authsQueue.shift();const n=e._handlers.USERAUTH_SUCCESS;n&&n(e)},[p.USERAUTH_BANNER]:(e,t)=>{s.init(t,1);const n=s.readString(true);const i=s.readString();s.clear();if(i===undefined){return o(e,"Inbound: Malformed USERAUTH_BANNER packet")}e._debug&&e._debug("Inbound: Received USERAUTH_BANNER");const f=e._handlers.USERAUTH_BANNER;f&&f(e,n)},60:(e,t)=>{if(!e._authsQueue.length){e._debug&&e._debug("Inbound: Received payload type 60 without auth");return}switch(e._authsQueue[0]){case"password":{s.init(t,1);const n=s.readString(true);const i=s.readString();s.clear();if(i===undefined){return o(e,"Inbound: Malformed USERAUTH_PASSWD_CHANGEREQ packet")}e._debug&&e._debug("Inbound: Received USERAUTH_PASSWD_CHANGEREQ");const f=e._handlers.USERAUTH_PASSWD_CHANGEREQ;f&&f(e,n);break}case"publickey":{s.init(t,1);const n=s.readString(true);const i=s.readString();s.clear();if(i===undefined){return o(e,"Inbound: Malformed USERAUTH_PK_OK packet")}e._debug&&e._debug("Inbound: Received USERAUTH_PK_OK");e._authsQueue.shift();const f=e._handlers.USERAUTH_PK_OK;f&&f(e,n,i);break}case"keyboard-interactive":{s.init(t,1);const n=s.readString(true);const i=s.readString(true);s.readString();const f=s.readUInt32BE();let u;if(f!==undefined){u=new Array(f);let e;for(e=0;e<f;++e){const t=s.readString(true);const n=s.readBool();if(n===undefined)break;u[e]={prompt:t,echo:n}}if(e!==f)u=undefined}s.clear();if(u===undefined){return o(e,"Inbound: Malformed USERAUTH_INFO_REQUEST packet")}e._debug&&e._debug("Inbound: Received USERAUTH_INFO_REQUEST");const l=e._handlers.USERAUTH_INFO_REQUEST;l&&l(e,n,i,u);break}default:e._debug&&e._debug("Inbound: Received unexpected payload type 60")}},61:(e,t)=>{if(!e._authsQueue.length){e._debug&&e._debug("Inbound: Received payload type 61 without auth");return}if(e._authsQueue[0]!=="keyboard-interactive"){return o(e,"Inbound: Received unexpected payload type 61")}s.init(t,1);const n=s.readUInt32BE();let i;if(n!==undefined){i=new Array(n);let e;for(e=0;e<n;++e){const t=s.readString(true);if(t===undefined)break;i[e]=t}if(e!==n)i=undefined}s.clear();if(i===undefined){return o(e,"Inbound: Malformed USERAUTH_INFO_RESPONSE packet")}e._debug&&e._debug("Inbound: Received USERAUTH_INFO_RESPONSE");const f=e._handlers.USERAUTH_INFO_RESPONSE;f&&f(e,i)},[p.GLOBAL_REQUEST]:(e,t)=>{s.init(t,1);const n=s.readString(true);const i=s.readBool();let f;if(i!==undefined){switch(n){case"tcpip-forward":case"cancel-tcpip-forward":{const e=s.readString(true);const t=s.readUInt32BE();if(t!==undefined)f={bindAddr:e,bindPort:t};break}case"streamlocal-forward@openssh.com":case"cancel-streamlocal-forward@openssh.com":{const e=s.readString(true);if(e!==undefined)f={socketPath:e};break}case"no-more-sessions@openssh.com":f=null;break;case"hostkeys-00@openssh.com":{f=[];while(s.avail()>0){const e=s.readString();if(e===undefined){f=undefined;break}const t=_(e);if(!(t instanceof Error))f.push(t)}break}default:f=s.readRaw()}}s.clear();if(f===undefined){return o(e,"Inbound: Malformed GLOBAL_REQUEST packet")}e._debug&&e._debug(`Inbound: GLOBAL_REQUEST (${n})`);const u=e._handlers.GLOBAL_REQUEST;if(u)u(e,n,i,f);else e.requestFailure()},[p.REQUEST_SUCCESS]:(e,t)=>{const n=t.length>1?i(t,1):null;e._debug&&e._debug("Inbound: REQUEST_SUCCESS");const s=e._handlers.REQUEST_SUCCESS;s&&s(e,n)},[p.REQUEST_FAILURE]:(e,t)=>{e._debug&&e._debug("Inbound: Received REQUEST_FAILURE");const n=e._handlers.REQUEST_FAILURE;n&&n(e)},[p.CHANNEL_OPEN]:(e,t)=>{s.init(t,1);const n=s.readString(true);const i=s.readUInt32BE();const f=s.readUInt32BE();const u=s.readUInt32BE();let h;switch(n){case"forwarded-tcpip":case"direct-tcpip":{const e=s.readString(true);const t=s.readUInt32BE();const o=s.readString(true);const l=s.readUInt32BE();if(l!==undefined){h={type:n,sender:i,window:f,packetSize:u,data:{destIP:e,destPort:t,srcIP:o,srcPort:l}}}break}case"forwarded-streamlocal@openssh.com":case"direct-streamlocal@openssh.com":{const e=s.readString(true);if(e!==undefined){h={type:n,sender:i,window:f,packetSize:u,data:{socketPath:e}}}break}case"x11":{const e=s.readString(true);const t=s.readUInt32BE();if(t!==undefined){h={type:n,sender:i,window:f,packetSize:u,data:{srcIP:e,srcPort:t}}}break}default:h={type:n,sender:i,window:f,packetSize:u,data:{}}}s.clear();if(h===undefined){return o(e,"Inbound: Malformed CHANNEL_OPEN packet")}e._debug&&e._debug(`Inbound: CHANNEL_OPEN (s:${i}, ${n})`);const p=e._handlers.CHANNEL_OPEN;if(p){p(e,h)}else{e.channelOpenFail(h.sender,l.ADMINISTRATIVELY_PROHIBITED,"","")}},[p.CHANNEL_OPEN_CONFIRMATION]:(e,t)=>{s.init(t,1);const n=s.readUInt32BE();const i=s.readUInt32BE();const f=s.readUInt32BE();const u=s.readUInt32BE();const l=s.avail()?s.readRaw():undefined;s.clear();if(u===undefined){return o(e,"Inbound: Malformed CHANNEL_OPEN_CONFIRMATION packet")}e._debug&&e._debug(`Inbound: CHANNEL_OPEN_CONFIRMATION (r:${n}, s:${i})`);const h=e._handlers.CHANNEL_OPEN_CONFIRMATION;if(h)h(e,{recipient:n,sender:i,window:f,packetSize:u,data:l})},[p.CHANNEL_OPEN_FAILURE]:(e,t)=>{s.init(t,1);const n=s.readUInt32BE();const i=s.readUInt32BE();const f=s.readString(true);const u=s.readString();s.clear();if(u===undefined){return o(e,"Inbound: Malformed CHANNEL_OPEN_FAILURE packet")}e._debug&&e._debug(`Inbound: CHANNEL_OPEN_FAILURE (r:${n})`);const l=e._handlers.CHANNEL_OPEN_FAILURE;l&&l(e,n,i,f)},[p.CHANNEL_WINDOW_ADJUST]:(e,t)=>{s.init(t,1);const n=s.readUInt32BE();const i=s.readUInt32BE();s.clear();if(i===undefined){return o(e,"Inbound: Malformed CHANNEL_WINDOW_ADJUST packet")}e._debug&&e._debug(`Inbound: CHANNEL_WINDOW_ADJUST (r:${n}, ${i})`);const f=e._handlers.CHANNEL_WINDOW_ADJUST;f&&f(e,n,i)},[p.CHANNEL_DATA]:(e,t)=>{s.init(t,1);const n=s.readUInt32BE();const i=s.readString();s.clear();if(i===undefined){return o(e,"Inbound: Malformed CHANNEL_DATA packet")}e._debug&&e._debug(`Inbound: CHANNEL_DATA (r:${n}, ${i.length})`);const f=e._handlers.CHANNEL_DATA;f&&f(e,n,i)},[p.CHANNEL_EXTENDED_DATA]:(e,t)=>{s.init(t,1);const n=s.readUInt32BE();const i=s.readUInt32BE();const f=s.readString();s.clear();if(f===undefined){return o(e,"Inbound: Malformed CHANNEL_EXTENDED_DATA packet")}e._debug&&e._debug(`Inbound: CHANNEL_EXTENDED_DATA (r:${n}, ${f.length})`);const u=e._handlers.CHANNEL_EXTENDED_DATA;u&&u(e,n,f,i)},[p.CHANNEL_EOF]:(e,t)=>{s.init(t,1);const n=s.readUInt32BE();s.clear();if(n===undefined){return o(e,"Inbound: Malformed CHANNEL_EOF packet")}e._debug&&e._debug(`Inbound: CHANNEL_EOF (r:${n})`);const i=e._handlers.CHANNEL_EOF;i&&i(e,n)},[p.CHANNEL_CLOSE]:(e,t)=>{s.init(t,1);const n=s.readUInt32BE();s.clear();if(n===undefined){return o(e,"Inbound: Malformed CHANNEL_CLOSE packet")}e._debug&&e._debug(`Inbound: CHANNEL_CLOSE (r:${n})`);const i=e._handlers.CHANNEL_CLOSE;i&&i(e,n)},[p.CHANNEL_REQUEST]:(e,t)=>{s.init(t,1);const n=s.readUInt32BE();const i=s.readString(true);const f=s.readBool();let u;if(f!==undefined){switch(i){case"exit-status":u=s.readUInt32BE();e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i}: ${u})`);break;case"exit-signal":{let t;let o;if(e._compatFlags&h.OLD_EXIT){const e=s.readUInt32BE();switch(e){case 1:t="HUP";break;case 2:t="INT";break;case 3:t="QUIT";break;case 6:t="ABRT";break;case 9:t="KILL";break;case 14:t="ALRM";break;case 15:t="TERM";break;default:if(e!==undefined){t=`UNKNOWN (${e})`}}o=false}else{t=s.readString(true);o=s.readBool();if(o===undefined)t=undefined}const f=s.readString(true);if(s.skipString()!==undefined)u={signal:t,coreDumped:o,errorMessage:f};e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i}: ${t})`);break}case"pty-req":{const t=s.readString(true);const o=s.readUInt32BE();const f=s.readUInt32BE();const l=s.readUInt32BE();const h=s.readUInt32BE();const p=s.readString();if(p!==undefined){s.init(p,1);let e={};while(s.avail()){const t=s.readByte();if(t===g.TTY_OP_END)break;const n=E[t];const i=s.readUInt32BE();if(t===undefined||n===undefined||i===undefined){e=undefined;break}e[n]=i}if(e!==undefined)u={term:t,cols:o,rows:f,width:l,height:h,modes:e}}e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i})`);break}case"window-change":{const t=s.readUInt32BE();const o=s.readUInt32BE();const f=s.readUInt32BE();const l=s.readUInt32BE();if(l!==undefined)u={cols:t,rows:o,width:f,height:l};e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i})`);break}case"x11-req":{const t=s.readBool();const o=s.readString(true);const f=s.readString();const l=s.readUInt32BE();if(l!==undefined)u={single:t,protocol:o,cookie:f,screen:l};e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i})`);break}case"env":{const t=s.readString(true);const o=s.readString(true);if(o!==undefined)u={name:t,value:o};if(e._debug){e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i}: `+`${t}=${o})`)}break}case"shell":u=null;e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i})`);break;case"exec":u=s.readString(true);e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i}: ${u})`);break;case"subsystem":u=s.readString(true);e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i}: ${u})`);break;case"signal":u=s.readString(true);e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i}: ${u})`);break;case"xon-xoff":u=s.readBool();e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i}: ${u})`);break;case"auth-agent-req@openssh.com":u=null;e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i})`);break;default:u=s.avail()?s.readRaw():null;e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i})`)}}s.clear();if(u===undefined){return o(e,"Inbound: Malformed CHANNEL_REQUEST packet")}const l=e._handlers.CHANNEL_REQUEST;l&&l(e,n,i,f,u)},[p.CHANNEL_SUCCESS]:(e,t)=>{s.init(t,1);const n=s.readUInt32BE();s.clear();if(n===undefined){return o(e,"Inbound: Malformed CHANNEL_SUCCESS packet")}e._debug&&e._debug(`Inbound: CHANNEL_SUCCESS (r:${n})`);const i=e._handlers.CHANNEL_SUCCESS;i&&i(e,n)},[p.CHANNEL_FAILURE]:(e,t)=>{s.init(t,1);const n=s.readUInt32BE();s.clear();if(n===undefined){return o(e,"Inbound: Malformed CHANNEL_FAILURE packet")}e._debug&&e._debug(`Inbound: CHANNEL_FAILURE (r:${n})`);const i=e._handlers.CHANNEL_FAILURE;i&&i(e,n)}}},4126:(e,t,n)=>{"use strict";const{createDiffieHellman:i,createDiffieHellmanGroup:s,createECDH:o,createHash:f,createPublicKey:u,diffieHellman:l,generateKeyPairSync:h,randomFillSync:p}=n(6113);const{Ber:g}=n(970);const{COMPAT:_,curve25519Supported:E,DEFAULT_KEX:y,DEFAULT_SERVER_HOST_KEY:b,DEFAULT_CIPHER:w,DEFAULT_MAC:I,DEFAULT_COMPRESSION:C,DISCONNECT_REASON:v,MESSAGE:k}=n(6832);const{CIPHER_INFO:R,createCipher:B,createDecipher:T,MAC_INFO:O}=n(5708);const{parseDERKey:P}=n(2218);const{bufferFill:L,bufferParser:U,convertSignature:D,doFatalError:x,FastBuffer:Q,sigSSHToASN1:W,writeUInt32BE:$}=n(9475);const{PacketReader:q,PacketWriter:G,ZlibPacketReader:j,ZlibPacketWriter:Y}=n(6715);let V;const z=2048;const J=8192;const ee=Buffer.alloc(0);function kexinit(e){let t;if(e._compatFlags&_.BAD_DHGEX){const n=e._offer.lists.kex;let i=n.array;let s=false;for(let e=0;e<i.length;++e){if(i[e].includes("group-exchange")){if(!s){s=true;i=i.slice()}i.splice(e--,1)}}if(s){let s=1+16+e._offer.totalSize+1+4;const o=Buffer.from(i.join(","));s-=n.buffer.length-o.length;const f=e._offer.lists.all;const u=new Uint8Array(f.buffer,f.byteOffset+4+n.buffer.length,f.length-(4+n.buffer.length));t=Buffer.allocUnsafe(s);$(t,o.length,17);t.set(o,17+4);t.set(u,17+4+o.length)}}if(t===undefined){t=Buffer.allocUnsafe(1+16+e._offer.totalSize+1+4);e._offer.copyAllTo(t,17)}e._debug&&e._debug("Outbound: Sending KEXINIT");t[0]=k.KEXINIT;p(t,1,16);L(t,0,t.length-5);e._kexinit=t;e._packetRW.write.allocStart=0;{const n=e._packetRW.write.allocStartKEX;const i=e._packetRW.write.alloc(t.length,true);i.set(t,n);e._cipher.encrypt(e._packetRW.write.finalize(i,true))}}function handleKexInit(e,t){const n={kex:undefined,serverHostKey:undefined,cs:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined},sc:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined}};U.init(t,17);if((n.kex=U.readList())===undefined||(n.serverHostKey=U.readList())===undefined||(n.cs.cipher=U.readList())===undefined||(n.sc.cipher=U.readList())===undefined||(n.cs.mac=U.readList())===undefined||(n.sc.mac=U.readList())===undefined||(n.cs.compress=U.readList())===undefined||(n.sc.compress=U.readList())===undefined||(n.cs.lang=U.readList())===undefined||(n.sc.lang=U.readList())===undefined){U.clear();return x(e,"Received malformed KEXINIT","handshake",v.KEY_EXCHANGE_FAILED)}const i=U.pos();const s=i<t.length&&t[i]===1;U.clear();const o=e._offer;const f=n;let u=o.lists.kex.array;if(e._compatFlags&_.BAD_DHGEX){let e=false;for(let t=0;t<u.length;++t){if(u[t].indexOf("group-exchange")!==-1){if(!e){e=true;u=u.slice()}u.splice(t--,1)}}}let l;let h;let p;const g=e._debug;g&&g("Inbound: Handshake in progress");g&&g(`Handshake: (local) KEX method: ${u}`);g&&g(`Handshake: (remote) KEX method: ${f.kex}`);if(e._server){h=u;l=f.kex}else{h=f.kex;l=u}for(p=0;p<l.length&&h.indexOf(l[p])===-1;++p);if(p===l.length){g&&g("Handshake: No matching key exchange algorithm");return x(e,"Handshake failed: no matching key exchange algorithm","handshake",v.KEY_EXCHANGE_FAILED)}n.kex=l[p];g&&g(`Handshake: KEX algorithm: ${l[p]}`);if(s&&(!f.kex.length||l[p]!==f.kex[0])){e._skipNextInboundPacket=true}const E=o.lists.serverHostKey.array;g&&g(`Handshake: (local) Host key format: ${E}`);g&&g(`Handshake: (remote) Host key format: ${f.serverHostKey}`);if(e._server){h=E;l=f.serverHostKey}else{h=f.serverHostKey;l=E}for(p=0;p<l.length&&h.indexOf(l[p])===-1;++p);if(p===l.length){g&&g("Handshake: No matching host key format");return x(e,"Handshake failed: no matching host key format","handshake",v.KEY_EXCHANGE_FAILED)}n.serverHostKey=l[p];g&&g(`Handshake: Host key format: ${l[p]}`);const y=o.lists.cs.cipher.array;g&&g(`Handshake: (local) C->S cipher: ${y}`);g&&g(`Handshake: (remote) C->S cipher: ${f.cs.cipher}`);if(e._server){h=y;l=f.cs.cipher}else{h=f.cs.cipher;l=y}for(p=0;p<l.length&&h.indexOf(l[p])===-1;++p);if(p===l.length){g&&g("Handshake: No matching C->S cipher");return x(e,"Handshake failed: no matching C->S cipher","handshake",v.KEY_EXCHANGE_FAILED)}n.cs.cipher=l[p];g&&g(`Handshake: C->S Cipher: ${l[p]}`);const b=o.lists.sc.cipher.array;g&&g(`Handshake: (local) S->C cipher: ${b}`);g&&g(`Handshake: (remote) S->C cipher: ${f.sc.cipher}`);if(e._server){h=b;l=f.sc.cipher}else{h=f.sc.cipher;l=b}for(p=0;p<l.length&&h.indexOf(l[p])===-1;++p);if(p===l.length){g&&g("Handshake: No matching S->C cipher");return x(e,"Handshake failed: no matching S->C cipher","handshake",v.KEY_EXCHANGE_FAILED)}n.sc.cipher=l[p];g&&g(`Handshake: S->C cipher: ${l[p]}`);const w=o.lists.cs.mac.array;g&&g(`Handshake: (local) C->S MAC: ${w}`);g&&g(`Handshake: (remote) C->S MAC: ${f.cs.mac}`);if(R[n.cs.cipher].authLen>0){n.cs.mac="";g&&g("Handshake: C->S MAC: <implicit>")}else{if(e._server){h=w;l=f.cs.mac}else{h=f.cs.mac;l=w}for(p=0;p<l.length&&h.indexOf(l[p])===-1;++p);if(p===l.length){g&&g("Handshake: No matching C->S MAC");return x(e,"Handshake failed: no matching C->S MAC","handshake",v.KEY_EXCHANGE_FAILED)}n.cs.mac=l[p];g&&g(`Handshake: C->S MAC: ${l[p]}`)}const I=o.lists.sc.mac.array;g&&g(`Handshake: (local) S->C MAC: ${I}`);g&&g(`Handshake: (remote) S->C MAC: ${f.sc.mac}`);if(R[n.sc.cipher].authLen>0){n.sc.mac="";g&&g("Handshake: S->C MAC: <implicit>")}else{if(e._server){h=I;l=f.sc.mac}else{h=f.sc.mac;l=I}for(p=0;p<l.length&&h.indexOf(l[p])===-1;++p);if(p===l.length){g&&g("Handshake: No matching S->C MAC");return x(e,"Handshake failed: no matching S->C MAC","handshake",v.KEY_EXCHANGE_FAILED)}n.sc.mac=l[p];g&&g(`Handshake: S->C MAC: ${l[p]}`)}const C=o.lists.cs.compress.array;g&&g(`Handshake: (local) C->S compression: ${C}`);g&&g(`Handshake: (remote) C->S compression: ${f.cs.compress}`);if(e._server){h=C;l=f.cs.compress}else{h=f.cs.compress;l=C}for(p=0;p<l.length&&h.indexOf(l[p])===-1;++p);if(p===l.length){g&&g("Handshake: No matching C->S compression");return x(e,"Handshake failed: no matching C->S compression","handshake",v.KEY_EXCHANGE_FAILED)}n.cs.compress=l[p];g&&g(`Handshake: C->S compression: ${l[p]}`);const k=o.lists.sc.compress.array;g&&g(`Handshake: (local) S->C compression: ${k}`);g&&g(`Handshake: (remote) S->C compression: ${f.sc.compress}`);if(e._server){h=k;l=f.sc.compress}else{h=f.sc.compress;l=k}for(p=0;p<l.length&&h.indexOf(l[p])===-1;++p);if(p===l.length){g&&g("Handshake: No matching S->C compression");return x(e,"Handshake failed: no matching S->C compression","handshake",v.KEY_EXCHANGE_FAILED)}n.sc.compress=l[p];g&&g(`Handshake: S->C compression: ${l[p]}`);n.cs.lang="";n.sc.lang="";if(e._kex){if(!e._kexinit){kexinit(e)}e._decipher._onPayload=onKEXPayload.bind(e,{firstPacket:false})}e._kex=te(n,e,t);e._kex.start()}const te=(()=>{function convertToMpint(e){let t=0;let n=e.length;while(e[t]===0){++t;--n}let i;if(e[t]&128){i=Buffer.allocUnsafe(1+n);i[0]=0;e.copy(i,1,t);e=i}else if(n!==e.length){i=Buffer.allocUnsafe(n);e.copy(i,0,t);e=i}return e}class KeyExchange{constructor(e,t,n){this._protocol=t;this.sessionID=t._kex?t._kex.sessionID:undefined;this.negotiated=e;this._step=1;this._public=null;this._dh=null;this._sentNEWKEYS=false;this._receivedNEWKEYS=false;this._finished=false;this._hostVerified=false;this._kexinit=t._kexinit;this._remoteKexinit=n;this._identRaw=t._identRaw;this._remoteIdentRaw=t._remoteIdentRaw;this._hostKey=undefined;this._dhData=undefined;this._sig=undefined}finish(){if(this._finished)return false;this._finished=true;const e=this._protocol._server;const t=this.negotiated;const n=this.convertPublicKey(this._dhData);let i=this.computeSecret(this._dhData);if(i instanceof Error){i.message=`Error while computing DH secret (${this.type}): ${i.message}`;i.level="handshake";return x(this._protocol,i,v.KEY_EXCHANGE_FAILED)}const s=f(this.hashName);ne(s,e?this._remoteIdentRaw:this._identRaw);ne(s,e?this._identRaw:this._remoteIdentRaw);ne(s,e?this._remoteKexinit:this._kexinit);ne(s,e?this._kexinit:this._remoteKexinit);const o=e?this._hostKey.getPublicSSH():this._hostKey;ne(s,o);if(this.type==="groupex"){const e=this.getDHParams();const t=Buffer.allocUnsafe(4);$(t,this._minBits,0);s.update(t);$(t,this._prefBits,0);s.update(t);$(t,this._maxBits,0);s.update(t);ne(s,e.prime);ne(s,e.generator)}ne(s,e?n:this.getPublicKey());const u=e?this.getPublicKey():n;ne(s,u);ne(s,i);const l=s.digest();if(!e){U.init(this._sig,0);const e=U.readString(true);if(!e){return x(this._protocol,"Malformed packet while reading signature","handshake",v.KEY_EXCHANGE_FAILED)}if(e!==t.serverHostKey){return x(this._protocol,`Wrong signature type: ${e}, `+`expected: ${t.serverHostKey}`,"handshake",v.KEY_EXCHANGE_FAILED)}let n=U.readString();U.clear();if(n===undefined){return x(this._protocol,"Malformed packet while reading signature","handshake",v.KEY_EXCHANGE_FAILED)}if(!(n=W(n,e))){return x(this._protocol,"Malformed signature","handshake",v.KEY_EXCHANGE_FAILED)}let i;{U.init(this._hostKey,0);const e=U.readString(true);const t=this._hostKey.slice(U.pos());U.clear();i=P(t,e);if(i instanceof Error){i.level="handshake";return x(this._protocol,i,v.KEY_EXCHANGE_FAILED)}}let s;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":s="sha256";break;case"rsa-sha2-512":s="sha512";break}this._protocol._debug&&this._protocol._debug("Verifying signature ...");const o=i.verify(l,n,s);if(o!==true){if(o instanceof Error){this._protocol._debug&&this._protocol._debug(`Signature verification failed: ${o.stack}`)}else{this._protocol._debug&&this._protocol._debug("Signature verification failed")}return x(this._protocol,"Handshake failed: signature verification failed","handshake",v.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Verified signature")}else{let e;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":e="sha256";break;case"rsa-sha2-512":e="sha512";break}this._protocol._debug&&this._protocol._debug("Generating signature ...");let t=this._hostKey.sign(l,e);if(t instanceof Error){return x(this._protocol,"Handshake failed: signature generation failed for "+`${this._hostKey.type} host key: ${t.message}`,"handshake",v.KEY_EXCHANGE_FAILED)}t=D(t,this._hostKey.type);if(t===false){return x(this._protocol,"Handshake failed: signature conversion failed for "+`${this._hostKey.type} host key`,"handshake",v.KEY_EXCHANGE_FAILED)}const n=this.negotiated.serverHostKey;const i=Buffer.byteLength(n);const s=4+i+4+t.length;let f=this._protocol._packetRW.write.allocStartKEX;const h=this._protocol._packetRW.write.alloc(1+4+o.length+4+u.length+4+s,true);h[f]=k.KEXDH_REPLY;$(h,o.length,++f);h.set(o,f+=4);$(h,u.length,f+=o.length);h.set(u,f+=4);$(h,s,f+=u.length);$(h,i,f+=4);h.utf8Write(n,f+=4,i);$(h,t.length,f+=i);h.set(t,f+=4);if(this._protocol._debug){let e;switch(this.type){case"group":e="KEXDH_REPLY";break;case"groupex":e="KEXDH_GEX_REPLY";break;default:e="KEXECDH_REPLY"}this._protocol._debug(`Outbound: Sending ${e}`)}this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(h,true))}trySendNEWKEYS(this);const completeHandshake=()=>{if(!this.sessionID)this.sessionID=l;{const e=Buffer.allocUnsafe(4+i.length);$(e,i.length,0);e.set(i,4);i=e}const n=R[t.cs.cipher];const s=R[t.sc.cipher];const o=generateKEXVal(n.ivLen,this.hashName,i,l,this.sessionID,"A");const f=generateKEXVal(s.ivLen,this.hashName,i,l,this.sessionID,"B");const u=generateKEXVal(n.keyLen,this.hashName,i,l,this.sessionID,"C");const h=generateKEXVal(s.keyLen,this.hashName,i,l,this.sessionID,"D");let p;let g;if(!n.authLen){p=O[t.cs.mac];g=generateKEXVal(p.len,this.hashName,i,l,this.sessionID,"E")}let _;let E;if(!s.authLen){_=O[t.sc.mac];E=generateKEXVal(_.len,this.hashName,i,l,this.sessionID,"F")}const y={inbound:{onPayload:this._protocol._onPayload,seqno:this._protocol._decipher.inSeqno,decipherInfo:!e?s:n,decipherIV:!e?f:o,decipherKey:!e?h:u,macInfo:!e?_:p,macKey:!e?E:g},outbound:{onWrite:this._protocol._onWrite,seqno:this._protocol._cipher.outSeqno,cipherInfo:e?s:n,cipherIV:e?f:o,cipherKey:e?h:u,macInfo:e?_:p,macKey:e?E:g}};this._protocol._cipher&&this._protocol._cipher.free();this._protocol._decipher&&this._protocol._decipher.free();this._protocol._cipher=B(y);this._protocol._decipher=T(y);const b={read:undefined,write:undefined};switch(t.cs.compress){case"zlib":if(e)b.read=new j;else b.write=new Y(this._protocol);break;case"zlib@openssh.com":if(this._protocol._authenticated){if(e)b.read=new j;else b.write=new Y(this._protocol);break}default:if(e)b.read=new q;else b.write=new G(this._protocol)}switch(t.sc.compress){case"zlib":if(e)b.write=new Y(this._protocol);else b.read=new j;break;case"zlib@openssh.com":if(this._protocol._authenticated){if(e)b.write=new Y(this._protocol);else b.read=new j;break}default:if(e)b.write=new G(this._protocol);else b.read=new q}this._protocol._packetRW.read.cleanup();this._protocol._packetRW.write.cleanup();this._protocol._packetRW=b;this._public=null;this._dh=null;this._kexinit=this._protocol._kexinit=undefined;this._remoteKexinit=undefined;this._identRaw=undefined;this._remoteIdentRaw=undefined;this._hostKey=undefined;this._dhData=undefined;this._sig=undefined;this._protocol._onHandshakeComplete(t);return false};if(!e)return completeHandshake();this.finish=completeHandshake}start(){if(!this._protocol._server){if(this._protocol._debug){let e;switch(this.type){case"group":e="KEXDH_INIT";break;default:e="KEXECDH_INIT"}this._protocol._debug(`Outbound: Sending ${e}`)}const e=this.getPublicKey();let t=this._protocol._packetRW.write.allocStartKEX;const n=this._protocol._packetRW.write.alloc(1+4+e.length,true);n[t]=k.KEXDH_INIT;$(n,e.length,++t);n.set(e,t+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(n,true))}}getPublicKey(){this.generateKeys();const e=this._public;if(e)return this.convertPublicKey(e)}convertPublicKey(e){let t;let n=0;let i=e.length;while(e[n]===0){++n;--i}if(e[n]&128){t=Buffer.allocUnsafe(1+i);t[0]=0;e.copy(t,1,n);return t}if(i!==e.length){t=Buffer.allocUnsafe(i);e.copy(t,0,n);e=t}return e}computeSecret(e){this.generateKeys();try{return convertToMpint(this._dh.computeSecret(e))}catch(e){return e}}parse(e){const t=e[0];switch(this._step){case 1:if(this._protocol._server){if(t!==k.KEXDH_INIT){return x(this._protocol,`Received packet ${t} instead of ${k.KEXDH_INIT}`,"handshake",v.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH Init");U.init(e,1);const n=U.readString();U.clear();if(n===undefined){return x(this._protocol,"Received malformed KEX*_INIT","handshake",v.KEY_EXCHANGE_FAILED)}this._dhData=n;let i=this._protocol._hostKeys[this.negotiated.serverHostKey];if(Array.isArray(i))i=i[0];this._hostKey=i;this.finish()}else{if(t!==k.KEXDH_REPLY){return x(this._protocol,`Received packet ${t} instead of ${k.KEXDH_REPLY}`,"handshake",v.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH Reply");U.init(e,1);let n;let i;let s;if((n=U.readString())===undefined||(i=U.readString())===undefined||(s=U.readString())===undefined){U.clear();return x(this._protocol,"Received malformed KEX*_REPLY","handshake",v.KEY_EXCHANGE_FAILED)}U.clear();U.init(n,0);const o=U.readString(true);U.clear();if(o===undefined){return x(this._protocol,"Received malformed host public key","handshake",v.KEY_EXCHANGE_FAILED)}if(o!==this.negotiated.serverHostKey){switch(this.negotiated.serverHostKey){case"rsa-sha2-256":case"rsa-sha2-512":if(o==="ssh-rsa")break;default:return x(this._protocol,"Host key does not match negotiated type","handshake",v.KEY_EXCHANGE_FAILED)}}this._hostKey=n;this._dhData=i;this._sig=s;let f=false;let u;if(this._protocol._hostVerifier===undefined){u=true;this._protocol._debug&&this._protocol._debug("Host accepted by default (no verification)")}else{u=this._protocol._hostVerifier(n,(e=>{if(f)return;f=true;if(e===false){this._protocol._debug&&this._protocol._debug("Host denied (verification failed)");return x(this._protocol,"Host denied (verification failed)","handshake",v.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Host accepted (verified)");this._hostVerified=true;if(this._receivedNEWKEYS)this.finish();else trySendNEWKEYS(this)}))}if(u===undefined){++this._step;return}f=true;if(u===false){this._protocol._debug&&this._protocol._debug("Host denied (verification failed)");return x(this._protocol,"Host denied (verification failed)","handshake",v.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Host accepted (verified)");this._hostVerified=true;trySendNEWKEYS(this)}++this._step;break;case 2:if(t!==k.NEWKEYS){return x(this._protocol,`Received packet ${t} instead of ${k.NEWKEYS}`,"handshake",v.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Inbound: NEWKEYS");this._receivedNEWKEYS=true;++this._step;if(this._protocol._server||this._hostVerified)return this.finish();return false;default:return x(this._protocol,`Received unexpected packet ${t} after NEWKEYS`,"handshake",v.KEY_EXCHANGE_FAILED)}}}class Curve25519Exchange extends KeyExchange{constructor(e,...t){super(...t);this.type="25519";this.hashName=e;this._keys=null}generateKeys(){if(!this._keys)this._keys=h("x25519")}getPublicKey(){this.generateKeys();const e=this._keys.publicKey.export({type:"spki",format:"der"});return e.slice(-32)}convertPublicKey(e){let t;let n=0;let i=e.length;while(e[n]===0){++n;--i}if(e.length===32)return e;if(i!==e.length){t=Buffer.allocUnsafe(i);e.copy(t,0,n);e=t}return e}computeSecret(e){this.generateKeys();try{const t=new g.Writer;t.startSequence();t.startSequence();t.writeOID("1.3.101.110");t.endSequence();t.startSequence(g.BitString);t.writeByte(0);t._ensure(e.length);e.copy(t._buf,t._offset,0,e.length);t._offset+=e.length;t.endSequence();t.endSequence();return convertToMpint(l({privateKey:this._keys.privateKey,publicKey:u({key:t.buffer,type:"spki",format:"der"})}))}catch(e){return e}}}class ECDHExchange extends KeyExchange{constructor(e,t,...n){super(...n);this.type="ecdh";this.curveName=e;this.hashName=t}generateKeys(){if(!this._dh){this._dh=o(this.curveName);this._public=this._dh.generateKeys()}}}class DHGroupExchange extends KeyExchange{constructor(e,...t){super(...t);this.type="groupex";this.hashName=e;this._prime=null;this._generator=null;this._minBits=z;this._prefBits=dhEstimate(this.negotiated);if(this._protocol._compatFlags&_.BUG_DHGEX_LARGE)this._prefBits=Math.min(this._prefBits,4096);this._maxBits=J}start(){if(this._protocol._server)return;this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_REQUEST");let e=this._protocol._packetRW.write.allocStartKEX;const t=this._protocol._packetRW.write.alloc(1+4+4+4,true);t[e]=k.KEXDH_GEX_REQUEST;$(t,this._minBits,++e);$(t,this._prefBits,e+=4);$(t,this._maxBits,e+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(t,true))}generateKeys(){if(!this._dh&&this._prime&&this._generator){this._dh=i(this._prime,this._generator);this._public=this._dh.generateKeys()}}setDHParams(e,t){if(!Buffer.isBuffer(e))throw new Error("Invalid prime value");if(!Buffer.isBuffer(t))throw new Error("Invalid generator value");this._prime=e;this._generator=t}getDHParams(){if(this._dh){return{prime:convertToMpint(this._dh.getPrime()),generator:convertToMpint(this._dh.getGenerator())}}}parse(e){const t=e[0];switch(this._step){case 1:if(this._protocol._server){if(t!==k.KEXDH_GEX_REQUEST){return x(this._protocol,`Received packet ${t} instead of `+k.KEXDH_GEX_REQUEST,"handshake",v.KEY_EXCHANGE_FAILED)}return x(this._protocol,"Group exchange not implemented for server","handshake",v.KEY_EXCHANGE_FAILED)}if(t!==k.KEXDH_GEX_GROUP){return x(this._protocol,`Received packet ${t} instead of ${k.KEXDH_GEX_GROUP}`,"handshake",v.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH GEX Group");U.init(e,1);let n;let i;if((n=U.readString())===undefined||(i=U.readString())===undefined){U.clear();return x(this._protocol,"Received malformed KEXDH_GEX_GROUP","handshake",v.KEY_EXCHANGE_FAILED)}U.clear();this.setDHParams(n,i);this.generateKeys();const s=this.getPublicKey();this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_INIT");let o=this._protocol._packetRW.write.allocStartKEX;const f=this._protocol._packetRW.write.alloc(1+4+s.length,true);f[o]=k.KEXDH_GEX_INIT;$(f,s.length,++o);f.set(s,o+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(f,true));++this._step;break;case 2:if(this._protocol._server){if(t!==k.KEXDH_GEX_INIT){return x(this._protocol,`Received packet ${t} instead of ${k.KEXDH_GEX_INIT}`,"handshake",v.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH GEX Init");return x(this._protocol,"Group exchange not implemented for server","handshake",v.KEY_EXCHANGE_FAILED)}else if(t!==k.KEXDH_GEX_REPLY){return x(this._protocol,`Received packet ${t} instead of ${k.KEXDH_GEX_REPLY}`,"handshake",v.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH GEX Reply");this._step=1;e[0]=k.KEXDH_REPLY;this.parse=KeyExchange.prototype.parse;this.parse(e)}}}class DHExchange extends KeyExchange{constructor(e,t,...n){super(...n);this.type="group";this.groupName=e;this.hashName=t}start(){if(!this._protocol._server){this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_INIT");const e=this.getPublicKey();let t=this._protocol._packetRW.write.allocStartKEX;const n=this._protocol._packetRW.write.alloc(1+4+e.length,true);n[t]=k.KEXDH_INIT;$(n,e.length,++t);n.set(e,t+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(n,true))}}generateKeys(){if(!this._dh){this._dh=s(this.groupName);this._public=this._dh.generateKeys()}}getDHParams(){if(this._dh){return{prime:convertToMpint(this._dh.getPrime()),generator:convertToMpint(this._dh.getGenerator())}}}}return(e,...t)=>{if(typeof e!=="object"||e===null)throw new Error("Invalid negotiated argument");const n=e.kex;if(typeof n==="string"){t=[e,...t];switch(n){case"curve25519-sha256":case"curve25519-sha256@libssh.org":if(!E)break;return new Curve25519Exchange("sha256",...t);case"ecdh-sha2-nistp256":return new ECDHExchange("prime256v1","sha256",...t);case"ecdh-sha2-nistp384":return new ECDHExchange("secp384r1","sha384",...t);case"ecdh-sha2-nistp521":return new ECDHExchange("secp521r1","sha512",...t);case"diffie-hellman-group1-sha1":return new DHExchange("modp2","sha1",...t);case"diffie-hellman-group14-sha1":return new DHExchange("modp14","sha1",...t);case"diffie-hellman-group14-sha256":return new DHExchange("modp14","sha256",...t);case"diffie-hellman-group15-sha512":return new DHExchange("modp15","sha512",...t);case"diffie-hellman-group16-sha512":return new DHExchange("modp16","sha512",...t);case"diffie-hellman-group17-sha512":return new DHExchange("modp17","sha512",...t);case"diffie-hellman-group18-sha512":return new DHExchange("modp18","sha512",...t);case"diffie-hellman-group-exchange-sha1":return new DHGroupExchange("sha1",...t);case"diffie-hellman-group-exchange-sha256":return new DHGroupExchange("sha256",...t)}throw new Error(`Unsupported key exchange algorithm: ${n}`)}throw new Error(`Invalid key exchange type: ${n}`)}})();const re=(()=>{const e=["kex","serverHostKey",["cs","cipher"],["sc","cipher"],["cs","mac"],["sc","mac"],["cs","compress"],["sc","compress"],["cs","lang"],["sc","lang"]];return class KexInit{constructor(t){if(typeof t!=="object"||t===null)throw new TypeError("Argument must be an object");const n={kex:undefined,serverHostKey:undefined,cs:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined},sc:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined},all:undefined};let i=0;for(const s of e){let e;let o;let f;let u;if(typeof s==="string"){e=n;o=t[s];f=u=s}else{const i=s[0];e=n[i];u=s[1];o=t[i][u];f=`${i}.${u}`}const l={array:undefined,buffer:undefined};if(Buffer.isBuffer(o)){l.array=(""+o).split(",");l.buffer=o;i+=4+o.length}else{if(typeof o==="string")o=o.split(",");if(Array.isArray(o)){l.array=o;l.buffer=Buffer.from(o.join(","))}else{throw new TypeError(`Invalid \`${f}\` type: ${typeof o}`)}i+=4+l.buffer.length}e[u]=l}const s=Buffer.allocUnsafe(i);n.all=s;let o=0;for(const t of e){let e;if(typeof t==="string")e=n[t].buffer;else e=n[t[0]][t[1]].buffer;o=$(s,e.length,o);s.set(e,o);o+=e.length}this.totalSize=i;this.lists=n}copyAllTo(e,t){const n=this.lists.all;if(typeof t!=="number")throw new TypeError(`Invalid offset value: ${typeof t}`);if(e.length-t<n.length)throw new Error("Insufficient space to copy list");e.set(n,t);return n.length}}})();const ne=(()=>{const e=Buffer.allocUnsafe(4);return(t,n)=>{$(e,n.length,0);t.update(e);t.update(n)}})();function generateKEXVal(e,t,n,i,s,o){let u;if(e){let l=f(t).update(n).update(i).update(o).update(s).digest();while(l.length<e){const e=f(t).update(n).update(i).update(l).digest();const s=Buffer.allocUnsafe(l.length+e.length);s.set(l,0);s.set(e,l.length);l=s}if(l.length===e)u=l;else u=new Q(l.buffer,l.byteOffset,e)}else{u=ee}return u}function onKEXPayload(e,t){if(t.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}if(this._skipNextInboundPacket){this._skipNextInboundPacket=false;return}t=this._packetRW.read.read(t);const i=t[0];switch(i){case k.DISCONNECT:case k.IGNORE:case k.UNIMPLEMENTED:case k.DEBUG:if(!V)V=n(172);return V[i](this,t);case k.KEXINIT:if(!e.firstPacket){return x(this,"Received extra KEXINIT during handshake","handshake",v.KEY_EXCHANGE_FAILED)}e.firstPacket=false;return handleKexInit(this,t);default:if(i<20||i>49){return x(this,`Received unexpected packet type ${i}`,"handshake",v.KEY_EXCHANGE_FAILED)}}return this._kex.parse(t)}function dhEstimate(e){const t=R[e.cs.cipher];const n=R[e.sc.cipher];const i=Math.max(0,t.sslName==="des-ede3-cbc"?14:t.keyLen,t.blockLen,t.ivLen,n.sslName==="des-ede3-cbc"?14:n.keyLen,n.blockLen,n.ivLen)*8;if(i<=112)return 2048;if(i<=128)return 3072;if(i<=192)return 7680;return 8192}function trySendNEWKEYS(e){if(!e._sentNEWKEYS){e._protocol._debug&&e._protocol._debug("Outbound: Sending NEWKEYS");const t=e._protocol._packetRW.write.allocStartKEX;const n=e._protocol._packetRW.write.alloc(1,true);n[t]=k.NEWKEYS;e._protocol._cipher.encrypt(e._protocol._packetRW.write.finalize(n,true));e._sentNEWKEYS=true}}e.exports={KexInit:re,kexinit:kexinit,onKEXPayload:onKEXPayload,DEFAULT_KEXINIT:new re({kex:y,serverHostKey:b,cs:{cipher:w,mac:I,compress:C,lang:[]},sc:{cipher:w,mac:I,compress:C,lang:[]}}),HANDLERS:{[k.KEXINIT]:handleKexInit}}},2218:(e,t,n)=>{"use strict";const{createDecipheriv:i,createECDH:s,createHash:o,createHmac:f,createSign:u,createVerify:l,getCiphers:h,sign:p,verify:g}=n(6113);const _=h();const{Ber:E}=n(970);const y=n(5447).pbkdf;const{CIPHER_INFO:b}=n(5708);const{eddsaSupported:w,SUPPORTED_CIPHER:I}=n(6832);const{bufferSlice:C,makeBufferParser:v,readString:k,readUInt32BE:R,writeUInt32BE:B}=n(9475);const T=Symbol("Hash Algorithm");const O=Symbol("Private key PEM");const P=Symbol("Public key PEM");const L=Symbol("Public key SSH");const U=Symbol("Decrypted Key");const D=Object.create(null);{const e=Object.keys(b);for(let t=0;t<e.length;++t){const n=b[e[t]].sslName;if(!n||D[n])continue;D[n]=b[e[t]]}}const x=v();function makePEM(e,t){t=t.base64Slice(0,t.length);let n=t.replace(/.{64}/g,"$&\n");if(t.length&63)n+="\n";return`-----BEGIN ${e} KEY-----\n${n}-----END ${e} KEY-----`}function combineBuffers(e,t){const n=Buffer.allocUnsafe(e.length+t.length);n.set(e,0);n.set(t,e.length);return n}function skipFields(e,t){const n=e.length;let i=e._pos||0;for(let s=0;s<t;++s){const t=n-i;if(i>=n||t<4)return false;const s=R(e,i);if(t<4+s)return false;i+=4+s}e._pos=i;return true}function genOpenSSLRSAPub(e,t){const n=new E.Writer;n.startSequence();n.startSequence();n.writeOID("1.2.840.113549.1.1.1");n.writeNull();n.endSequence();n.startSequence(E.BitString);n.writeByte(0);n.startSequence();n.writeBuffer(e,E.Integer);n.writeBuffer(t,E.Integer);n.endSequence();n.endSequence();n.endSequence();return makePEM("PUBLIC",n.buffer)}function genOpenSSHRSAPub(e,t){const n=Buffer.allocUnsafe(4+7+4+t.length+4+e.length);B(n,7,0);n.utf8Write("ssh-rsa",4,7);let i=4+7;B(n,t.length,i);n.set(t,i+=4);B(n,e.length,i+=t.length);n.set(e,i+4);return n}const Q=(()=>{function genRSAASN1Buf(e,t,n,i,s,o,f,u){const l=new E.Writer;l.startSequence();l.writeInt(0,E.Integer);l.writeBuffer(e,E.Integer);l.writeBuffer(t,E.Integer);l.writeBuffer(n,E.Integer);l.writeBuffer(i,E.Integer);l.writeBuffer(s,E.Integer);l.writeBuffer(o,E.Integer);l.writeBuffer(f,E.Integer);l.writeBuffer(u,E.Integer);l.endSequence();return l.buffer}function bigIntFromBuffer(e){return BigInt(`0x${e.hexSlice(0,e.length)}`)}function bigIntToBuffer(e){let t=e.toString(16);if((t.length&1)!==0){t=`0${t}`}else{const e=t.charCodeAt(0);if(e===56||e===57||e>=97&&e<=102){t=`00${t}`}}return Buffer.from(t,"hex")}return function genOpenSSLRSAPriv(e,t,n,i,s,o){const f=bigIntFromBuffer(n);const u=bigIntToBuffer(f%(bigIntFromBuffer(s)-1n));const l=bigIntToBuffer(f%(bigIntFromBuffer(o)-1n));return makePEM("RSA PRIVATE",genRSAASN1Buf(e,t,n,s,o,u,l,i))}})();function genOpenSSLDSAPub(e,t,n,i){const s=new E.Writer;s.startSequence();s.startSequence();s.writeOID("1.2.840.10040.4.1");s.startSequence();s.writeBuffer(e,E.Integer);s.writeBuffer(t,E.Integer);s.writeBuffer(n,E.Integer);s.endSequence();s.endSequence();s.startSequence(E.BitString);s.writeByte(0);s.writeBuffer(i,E.Integer);s.endSequence();s.endSequence();return makePEM("PUBLIC",s.buffer)}function genOpenSSHDSAPub(e,t,n,i){const s=Buffer.allocUnsafe(4+7+4+e.length+4+t.length+4+n.length+4+i.length);B(s,7,0);s.utf8Write("ssh-dss",4,7);let o=4+7;B(s,e.length,o);s.set(e,o+=4);B(s,t.length,o+=e.length);s.set(t,o+=4);B(s,n.length,o+=t.length);s.set(n,o+=4);B(s,i.length,o+=n.length);s.set(i,o+4);return s}function genOpenSSLDSAPriv(e,t,n,i,s){const o=new E.Writer;o.startSequence();o.writeInt(0,E.Integer);o.writeBuffer(e,E.Integer);o.writeBuffer(t,E.Integer);o.writeBuffer(n,E.Integer);o.writeBuffer(i,E.Integer);o.writeBuffer(s,E.Integer);o.endSequence();return makePEM("DSA PRIVATE",o.buffer)}function genOpenSSLEdPub(e){const t=new E.Writer;t.startSequence();t.startSequence();t.writeOID("1.3.101.112");t.endSequence();t.startSequence(E.BitString);t.writeByte(0);t._ensure(e.length);t._buf.set(e,t._offset);t._offset+=e.length;t.endSequence();t.endSequence();return makePEM("PUBLIC",t.buffer)}function genOpenSSHEdPub(e){const t=Buffer.allocUnsafe(4+11+4+e.length);B(t,11,0);t.utf8Write("ssh-ed25519",4,11);B(t,e.length,15);t.set(e,19);return t}function genOpenSSLEdPriv(e){const t=new E.Writer;t.startSequence();t.writeInt(0,E.Integer);t.startSequence();t.writeOID("1.3.101.112");t.endSequence();t.startSequence(E.OctetString);t.writeBuffer(e,E.OctetString);t.endSequence();t.endSequence();return makePEM("PRIVATE",t.buffer)}function genOpenSSLECDSAPub(e,t){const n=new E.Writer;n.startSequence();n.startSequence();n.writeOID("1.2.840.10045.2.1");n.writeOID(e);n.endSequence();n.startSequence(E.BitString);n.writeByte(0);n._ensure(t.length);n._buf.set(t,n._offset);n._offset+=t.length;n.endSequence();n.endSequence();return makePEM("PUBLIC",n.buffer)}function genOpenSSHECDSAPub(e,t){let n;switch(e){case"1.2.840.10045.3.1.7":n="nistp256";break;case"1.3.132.0.34":n="nistp384";break;case"1.3.132.0.35":n="nistp521";break;default:return}const i=Buffer.allocUnsafe(4+19+4+8+4+t.length);B(i,19,0);i.utf8Write(`ecdsa-sha2-${n}`,4,19);B(i,8,23);i.utf8Write(n,27,8);B(i,t.length,35);i.set(t,39);return i}function genOpenSSLECDSAPriv(e,t,n){const i=new E.Writer;i.startSequence();i.writeInt(1,E.Integer);i.writeBuffer(n,E.OctetString);i.startSequence(160);i.writeOID(e);i.endSequence();i.startSequence(161);i.startSequence(E.BitString);i.writeByte(0);i._ensure(t.length);i._buf.set(t,i._offset);i._offset+=t.length;i.endSequence();i.endSequence();i.endSequence();return makePEM("EC PRIVATE",i.buffer)}function genOpenSSLECDSAPubFromPriv(e,t){const n=s(e);n.setPrivateKey(t);return n.getPublicKey()}const W={sign:(()=>{if(typeof p==="function"){return function sign(e,t){const n=this[O];if(n===null)return new Error("No private key available");if(!t||typeof t!=="string")t=this[T];try{return p(t,e,n)}catch(e){return e}}}return function sign(e,t){const n=this[O];if(n===null)return new Error("No private key available");if(!t||typeof t!=="string")t=this[T];const i=u(t);i.update(e);try{return i.sign(n)}catch(e){return e}}})(),verify:(()=>{if(typeof g==="function"){return function verify(e,t,n){const i=this[P];if(i===null)return new Error("No public key available");if(!n||typeof n!=="string")n=this[T];try{return g(n,e,i,t)}catch(e){return e}}}return function verify(e,t,n){const i=this[P];if(i===null)return new Error("No public key available");if(!n||typeof n!=="string")n=this[T];const s=l(n);s.update(e);try{return s.verify(i,t)}catch(e){return e}}})(),isPrivateKey:function isPrivateKey(){return this[O]!==null},getPrivatePEM:function getPrivatePEM(){return this[O]},getPublicPEM:function getPublicPEM(){return this[P]},getPublicSSH:function getPublicSSH(){return this[L]},equals:function equals(e){const t=parseKey(e);if(t instanceof Error)return false;return this.type===t.type&&this[O]===t[O]&&this[P]===t[P]&&this[L]===t[L]}};function OpenSSH_Private(e,t,n,i,s,o,f){this.type=e;this.comment=t;this[O]=n;this[P]=i;this[L]=s;this[T]=o;this[U]=f}OpenSSH_Private.prototype=W;{const e=/^-----BEGIN OPENSSH PRIVATE KEY-----(?:\r\n|\n)([\s\S]+)(?:\r\n|\n)-----END OPENSSH PRIVATE KEY-----$/;OpenSSH_Private.parse=(t,n)=>{const s=e.exec(t);if(s===null)return null;let o;const f=Buffer.from(s[1],"base64");if(f.length<31)return new Error("Malformed OpenSSH private key");const u=f.utf8Slice(0,15);if(u!=="openssh-key-v1\0")return new Error(`Unsupported OpenSSH key magic: ${u}`);const l=k(f,15,true);if(l===undefined)return new Error("Malformed OpenSSH private key");if(l!=="none"&&I.indexOf(l)===-1)return new Error(`Unsupported cipher for OpenSSH key: ${l}`);const h=k(f,f._pos,true);if(h===undefined)return new Error("Malformed OpenSSH private key");if(h!=="none"){if(l==="none")return new Error("Malformed OpenSSH private key");if(h!=="bcrypt")return new Error(`Unsupported kdf name for OpenSSH key: ${h}`);if(!n){return new Error("Encrypted private OpenSSH key detected, but no passphrase given")}}else if(l!=="none"){return new Error("Malformed OpenSSH private key")}let p;let g;let _;if(l!=="none")p=b[l];const E=k(f,f._pos);if(E===undefined)return new Error("Malformed OpenSSH private key");if(E.length){switch(h){case"none":return new Error("Malformed OpenSSH private key");case"bcrypt":const e=k(E,0);if(e===undefined||E._pos+4>E.length)return new Error("Malformed OpenSSH private key");const t=R(E,E._pos);const i=Buffer.allocUnsafe(p.keyLen+p.ivLen);const s=y(n,n.length,e,e.length,i,i.length,t);if(s!==0)return new Error("Failed to generate information to decrypt key");g=C(i,0,p.keyLen);_=C(i,p.keyLen,i.length);break}}else if(h!=="none"){return new Error("Malformed OpenSSH private key")}if(f._pos+3>=f.length)return new Error("Malformed OpenSSH private key");const w=R(f,f._pos);f._pos+=4;if(w>0){for(let e=0;e<w;++e){const e=k(f,f._pos);if(e===undefined)return new Error("Malformed OpenSSH private key");const t=k(e,0,true);if(t===undefined)return new Error("Malformed OpenSSH private key")}let e=k(f,f._pos);if(e===undefined)return new Error("Malformed OpenSSH private key");if(g!==undefined){if(e.length<p.blockLen||e.length%p.blockLen!==0){return new Error("Malformed OpenSSH private key")}try{const t={authTagLength:p.authLen};const n=i(p.sslName,g,_,t);if(p.authLen>0){if(f.length-f._pos<p.authLen)return new Error("Malformed OpenSSH private key");n.setAuthTag(C(f,f._pos,f._pos+=p.authLen))}e=combineBuffers(n.update(e),n.final())}catch(e){return e}}if(f._pos!==f.length)return new Error("Malformed OpenSSH private key");o=parseOpenSSHPrivKeys(e,w,g!==undefined)}else{o=[]}if(o instanceof Error)return o;return o[0]};function parseOpenSSHPrivKeys(e,t,n){const i=[];if(e.length<8)return new Error("Malformed OpenSSH private key");const s=R(e,0);const o=R(e,4);if(s!==o){if(n){return new Error("OpenSSH key integrity check failed -- bad passphrase?")}return new Error("OpenSSH key integrity check failed")}e._pos=8;let f;let u;for(f=0;f<t;++f){let t;let s;let o;let f;const l=k(e,e._pos,true);if(l===undefined)return new Error("Malformed OpenSSH private key");switch(l){case"ssh-rsa":{const n=k(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH private key");const i=k(e,e._pos);if(i===undefined)return new Error("Malformed OpenSSH private key");const u=k(e,e._pos);if(u===undefined)return new Error("Malformed OpenSSH private key");const l=k(e,e._pos);if(l===undefined)return new Error("Malformed OpenSSH private key");const h=k(e,e._pos);if(h===undefined)return new Error("Malformed OpenSSH private key");const p=k(e,e._pos);if(p===undefined)return new Error("Malformed OpenSSH private key");o=genOpenSSLRSAPub(n,i);f=genOpenSSHRSAPub(n,i);s=Q(n,i,u,l,h,p);t="sha1";break}case"ssh-dss":{const n=k(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH private key");const i=k(e,e._pos);if(i===undefined)return new Error("Malformed OpenSSH private key");const u=k(e,e._pos);if(u===undefined)return new Error("Malformed OpenSSH private key");const l=k(e,e._pos);if(l===undefined)return new Error("Malformed OpenSSH private key");const h=k(e,e._pos);if(h===undefined)return new Error("Malformed OpenSSH private key");o=genOpenSSLDSAPub(n,i,u,l);f=genOpenSSHDSAPub(n,i,u,l);s=genOpenSSLDSAPriv(n,i,u,l,h);t="sha1";break}case"ssh-ed25519":{if(!w)return new Error(`Unsupported OpenSSH private key type: ${l}`);const n=k(e,e._pos);if(n===undefined||n.length!==32)return new Error("Malformed OpenSSH private key");const i=k(e,e._pos);if(i===undefined||i.length!==64)return new Error("Malformed OpenSSH private key");o=genOpenSSLEdPub(n);f=genOpenSSHEdPub(n);s=genOpenSSLEdPriv(C(i,0,32));t=null;break}case"ecdsa-sha2-nistp256":t="sha256";u="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":if(t===undefined){t="sha384";u="1.3.132.0.34"}case"ecdsa-sha2-nistp521":{if(t===undefined){t="sha512";u="1.3.132.0.35"}if(!skipFields(e,1))return new Error("Malformed OpenSSH private key");const n=k(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH private key");const i=k(e,e._pos);if(i===undefined)return new Error("Malformed OpenSSH private key");o=genOpenSSLECDSAPub(u,n);f=genOpenSSHECDSAPub(u,n);s=genOpenSSLECDSAPriv(u,n,i);break}default:return new Error(`Unsupported OpenSSH private key type: ${l}`)}const h=k(e,e._pos,true);if(h===undefined)return new Error("Malformed OpenSSH private key");i.push(new OpenSSH_Private(l,h,s,o,f,t,n))}let l=0;for(f=e._pos;f<e.length;++f){if(e[f]!==++l%255)return new Error("Malformed OpenSSH private key")}return i}}function OpenSSH_Old_Private(e,t,n,i,s,o,f){this.type=e;this.comment=t;this[O]=n;this[P]=i;this[L]=s;this[T]=o;this[U]=f}OpenSSH_Old_Private.prototype=W;{const e=/^-----BEGIN (RSA|DSA|EC) PRIVATE KEY-----(?:\r\n|\n)((?:[^:]+:\s*[\S].*(?:\r\n|\n))*)([\s\S]+)(?:\r\n|\n)-----END (RSA|DSA|EC) PRIVATE KEY-----$/;OpenSSH_Old_Private.parse=(t,n)=>{const s=e.exec(t);if(s===null)return null;let f=Buffer.from(s[3],"base64");let u=s[2];let l=false;if(u!==undefined){u=u.split(/\r\n|\n/g);for(let e=0;e<u.length;++e){const t=u[e];let s=t.indexOf(":");if(t.slice(0,s)==="DEK-Info"){const e=t.slice(s+2);s=e.indexOf(",");if(s===-1)continue;const u=e.slice(0,s).toLowerCase();if(_.indexOf(u)===-1){return new Error(`Cipher (${u}) not supported `+"for encrypted OpenSSH private key")}const h=D[u];if(!h){return new Error(`Cipher (${u}) not supported `+"for encrypted OpenSSH private key")}const p=Buffer.from(e.slice(s+1),"hex");if(p.length!==h.ivLen)return new Error("Malformed encrypted OpenSSH private key");if(!n){return new Error("Encrypted OpenSSH private key detected, but no passphrase given")}const g=C(p,0,8);let E=o("md5").update(n).update(g).digest();while(E.length<h.keyLen){E=combineBuffers(E,o("md5").update(E).update(n).update(g).digest())}if(E.length>h.keyLen)E=C(E,0,h.keyLen);try{const e=i(u,E,p);e.setAutoPadding(false);f=combineBuffers(e.update(f),e.final());l=true}catch(e){return e}}}}let h;let p;let g;let y;let b;let w;let I="Malformed OpenSSH private key";if(l)I+=". Bad passphrase?";switch(s[1]){case"RSA":h="ssh-rsa";p=makePEM("RSA PRIVATE",f);try{w=new E.Reader(f);w.readSequence();w.readInt();const e=w.readString(E.Integer,true);if(e===null)return new Error(I);const t=w.readString(E.Integer,true);if(t===null)return new Error(I);g=genOpenSSLRSAPub(e,t);y=genOpenSSHRSAPub(e,t)}catch{return new Error(I)}b="sha1";break;case"DSA":h="ssh-dss";p=makePEM("DSA PRIVATE",f);try{w=new E.Reader(f);w.readSequence();w.readInt();const e=w.readString(E.Integer,true);if(e===null)return new Error(I);const t=w.readString(E.Integer,true);if(t===null)return new Error(I);const n=w.readString(E.Integer,true);if(n===null)return new Error(I);const i=w.readString(E.Integer,true);if(i===null)return new Error(I);g=genOpenSSLDSAPub(e,t,n,i);y=genOpenSSHDSAPub(e,t,n,i)}catch{return new Error(I)}b="sha1";break;case"EC":let e;let t;let n;try{w=new E.Reader(f);w.readSequence();w.readInt();t=w.readString(E.OctetString,true);w.readByte();const i=w.readLength();if(i!==null){w._offset=i;n=w.readOID();if(n===null)return new Error(I);switch(n){case"1.2.840.10045.3.1.7":e="prime256v1";h="ecdsa-sha2-nistp256";b="sha256";break;case"1.3.132.0.34":e="secp384r1";h="ecdsa-sha2-nistp384";b="sha384";break;case"1.3.132.0.35":e="secp521r1";h="ecdsa-sha2-nistp521";b="sha512";break;default:return new Error(`Unsupported private key EC OID: ${n}`)}}else{return new Error(I)}}catch{return new Error(I)}p=makePEM("EC PRIVATE",f);const i=genOpenSSLECDSAPubFromPriv(e,t);g=genOpenSSLECDSAPub(n,i);y=genOpenSSHECDSAPub(n,i);break}return new OpenSSH_Old_Private(h,"",p,g,y,b,l)}}function PPK_Private(e,t,n,i,s,o,f){this.type=e;this.comment=t;this[O]=n;this[P]=i;this[L]=s;this[T]=o;this[U]=f}PPK_Private.prototype=W;{const e=Buffer.alloc(0);const t=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);const n=Buffer.from([0,0,0,0]);const s=Buffer.from([0,0,0,1]);const u=/^PuTTY-User-Key-File-2: (ssh-(?:rsa|dss))\r?\nEncryption: (aes256-cbc|none)\r?\nComment: ([^\r\n]*)\r?\nPublic-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-MAC: ([^\r\n]+)/;PPK_Private.parse=(l,h)=>{const p=u.exec(l);if(p===null)return null;const g=p[2];const _=g!=="none";if(_&&!h){return new Error("Encrypted PPK private key detected, but no passphrase given")}let E=Buffer.from(p[5],"base64");if(_){const e=b[g];let f=combineBuffers(o("sha1").update(n).update(h).digest(),o("sha1").update(s).update(h).digest());if(f.length>e.keyLen)f=C(f,0,e.keyLen);try{const n=i(e.sslName,f,t);n.setAutoPadding(false);E=combineBuffers(n.update(E),n.final())}catch(e){return e}}const y=p[1];const w=p[3];const I=Buffer.from(p[4],"base64");const v=p[6];const R=y.length;const T=g.length;const O=Buffer.byteLength(w);const P=I.length;const L=E.length;const U=Buffer.allocUnsafe(4+R+4+T+4+O+4+P+4+L);let D=0;B(U,R,D);U.utf8Write(y,D+=4,R);B(U,T,D+=R);U.utf8Write(g,D+=4,T);B(U,O,D+=T);U.utf8Write(w,D+=4,O);B(U,P,D+=O);U.set(I,D+=4);B(U,L,D+=P);U.set(E,D+4);if(!h)h=e;const x=f("sha1",o("sha1").update("putty-private-key-file-mac-key").update(h).digest()).update(U).digest("hex");if(x!==v){if(_){return new Error("PPK private key integrity check failed -- bad passphrase?")}return new Error("PPK private key integrity check failed")}let W;let $;let q;I._pos=0;skipFields(I,1);switch(y){case"ssh-rsa":{const e=k(I,I._pos);if(e===undefined)return new Error("Malformed PPK public key");const t=k(I,I._pos);if(t===undefined)return new Error("Malformed PPK public key");const n=k(E,0);if(n===undefined)return new Error("Malformed PPK private key");const i=k(E,E._pos);if(i===undefined)return new Error("Malformed PPK private key");const s=k(E,E._pos);if(s===undefined)return new Error("Malformed PPK private key");const o=k(E,E._pos);if(o===undefined)return new Error("Malformed PPK private key");W=genOpenSSLRSAPub(t,e);$=genOpenSSHRSAPub(t,e);q=Q(t,e,n,o,i,s);break}case"ssh-dss":{const e=k(I,I._pos);if(e===undefined)return new Error("Malformed PPK public key");const t=k(I,I._pos);if(t===undefined)return new Error("Malformed PPK public key");const n=k(I,I._pos);if(n===undefined)return new Error("Malformed PPK public key");const i=k(I,I._pos);if(i===undefined)return new Error("Malformed PPK public key");const s=k(E,0);if(s===undefined)return new Error("Malformed PPK private key");W=genOpenSSLDSAPub(e,t,n,i);$=genOpenSSHDSAPub(e,t,n,i);q=genOpenSSLDSAPriv(e,t,n,i,s);break}}return new PPK_Private(y,w,q,W,$,"sha1",_)}}function OpenSSH_Public(e,t,n,i,s){this.type=e;this.comment=t;this[O]=null;this[P]=n;this[L]=i;this[T]=s;this[U]=false}OpenSSH_Public.prototype=W;{let e;if(w)e=/^(((?:ssh-(?:rsa|dss|ed25519))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/;else e=/^(((?:ssh-(?:rsa|dss))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/;OpenSSH_Public.parse=t=>{const n=e.exec(t);if(n===null)return null;const i=n[1];const s=n[2];const o=Buffer.from(n[3],"base64");const f=n[4]||"";const u=k(o,o._pos,true);if(u===undefined||u.indexOf(s)!==0)return new Error("Malformed OpenSSH public key");return parseDER(o,s,f,i)}}function RFC4716_Public(e,t,n,i,s){this.type=e;this.comment=t;this[O]=null;this[P]=n;this[L]=i;this[T]=s;this[U]=false}RFC4716_Public.prototype=W;{const e=/^---- BEGIN SSH2 PUBLIC KEY ----(?:\r?\n)((?:.{0,72}\r?\n)+)---- END SSH2 PUBLIC KEY ----$/;const t=/^[A-Z0-9a-z/+=\r\n]+$/;const n=/^([\x21-\x39\x3B-\x7E]{1,64}): ((?:[^\\]*\\\r?\n)*[^\r\n]+)\r?\n/gm;const i=/\\\r?\n/g;RFC4716_Public.parse=s=>{let o=e.exec(s);if(o===null)return null;const f=o[1];let u=0;let l="";while(o=n.exec(f)){const e=o[1];const t=o[2].replace(i,"");if(t.length>1024){n.lastIndex=0;return new Error("Malformed RFC4716 public key")}u=n.lastIndex;if(e.toLowerCase()==="comment"){l=t;if(l.length>1&&l.charCodeAt(0)===34&&l.charCodeAt(l.length-1)===34){l=l.slice(1,-1)}}}let h=f.slice(u);if(!t.test(h))return new Error("Malformed RFC4716 public key");h=Buffer.from(h,"base64");const p=k(h,0,true);if(p===undefined)return new Error("Malformed RFC4716 public key");let g=null;let _=null;switch(p){case"ssh-rsa":{const e=k(h,h._pos);if(e===undefined)return new Error("Malformed RFC4716 public key");const t=k(h,h._pos);if(t===undefined)return new Error("Malformed RFC4716 public key");g=genOpenSSLRSAPub(t,e);_=genOpenSSHRSAPub(t,e);break}case"ssh-dss":{const e=k(h,h._pos);if(e===undefined)return new Error("Malformed RFC4716 public key");const t=k(h,h._pos);if(t===undefined)return new Error("Malformed RFC4716 public key");const n=k(h,h._pos);if(n===undefined)return new Error("Malformed RFC4716 public key");const i=k(h,h._pos);if(i===undefined)return new Error("Malformed RFC4716 public key");g=genOpenSSLDSAPub(e,t,n,i);_=genOpenSSHDSAPub(e,t,n,i);break}default:return new Error("Malformed RFC4716 public key")}return new RFC4716_Public(p,l,g,_,"sha1")}}function parseDER(e,t,n,i){if(!isSupportedKeyType(t))return new Error(`Unsupported OpenSSH public key type: ${t}`);let s;let o;let f=null;let u=null;switch(t){case"ssh-rsa":{const t=k(e,e._pos||0);if(t===undefined)return new Error("Malformed OpenSSH public key");const n=k(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH public key");f=genOpenSSLRSAPub(n,t);u=genOpenSSHRSAPub(n,t);s="sha1";break}case"ssh-dss":{const t=k(e,e._pos||0);if(t===undefined)return new Error("Malformed OpenSSH public key");const n=k(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH public key");const i=k(e,e._pos);if(i===undefined)return new Error("Malformed OpenSSH public key");const o=k(e,e._pos);if(o===undefined)return new Error("Malformed OpenSSH public key");f=genOpenSSLDSAPub(t,n,i,o);u=genOpenSSHDSAPub(t,n,i,o);s="sha1";break}case"ssh-ed25519":{const t=k(e,e._pos||0);if(t===undefined||t.length!==32)return new Error("Malformed OpenSSH public key");f=genOpenSSLEdPub(t);u=genOpenSSHEdPub(t);s=null;break}case"ecdsa-sha2-nistp256":s="sha256";o="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":if(s===undefined){s="sha384";o="1.3.132.0.34"}case"ecdsa-sha2-nistp521":{if(s===undefined){s="sha512";o="1.3.132.0.35"}if(!skipFields(e,1))return new Error("Malformed OpenSSH public key");const t=k(e,e._pos||0);if(t===undefined)return new Error("Malformed OpenSSH public key");f=genOpenSSLECDSAPub(o,t);u=genOpenSSHECDSAPub(o,t);break}default:return new Error(`Unsupported OpenSSH public key type: ${t}`)}return new OpenSSH_Public(i,n,f,u,s)}function isSupportedKeyType(e){switch(e){case"ssh-rsa":case"ssh-dss":case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":return true;case"ssh-ed25519":if(w)return true;default:return false}}function isParsedKey(e){if(!e)return false;return typeof e[U]==="boolean"}function parseKey(e,t){if(isParsedKey(e))return e;let n;if(Buffer.isBuffer(e)){n=e;e=e.utf8Slice(0,e.length).trim()}else if(typeof e==="string"){e=e.trim()}else{return new Error("Key data must be a Buffer or string")}if(t!=undefined){if(typeof t==="string")t=Buffer.from(t);else if(!Buffer.isBuffer(t))return new Error("Passphrase must be a string or Buffer when supplied")}let i;if((i=OpenSSH_Private.parse(e,t))!==null)return i;if((i=OpenSSH_Old_Private.parse(e,t))!==null)return i;if((i=PPK_Private.parse(e,t))!==null)return i;if((i=OpenSSH_Public.parse(e))!==null)return i;if((i=RFC4716_Public.parse(e))!==null)return i;if(n){x.init(n,0);const t=x.readString(true);if(t!==undefined){e=x.readRaw();if(e!==undefined){i=parseDER(e,t,"",t);if(i instanceof Error)i=null}}x.clear()}if(i)return i;return new Error("Unsupported key format")}e.exports={isParsedKey:isParsedKey,isSupportedKeyType:isSupportedKeyType,parseDERKey:(e,t)=>parseDER(e,t,"",t),parseKey:parseKey}},7609:(e,t,n)=>{"use strict";const i=n(9491);const{inspect:s}=n(3837);function addNumericalSeparator(e){let t="";let n=e.length;const i=e[0]==="-"?1:0;for(;n>=i+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function oneOf(e,t){i(typeof t==="string","`thing` has to be of type string");if(Array.isArray(e)){const n=e.length;i(n>0,"At least one expected value needs to be specified");e=e.map((e=>String(e)));if(n>2){return`one of ${t} ${e.slice(0,n-1).join(", ")}, or `+e[n-1]}else if(n===2){return`one of ${t} ${e[0]} or ${e[1]}`}return`of ${t} ${e[0]}`}return`of ${t} ${String(e)}`}t.ERR_INTERNAL_ASSERTION=class ERR_INTERNAL_ASSERTION extends Error{constructor(e){super();Error.captureStackTrace(this,ERR_INTERNAL_ASSERTION);const t="This is caused by either a bug in ssh2 "+"or incorrect usage of ssh2 internals.\n"+"Please open an issue with this stack trace at "+"https://github.com/mscdex/ssh2/issues\n";this.message=e===undefined?t:`${e}\n${t}`}};const o=2**32;const f=(()=>{try{return new Function("return 2n ** 32n")()}catch{}})();t.ERR_OUT_OF_RANGE=class ERR_OUT_OF_RANGE extends RangeError{constructor(e,t,n,u){super();Error.captureStackTrace(this,ERR_OUT_OF_RANGE);i(t,'Missing "range" argument');let l=u?e:`The value of "${e}" is out of range.`;let h;if(Number.isInteger(n)&&Math.abs(n)>o){h=addNumericalSeparator(String(n))}else if(typeof n==="bigint"){h=String(n);if(n>f||n<-f)h=addNumericalSeparator(h);h+="n"}else{h=s(n)}l+=` It must be ${t}. Received ${h}`;this.message=l}};class ERR_INVALID_ARG_TYPE extends TypeError{constructor(e,t,n){super();Error.captureStackTrace(this,ERR_INVALID_ARG_TYPE);i(typeof e==="string",`'name' must be a string`);let s;if(typeof t==="string"&&t.startsWith("not ")){s="must not be";t=t.replace(/^not /,"")}else{s="must be"}let o;if(e.endsWith(" argument")){o=`The ${e} ${s} ${oneOf(t,"type")}`}else{const n=e.includes(".")?"property":"argument";o=`The "${e}" ${n} ${s} ${oneOf(t,"type")}`}o+=`. Received type ${typeof n}`;this.message=o}}t.ERR_INVALID_ARG_TYPE=ERR_INVALID_ARG_TYPE;t.validateNumber=function validateNumber(e,t){if(typeof e!=="number")throw new ERR_INVALID_ARG_TYPE(t,"number",e)}},9475:(e,t,n)=>{"use strict";const i=n(970).Ber;let s;const o=Buffer[Symbol.species];const f=Object.getPrototypeOf(Uint8Array.prototype).fill;function readUInt32BE(e,t){return e[t++]*16777216+e[t++]*65536+e[t++]*256+e[t]}function bufferCopy(e,t,n,i,s){if(!s)s=0;if(i>e.length)i=e.length;let o=i-n;const f=t.length-s;if(o>f)o=f;t.set(new Uint8Array(e.buffer,e.byteOffset+n,o),s);return o}function bufferSlice(e,t,n){if(n===undefined)n=e.length;return new o(e.buffer,e.byteOffset+t,n-t)}function makeBufferParser(){let e=0;let t;const n={init:(n,i)=>{t=n;e=typeof i==="number"?i:0},pos:()=>e,length:()=>t?t.length:0,avail:()=>t&&e<t.length?t.length-e:0,clear:()=>{t=undefined},readUInt32BE:()=>{if(!t||e+3>=t.length)return;return t[e++]*16777216+t[e++]*65536+t[e++]*256+t[e++]},readUInt64BE:n=>{if(!t||e+7>=t.length)return;switch(n){case"always":return BigInt(`0x${t.hexSlice(e,e+=8)}`);case"maybe":if(t[e]>31)return BigInt(`0x${t.hexSlice(e,e+=8)}`);default:return t[e++]*72057594037927940+t[e++]*281474976710656+t[e++]*1099511627776+t[e++]*4294967296+t[e++]*16777216+t[e++]*65536+t[e++]*256+t[e++]}},skip:n=>{if(t&&n>0)e+=n},skipString:()=>{const i=n.readUInt32BE();if(i===undefined)return;e+=i;return e<=t.length?i:undefined},readByte:()=>{if(t&&e<t.length)return t[e++]},readBool:()=>{if(t&&e<t.length)return!!t[e++]},readList:()=>{const e=n.readString(true);if(e===undefined)return;return e?e.split(","):[]},readString:(i,s)=>{if(typeof i==="number"){s=i;i=undefined}const o=n.readUInt32BE();if(o===undefined)return;if(t.length-e<o||typeof s==="number"&&o>s){return}if(i){if(Buffer.isBuffer(i))return bufferCopy(t,i,e,e+=o);return t.utf8Slice(e,e+=o)}return bufferSlice(t,e,e+=o)},readRaw:n=>{if(!t)return;if(typeof n!=="number")return bufferSlice(t,e,e+=t.length-e);if(t.length-e>=n)return bufferSlice(t,e,e+=n)}};return n}function makeError(e,t,n){const i=new Error(e);if(typeof t==="boolean"){n=t;i.level="protocol"}else{i.level=t||"protocol"}i.fatal=!!n;return i}function writeUInt32BE(e,t,n){e[n++]=t>>>24;e[n++]=t>>>16;e[n++]=t>>>8;e[n++]=t;return n}const u=makeBufferParser();e.exports={bufferCopy:bufferCopy,bufferSlice:bufferSlice,FastBuffer:o,bufferFill:(e,t,n,i)=>f.call(e,t,n,i),makeError:makeError,doFatalError:(e,t,i,o)=>{let f;if(s===undefined)({DISCONNECT_REASON:s}=n(6832));if(t instanceof Error){f=t;if(typeof i!=="number")o=s.PROTOCOL_ERROR;else o=i}else{f=makeError(t,i,true)}if(typeof o!=="number")o=s.PROTOCOL_ERROR;e.disconnect(o);e._destruct();e._onError(f);return Infinity},readUInt32BE:readUInt32BE,writeUInt32BE:writeUInt32BE,writeUInt32LE:(e,t,n)=>{e[n++]=t;e[n++]=t>>>8;e[n++]=t>>>16;e[n++]=t>>>24;return n},makeBufferParser:makeBufferParser,bufferParser:makeBufferParser(),readString:(e,t,n,i)=>{if(typeof n==="number"){i=n;n=undefined}if(t===undefined)t=0;const s=e.length-t;if(t<0||t>=e.length||s<4)return;const o=readUInt32BE(e,t);if(s<4+o||typeof i==="number"&&o>i)return;t+=4;const f=t+o;e._pos=f;if(n){if(Buffer.isBuffer(n))return bufferCopy(e,n,t,f);return e.utf8Slice(t,f)}return bufferSlice(e,t,f)},sigSSHToASN1:(e,t)=>{switch(t){case"ssh-dss":{if(e.length>40)return e;const t=new i.Writer;t.startSequence();let n=e.slice(0,20);let s=e.slice(20);if(n[0]&128){const e=Buffer.allocUnsafe(21);e[0]=0;n.copy(e,1);n=e}else if(n[0]===0&&!(n[1]&128)){n=n.slice(1)}if(s[0]&128){const e=Buffer.allocUnsafe(21);e[0]=0;s.copy(e,1);s=e}else if(s[0]===0&&!(s[1]&128)){s=s.slice(1)}t.writeBuffer(n,i.Integer);t.writeBuffer(s,i.Integer);t.endSequence();return t.buffer}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{u.init(e,0);const t=u.readString();const n=u.readString();u.clear();if(t===undefined||n===undefined)return;const s=new i.Writer;s.startSequence();s.writeBuffer(t,i.Integer);s.writeBuffer(n,i.Integer);s.endSequence();return s.buffer}default:return e}},convertSignature:(e,t)=>{switch(t){case"ssh-dss":{if(e.length<=40)return e;const t=new i.Reader(e);t.readSequence();let n=t.readString(i.Integer,true);let s=t.readString(i.Integer,true);let o=0;let f=0;if(n.length<20){const e=Buffer.allocUnsafe(20);e.set(n,1);n=e;n[0]=0}if(s.length<20){const e=Buffer.allocUnsafe(20);e.set(s,1);s=e;s[0]=0}if(n.length>20&&n[0]===0)o=1;if(s.length>20&&s[0]===0)f=1;const u=Buffer.allocUnsafe(n.length-o+(s.length-f));bufferCopy(n,u,o,n.length,0);bufferCopy(s,u,f,s.length,n.length-o);return u}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{if(e[0]===0)return e;const t=new i.Reader(e);t.readSequence();const n=t.readString(i.Integer,true);const s=t.readString(i.Integer,true);if(n===null||s===null)return;const o=Buffer.allocUnsafe(4+n.length+4+s.length);writeUInt32BE(o,n.length,0);o.set(n,4);writeUInt32BE(o,s.length,4+n.length);o.set(s,4+4+n.length);return o}}return e},sendPacket:(e,t,n)=>{if(!n&&e._kexinit!==undefined){if(e._queue===undefined)e._queue=[];e._queue.push(t);e._debug&&e._debug("Outbound: ... packet queued");return false}e._cipher.encrypt(t);return true}}},6715:(e,t,n)=>{"use strict";const{kMaxLength:i}=n(4300);const{createInflate:s,constants:{DEFLATE:o,INFLATE:f,Z_DEFAULT_CHUNK:u,Z_DEFAULT_COMPRESSION:l,Z_DEFAULT_MEMLEVEL:h,Z_DEFAULT_STRATEGY:p,Z_DEFAULT_WINDOWBITS:g,Z_PARTIAL_FLUSH:_}}=n(9796);const E=s()._handle.constructor;function processCallback(){throw new Error("Should not get here")}function zlibOnError(e,t,n){const i=this._owner;const s=new Error(e);s.errno=t;s.code=n;i._err=s}function _close(e){if(!e._handle)return;e._handle.close();e._handle=null}class Zlib{constructor(e){const t=g;const n=l;const s=h;const o=p;const f=undefined;this._err=undefined;this._writeState=new Uint32Array(2);this._chunkSize=u;this._maxOutputLength=i;this._outBuffer=Buffer.allocUnsafe(this._chunkSize);this._outOffset=0;this._handle=new E(e);this._handle._owner=this;this._handle.onerror=zlibOnError;this._handle.init(t,n,s,o,this._writeState,processCallback,f)}writeSync(e,t){const n=this._handle;if(!n)throw new Error("Invalid Zlib instance");let i=e.length;let s=this._chunkSize-this._outOffset;let o=0;let f;let u;let l;let h=0;const p=this._writeState;let g=this._outBuffer;let E=this._outOffset;const y=this._chunkSize;while(true){n.writeSync(_,e,o,i,g,E,s);if(this._err)throw this._err;f=p[0];u=p[1];const t=i-u;const b=s-f;if(b>0){const e=E===0&&b===g.length?g:g.slice(E,E+b);E+=b;if(!l)l=e;else if(l.push===undefined)l=[l,e];else l.push(e);h+=e.byteLength;if(h>this._maxOutputLength){_close(this);throw new Error(`Output length exceeded maximum of ${this._maxOutputLength}`)}}else if(b!==0){throw new Error("have should not go down")}if(f===0||E>=y){s=y;E=0;g=Buffer.allocUnsafe(y)}if(f===0){o+=t;i=u}else{break}}this._outBuffer=g;this._outOffset=E;if(h===0)l=Buffer.alloc(0);if(t){l.totalLen=h;return l}if(l.push===undefined)return l;const b=Buffer.allocUnsafe(h);for(let e=0,t=0;e<l.length;++e){const n=l[e];b.set(n,t);t+=n.length}return b}}class ZlibPacketWriter{constructor(e){this.allocStart=0;this.allocStartKEX=0;this._protocol=e;this._zlib=new Zlib(o)}cleanup(){if(this._zlib)_close(this._zlib)}alloc(e,t){return Buffer.allocUnsafe(e)}finalize(e,t){if(this._protocol._kexinit===undefined||t){const t=this._zlib.writeSync(e,true);const n=this._protocol._cipher.allocPacket(t.totalLen);if(t.push===undefined){n.set(t,5)}else{for(let e=0,i=5;e<t.length;++e){const s=t[e];n.set(s,i);i+=s.length}}return n}return e}}class PacketWriter{constructor(e){this.allocStart=5;this.allocStartKEX=5;this._protocol=e}cleanup(){}alloc(e,t){if(this._protocol._kexinit===undefined||t)return this._protocol._cipher.allocPacket(e);return Buffer.allocUnsafe(e)}finalize(e,t){return e}}class ZlibPacketReader{constructor(){this._zlib=new Zlib(f)}cleanup(){if(this._zlib)_close(this._zlib)}read(e){return this._zlib.writeSync(e,false)}}class PacketReader{cleanup(){}read(e){return e}}e.exports={PacketReader:PacketReader,PacketWriter:PacketWriter,ZlibPacketReader:ZlibPacketReader,ZlibPacketWriter:ZlibPacketWriter}},2986:(e,t,n)=>{"use strict";const{Server:i}=n(1808);const s=n(2361);const{listenerCount:o}=s;const{CHANNEL_OPEN_FAILURE:f,DEFAULT_CIPHER:u,DEFAULT_COMPRESSION:l,DEFAULT_KEX:h,DEFAULT_MAC:p,DEFAULT_SERVER_HOST_KEY:g,DISCONNECT_REASON:_,DISCONNECT_REASON_BY_VALUE:E,SUPPORTED_CIPHER:y,SUPPORTED_COMPRESSION:b,SUPPORTED_KEX:w,SUPPORTED_MAC:I,SUPPORTED_SERVER_HOST_KEY:C}=n(6832);const{init:v}=n(5708);const{KexInit:k}=n(4126);const{parseKey:R}=n(2218);const B=n(9031);const{SFTP:T}=n(2026);const{writeUInt32BE:O}=n(9475);const{Channel:P,MAX_WINDOW:L,PACKET_SIZE:U,windowAdjust:D,WINDOW_THRESHOLD:x}=n(3204);const{ChannelManager:Q,generateAlgorithmList:W,isWritable:$,onChannelOpenFailure:q,onCHANNEL_CLOSE:G}=n(834);const j=10;class AuthContext extends s{constructor(e,t,n,i,s){super();this.username=this.user=t;this.service=n;this.method=i;this._initialResponse=false;this._finalResponse=false;this._multistep=false;this._cbfinal=(e,t,n)=>{if(!this._finalResponse){this._finalResponse=true;s(this,e,t,n)}};this._protocol=e}accept(){this._cleanup&&this._cleanup();this._initialResponse=true;this._cbfinal(true)}reject(e,t){this._cleanup&&this._cleanup();this._initialResponse=true;this._cbfinal(false,e,t)}}class KeyboardAuthContext extends AuthContext{constructor(e,t,n,i,s,o){super(e,t,n,i,o);this._multistep=true;this._cb=undefined;this._onInfoResponse=e=>{const t=this._cb;if(t){this._cb=undefined;t(e)}};this.submethods=s;this.on("abort",(()=>{this._cb&&this._cb(new Error("Authentication request aborted"))}))}prompt(e,t,n,i){if(!Array.isArray(e))e=[e];if(typeof t==="function"){i=t;t=n=undefined}else if(typeof n==="function"){i=n;n=undefined}else if(typeof i!=="function"){i=undefined}for(let t=0;t<e.length;++t){if(typeof e[t]==="string"){e[t]={prompt:e[t],echo:true}}}this._cb=i;this._initialResponse=true;this._protocol.authInfoReq(t,n,e)}}class PKAuthContext extends AuthContext{constructor(e,t,n,i,s,o){super(e,t,n,i,o);this.key={algo:s.keyAlgo,data:s.key};this.signature=s.signature;this.blob=s.blob}accept(){if(!this.signature){this._initialResponse=true;this._protocol.authPKOK(this.key.algo,this.key.data)}else{AuthContext.prototype.accept.call(this)}}}class HostbasedAuthContext extends AuthContext{constructor(e,t,n,i,s,o){super(e,t,n,i,o);this.key={algo:s.keyAlgo,data:s.key};this.signature=s.signature;this.blob=s.blob;this.localHostname=s.localHostname;this.localUsername=s.localUsername}}class PwdAuthContext extends AuthContext{constructor(e,t,n,i,s,o){super(e,t,n,i,o);this.password=s;this._changeCb=undefined}requestChange(e,t){if(this._changeCb)throw new Error("Change request already in progress");if(typeof e!=="string")throw new Error("prompt argument must be a string");if(typeof t!=="function")throw new Error("Callback argument must be a function");this._changeCb=t;this._protocol.authPasswdChg(e)}}class Session extends s{constructor(e,t,n){super();this.type="session";this.subtype=undefined;this.server=true;this._ending=false;this._channel=undefined;this._chanInfo={type:"session",incoming:{id:n,window:L,packetSize:U,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}}}}class Server extends s{constructor(e,t){super();if(typeof e!=="object"||e===null)throw new Error("Missing configuration object");const n=Object.create(null);const s=[];const o=e.hostKeys;if(!Array.isArray(o))throw new Error("hostKeys must be an array");const f=typeof e.algorithms==="object"&&e.algorithms!==null?e.algorithms:{};const _=W(f.serverHostKey,g,C);for(let e=0;e<o.length;++e){let t;if(Buffer.isBuffer(o[e])||typeof o[e]==="string")t=R(o[e]);else t=R(o[e].key,o[e].passphrase);if(t instanceof Error)throw new Error(`Cannot parse privateKey: ${t.message}`);if(Array.isArray(t)){t=t[0]}if(t.getPrivatePEM()===null)throw new Error("privateKey value contains an invalid private key");if(s.includes(t.type))continue;if(t.type==="ssh-rsa"){let e=_.indexOf("ssh-rsa");const i=_.indexOf("rsa-sha2-256");const o=_.indexOf("rsa-sha2-512");if(e===-1){e=Infinity}[e,i,o].sort(compareNumbers).forEach((f=>{if(f===-1)return;let u;switch(f){case e:u="ssh-rsa";break;case i:u="rsa-sha2-256";break;case o:u="rsa-sha2-512";break;default:return}n[u]=t;s.push(u)}))}else{n[t.type]=t;s.push(t.type)}}const E={kex:W(f.kex,h,w),serverHostKey:s,cs:{cipher:W(f.cipher,u,y),mac:W(f.hmac,p,I),compress:W(f.compress,l,b),lang:[]},sc:undefined};E.sc=E.cs;if(typeof t==="function")this.on("connection",t);const v=typeof e.debug==="function"?e.debug:undefined;const B=e.ident?Buffer.from(e.ident):undefined;const T=new k(E);this._srv=new i((t=>{if(this._connections>=this.maxConnections){t.destroy();return}++this._connections;t.once("close",(()=>{--this._connections}));let i;if(v){const e=`[${process.hrtime().join(".")}] `;i=t=>{v(`${e}${t}`)}}new Client(t,n,B,T,i,this,e)})).on("error",(e=>{this.emit("error",e)})).on("listening",(()=>{this.emit("listening")})).on("close",(()=>{this.emit("close")}));this._connections=0;this.maxConnections=Infinity}injectSocket(e){this._srv.emit("connection",e)}listen(...e){this._srv.listen(...e);return this}address(){return this._srv.address()}getConnections(e){this._srv.getConnections(e);return this}close(e){this._srv.close(e);return this}ref(){this._srv.ref();return this}unref(){this._srv.unref();return this}}Server.KEEPALIVE_CLIENT_INTERVAL=15e3;Server.KEEPALIVE_CLIENT_COUNT_MAX=3;class Client extends s{constructor(e,t,n,i,s,u,l){super();let h=0;let p=false;let g=[];let y;let b;let w;const I=[];this._sock=e;this._chanMgr=new Q(this);this._debug=s;this.noMoreSessions=false;this.authenticated=false;function onClientPreHeaderError(e){}this.on("error",onClientPreHeaderError);const C=!s?undefined:(e,t,n)=>{s(`Debug output from client: ${JSON.stringify(n)}`)};const k=typeof l.keepaliveInterval==="number"&&isFinite(l.keepaliveInterval)&&l.keepaliveInterval>0?l.keepaliveInterval:typeof Server.KEEPALIVE_CLIENT_INTERVAL==="number"&&isFinite(Server.KEEPALIVE_CLIENT_INTERVAL)&&Server.KEEPALIVE_CLIENT_INTERVAL>0?Server.KEEPALIVE_CLIENT_INTERVAL:-1;const R=typeof l.keepaliveCountMax==="number"&&isFinite(l.keepaliveCountMax)&&l.keepaliveCountMax>=0?l.keepaliveCountMax:typeof Server.KEEPALIVE_CLIENT_COUNT_MAX==="number"&&isFinite(Server.KEEPALIVE_CLIENT_COUNT_MAX)&&Server.KEEPALIVE_CLIENT_COUNT_MAX>=0?Server.KEEPALIVE_CLIENT_COUNT_MAX:-1;let W=0;if(k!==-1&&R!==-1){this.once("ready",(()=>{const onClose=()=>{clearInterval(b)};this.on("close",onClose).on("end",onClose);b=setInterval((()=>{if(++W>R){clearInterval(b);const e=new Error("Keepalive timeout");e.level="client-timeout";this.emit("error",e);this.end()}else{Y.ping()}}),k)}));w=()=>{b&&b.refresh();W=0}}const Y=this._protocol=new B({server:true,hostKeys:t,ident:n,offer:i,onPacket:w,greeting:l.greeting,banner:l.banner,onWrite:t=>{if($(e))e.write(t)},onError:t=>{if(!Y._destruct)e.removeAllListeners("data");this.emit("error",t);try{e.end()}catch{}},onHeader:t=>{this.removeListener("error",onClientPreHeaderError);const n={ip:e.remoteAddress,family:e.remoteFamily,port:e.remotePort,header:t};if(!u.emit("connection",this,n)){Y.disconnect(_.BY_APPLICATION);e.end();return}if(t.greeting)this.emit("greeting",t.greeting)},onHandshakeComplete:e=>{if(++h>1)this.emit("rekey");this.emit("handshake",e)},debug:s,messageHandlers:{DEBUG:C,DISCONNECT:(t,n,i)=>{if(n!==_.BY_APPLICATION){if(!i){i=E[n];if(i===undefined)i=`Unexpected disconnection reason: ${n}`}const e=new Error(i);e.code=n;this.emit("error",e)}e.end()},CHANNEL_OPEN:(e,t)=>{if(t.type==="session"&&this.noMoreSessions||!this.authenticated){const e=f.ADMINISTRATIVELY_PROHIBITED;return Y.channelOpenFail(t.sender,e)}let n=-1;let i;let u=false;let l;const reject=()=>{if(u)return;u=true;if(i===undefined){if(n===-1)i=f.RESOURCE_SHORTAGE;else i=f.CONNECT_FAILED}if(n!==-1)this._chanMgr.remove(n);Y.channelOpenFail(t.sender,i,"")};const reserveChannel=()=>{n=this._chanMgr.add();if(n===-1){i=f.RESOURCE_SHORTAGE;if(s){s("Automatic rejection of incoming channel open: "+"no channels available")}}return n!==-1};const h=t.data;switch(t.type){case"session":if(o(this,"session")&&reserveChannel()){l=()=>{if(u)return;u=true;const e=new Session(this,t,n);this._chanMgr.update(n,e);Y.channelOpenConfirm(t.sender,n,L,U);return e};this.emit("session",l,reject);return}break;case"direct-tcpip":if(o(this,"tcpip")&&reserveChannel()){l=()=>{if(u)return;u=true;const e={type:undefined,incoming:{id:n,window:L,packetSize:U,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const i=new P(this,e,{server:true});this._chanMgr.update(n,i);Y.channelOpenConfirm(t.sender,n,L,U);return i};this.emit("tcpip",l,reject,h);return}break;case"direct-streamlocal@openssh.com":if(o(this,"openssh.streamlocal")&&reserveChannel()){l=()=>{if(u)return;u=true;const e={type:undefined,incoming:{id:n,window:L,packetSize:U,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const i=new P(this,e,{server:true});this._chanMgr.update(n,i);Y.channelOpenConfirm(t.sender,n,L,U);return i};this.emit("openssh.streamlocal",l,reject,h);return}break;default:i=f.UNKNOWN_CHANNEL_TYPE;if(s){s("Automatic rejection of unsupported incoming channel open"+` type: ${t.type}`)}}if(i===undefined){i=f.ADMINISTRATIVELY_PROHIBITED;if(s){s("Automatic rejection of unexpected incoming channel open"+` for: ${t.type}`)}}reject()},CHANNEL_OPEN_CONFIRMATION:(e,t)=>{const n=this._chanMgr.get(t.recipient);if(typeof n!=="function")return;const i={type:n.type,incoming:{id:t.recipient,window:L,packetSize:U,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const s=new P(this,i,{server:true});this._chanMgr.update(t.recipient,s);n(undefined,s)},CHANNEL_OPEN_FAILURE:(e,t,n,i)=>{const s=this._chanMgr.get(t);if(typeof s!=="function")return;const o={reason:n,description:i};q(this,t,o,s)},CHANNEL_DATA:(e,t,n)=>{let i=this._chanMgr.get(t);if(typeof i!=="object"||i===null)return;if(i.constructor===Session){i=i._channel;if(!i)return}if(i.incoming.window===0)return;i.incoming.window-=n.length;if(i.push(n)===false){i._waitChanDrain=true;return}if(i.incoming.window<=x)D(i)},CHANNEL_EXTENDED_DATA:(e,t,n,i)=>{},CHANNEL_WINDOW_ADJUST:(e,t,n)=>{let i=this._chanMgr.get(t);if(typeof i!=="object"||i===null)return;if(i.constructor===Session){i=i._channel;if(!i)return}i.outgoing.window+=n;if(i._waitWindow){i._waitWindow=false;if(i._chunk){i._write(i._chunk,null,i._chunkcb)}else if(i._chunkcb){i._chunkcb()}else if(i._chunkErr){i.stderr._write(i._chunkErr,null,i._chunkcbErr)}else if(i._chunkcbErr){i._chunkcbErr()}}},CHANNEL_SUCCESS:(e,t)=>{let n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){n=n._channel;if(!n)return}if(n._callbacks.length)n._callbacks.shift()(false)},CHANNEL_FAILURE:(e,t)=>{let n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){n=n._channel;if(!n)return}if(n._callbacks.length)n._callbacks.shift()(true)},CHANNEL_REQUEST:(e,t,n,i,f)=>{const u=this._chanMgr.get(t);if(typeof u!=="object"||u===null)return;let l=false;let h;let p;if(u.constructor!==Session){if(i)Y.channelFailure(u.outgoing.id);return}if(i){if(n!=="shell"&&n!=="exec"&&n!=="subsystem"){h=()=>{if(l||u._ending||u._channel)return;l=true;Y.channelSuccess(u._chanInfo.outgoing.id)}}p=()=>{if(l||u._ending||u._channel)return;l=true;Y.channelFailure(u._chanInfo.outgoing.id)}}if(u._ending){p&&p();return}switch(n){case"env":if(o(u,"env")){u.emit("env",h,p,{key:f.name,val:f.value});return}break;case"pty-req":if(o(u,"pty")){u.emit("pty",h,p,f);return}break;case"window-change":if(o(u,"window-change"))u.emit("window-change",h,p,f);else p&&p();break;case"x11-req":if(o(u,"x11")){u.emit("x11",h,p,f);return}break;case"signal":if(o(u,"signal")){u.emit("signal",h,p,{name:f});return}break;case"auth-agent-req@openssh.com":if(o(u,"auth-agent")){u.emit("auth-agent",h,p);return}break;case"shell":if(o(u,"shell")){h=()=>{if(l||u._ending||u._channel)return;l=true;if(i)Y.channelSuccess(u._chanInfo.outgoing.id);const e=new P(this,u._chanInfo,{server:true});e.subtype=u.subtype=n;u._channel=e;return e};u.emit("shell",h,p);return}break;case"exec":if(o(u,"exec")){h=()=>{if(l||u._ending||u._channel)return;l=true;if(i)Y.channelSuccess(u._chanInfo.outgoing.id);const e=new P(this,u._chanInfo,{server:true});e.subtype=u.subtype=n;u._channel=e;return e};u.emit("exec",h,p,{command:f});return}break;case"subsystem":{let e=f==="sftp";h=()=>{if(l||u._ending||u._channel)return;l=true;if(i)Y.channelSuccess(u._chanInfo.outgoing.id);let t;if(e){t=new T(this,u._chanInfo,{server:true,debug:s})}else{t=new P(this,u._chanInfo,{server:true});t.subtype=u.subtype=`${n}:${f}`}u._channel=t;return t};if(f==="sftp"){if(o(u,"sftp")){u.emit("sftp",h,p);return}e=false}if(o(u,"subsystem")){u.emit("subsystem",h,p,{name:f});return}break}}s&&s(`Automatic rejection of incoming channel request: ${n}`);p&&p()},CHANNEL_EOF:(e,t)=>{let n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){if(!n._ending){n._ending=true;n.emit("eof");n.emit("end")}n=n._channel;if(!n)return}if(n.incoming.state!=="open")return;n.incoming.state="eof";if(n.readable)n.push(null)},CHANNEL_CLOSE:(e,t)=>{let n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){n._ending=true;n.emit("close");n=n._channel;if(!n)return}G(this,t,n)},SERVICE_REQUEST:(t,n)=>{if(h===0||p||this.authenticated||n!=="ssh-userauth"){Y.disconnect(_.SERVICE_NOT_AVAILABLE);e.end();return}p=true;Y.serviceAccept(n)},USERAUTH_REQUEST:(t,n,i,s,f)=>{if(h===0||this.authenticated||y&&(y.username!==n||y.service!==i)||s!=="password"&&s!=="publickey"&&s!=="hostbased"&&s!=="keyboard-interactive"&&s!=="none"||g.length===j){Y.disconnect(_.PROTOCOL_ERROR);e.end();return}else if(i!=="ssh-connection"){Y.disconnect(_.SERVICE_NOT_AVAILABLE);e.end();return}let u;switch(s){case"keyboard-interactive":u=new KeyboardAuthContext(Y,n,i,s,f,onAuthDecide);break;case"publickey":u=new PKAuthContext(Y,n,i,s,f,onAuthDecide);break;case"hostbased":u=new HostbasedAuthContext(Y,n,i,s,f,onAuthDecide);break;case"password":if(y&&y instanceof PwdAuthContext&&y._changeCb){const e=y._changeCb;y._changeCb=undefined;e(f.newPassword);return}u=new PwdAuthContext(Y,n,i,s,f,onAuthDecide);break;case"none":u=new AuthContext(Y,n,i,s,onAuthDecide);break}if(y){if(!y._initialResponse){return g.push(u)}else if(y._multistep&&!y._finalResponse){y._cleanup&&y._cleanup();y.emit("abort")}}y=u;if(o(this,"authentication"))this.emit("authentication",y);else y.reject()},USERAUTH_INFO_RESPONSE:(e,t)=>{if(y&&y instanceof KeyboardAuthContext)y._onInfoResponse(t)},GLOBAL_REQUEST:(e,t,n,i)=>{const s={type:null,buf:null};function setReply(e,t){s.type=e;s.buf=t;sendReplies()}if(n)I.push(s);if((t==="tcpip-forward"||t==="cancel-tcpip-forward"||t==="no-more-sessions@openssh.com"||t==="streamlocal-forward@openssh.com"||t==="cancel-streamlocal-forward@openssh.com")&&o(this,"request")&&this.authenticated){let e;let s;if(n){let n=false;e=e=>{if(n)return;n=true;let s;if(t==="tcpip-forward"&&i.bindPort===0&&typeof e==="number"){s=Buffer.allocUnsafe(4);O(s,e,0)}setReply("SUCCESS",s)};s=()=>{if(n)return;n=true;setReply("FAILURE")}}if(t==="no-more-sessions@openssh.com"){this.noMoreSessions=true;e&&e();return}this.emit("request",e,s,t,i)}else if(n){setReply("FAILURE")}}}});e.pause();v.then((()=>{Y.start();e.on("data",(t=>{try{Y.parse(t,0,t.length)}catch(t){this.emit("error",t);try{if($(e))e.end()}catch{}}}));e.resume()})).catch((t=>{this.emit("error",t);try{if($(e))e.end()}catch{}}));e.on("error",(e=>{e.level="socket";this.emit("error",e)})).once("end",(()=>{s&&s("Socket ended");Y.cleanup();this.emit("end")})).once("close",(()=>{s&&s("Socket closed");Y.cleanup();this.emit("close");const e=new Error("No response from server");this._chanMgr.cleanup(e)}));const onAuthDecide=(e,t,n,i)=>{if(y===e&&!this.authenticated){if(t){y=undefined;this.authenticated=true;Y.authSuccess();g=[];this.emit("ready")}else{Y.authFailure(n,i);if(g.length){y=g.pop();if(o(this,"authentication"))this.emit("authentication",y);else y.reject()}}}};function sendReplies(){while(I.length>0&&I[0].type){const e=I.shift();if(e.type==="SUCCESS")Y.requestSuccess(e.buf);if(e.type==="FAILURE")Y.requestFailure()}}}end(){if(this._sock&&$(this._sock)){this._protocol.disconnect(_.BY_APPLICATION);this._sock.end()}return this}x11(e,t,n){const i={originAddr:e,originPort:t};openChannel(this,"x11",i,n);return this}forwardOut(e,t,n,i,s){const o={boundAddr:e,boundPort:t,remoteAddr:n,remotePort:i};openChannel(this,"forwarded-tcpip",o,s);return this}openssh_forwardOutStreamLocal(e,t){const n={socketPath:e};openChannel(this,"forwarded-streamlocal@openssh.com",n,t);return this}rekey(e){let t;try{this._protocol.rekey()}catch(e){t=e}if(typeof e==="function"){if(t)process.nextTick(e,t);else this.once("rekey",e)}}}function openChannel(e,t,n,i){const s=L;const o=U;if(typeof n==="function"){i=n;n={}}const wrapper=(e,t)=>{i(e,t)};wrapper.type=t;const f=e._chanMgr.add(wrapper);if(f===-1){i(new Error("No free channels available"));return}switch(t){case"forwarded-tcpip":e._protocol.forwardedTcpip(f,s,o,n);break;case"x11":e._protocol.x11(f,s,o,n);break;case"forwarded-streamlocal@openssh.com":e._protocol.openssh_forwardedStreamLocal(f,s,o,n);break;default:throw new Error(`Unsupported channel type: ${t}`)}}function compareNumbers(e,t){return e-t}e.exports=Server;e.exports.IncomingClient=Client},834:(e,t,n)=>{"use strict";const{SFTP:i}=n(2026);const s=2**32-1;function onChannelOpenFailure(e,t,n,i){e._chanMgr.remove(t);if(typeof i!=="function")return;let s;if(n instanceof Error){s=n}else if(typeof n==="object"&&n!==null){s=new Error(`(SSH) Channel open failure: ${n.description}`);s.reason=n.reason}else{s=new Error("(SSH) Channel open failure: server closed channel unexpectedly");s.reason=""}i(s)}function onCHANNEL_CLOSE(e,t,n,s,o){if(typeof n==="function"){onChannelOpenFailure(e,t,s,n);return}if(typeof n!=="object"||n===null)return;if(n.incoming&&n.incoming.state==="closed")return;e._chanMgr.remove(t);if(n.server&&n.constructor.name==="Session")return;n.incoming.state="closed";if(n.readable)n.push(null);if(n.server){if(n.stderr.writable)n.stderr.end()}else if(n.stderr.readable){n.stderr.push(null)}if(n.constructor!==i&&(n.outgoing.state==="open"||n.outgoing.state==="eof")&&!o){n.close()}if(n.outgoing.state==="closing")n.outgoing.state="closed";const f=n._readableState;const u=n._writableState;if(u&&!u.ending&&!u.finished&&!o)n.end();const l=n._callbacks;n._callbacks=[];for(let e=0;e<l.length;++e)l[e](true);if(n.server){if(!n.readable||n.destroyed||f&&f.endEmitted){n.emit("close")}else{n.once("end",(()=>n.emit("close")))}}else{let e;switch(n.type){case"direct-streamlocal@openssh.com":case"direct-tcpip":e=()=>n.emit("close");break;default:{const t=n._exit;e=()=>{if(t.code===null)n.emit("close",t.code,t.signal,t.dump,t.desc);else n.emit("close",t.code)}}}if(!n.readable||n.destroyed||f&&f.endEmitted){e()}else{n.once("end",e)}const t=n.stderr._readableState;if(!n.stderr.readable||n.stderr.destroyed||t&&t.endEmitted){n.stderr.emit("close")}else{n.stderr.once("end",(()=>n.stderr.emit("close")))}}}class ChannelManager{constructor(e){this._client=e;this._channels={};this._cur=-1;this._count=0}add(e){let t;if(this._cur<s){t=++this._cur}else if(this._count===0){this._cur=0;t=0}else{const e=this._channels;for(let n=0;n<s;++n){if(e[n]===undefined){t=n;break}}}if(t===undefined)return-1;this._channels[t]=e||true;++this._count;return t}update(e,t){if(typeof e!=="number"||e<0||e>=s||!isFinite(e))throw new Error(`Invalid channel id: ${e}`);if(t&&this._channels[e])this._channels[e]=t}get(e){if(typeof e!=="number"||e<0||e>=s||!isFinite(e))throw new Error(`Invalid channel id: ${e}`);return this._channels[e]}remove(e){if(typeof e!=="number"||e<0||e>=s||!isFinite(e))throw new Error(`Invalid channel id: ${e}`);if(this._channels[e]){delete this._channels[e];if(this._count)--this._count}}cleanup(e){const t=this._channels;this._channels={};this._cur=-1;this._count=0;const n=Object.keys(t);const i=this._client;for(let s=0;s<n.length;++s){const o=+n[s];const f=t[o];onCHANNEL_CLOSE(i,o,f._channel||f,e,true)}}}const o=(()=>{const e=Object.prototype.toString;return t=>e.call(t)==="[object RegExp]"})();function generateAlgorithmList(e,t,n){if(Array.isArray(e)&&e.length>0){for(let t=0;t<e.length;++t){if(n.indexOf(e[t])===-1)throw new Error(`Unsupported algorithm: ${e[t]}`)}return e}if(typeof e==="object"&&e!==null){const i=Object.keys(e);let s=t;for(let f=0;f<i.length;++f){const u=i[f];let l=e[u];switch(u){case"append":if(!Array.isArray(l))l=[l];if(Array.isArray(l)){for(let e=0;e<l.length;++e){const i=l[e];if(typeof i==="string"){if(!i||s.indexOf(i)!==-1)continue;if(n.indexOf(i)===-1)throw new Error(`Unsupported algorithm: ${i}`);if(s===t)s=s.slice();s.push(i)}else if(o(i)){for(let e=0;e<n.length;++e){const o=n[e];if(i.test(o)){if(s.indexOf(o)!==-1)continue;if(s===t)s=s.slice();s.push(o)}}}}}break;case"prepend":if(!Array.isArray(l))l=[l];if(Array.isArray(l)){for(let e=l.length;e>=0;--e){const i=l[e];if(typeof i==="string"){if(!i||s.indexOf(i)!==-1)continue;if(n.indexOf(i)===-1)throw new Error(`Unsupported algorithm: ${i}`);if(s===t)s=s.slice();s.unshift(i)}else if(o(i)){for(let e=n.length;e>=0;--e){const o=n[e];if(i.test(o)){if(s.indexOf(o)!==-1)continue;if(s===t)s=s.slice();s.unshift(o)}}}}}break;case"remove":if(!Array.isArray(l))l=[l];if(Array.isArray(l)){for(let e=0;e<l.length;++e){const n=l[e];if(typeof n==="string"){if(!n)continue;const e=s.indexOf(n);if(e===-1)continue;if(s===t)s=s.slice();s.splice(e,1)}else if(o(n)){for(let e=0;e<s.length;++e){if(n.test(s[e])){if(s===t)s=s.slice();s.splice(e,1);--e}}}}}break}}return s}return t}e.exports={ChannelManager:ChannelManager,generateAlgorithmList:generateAlgorithmList,onChannelOpenFailure:onChannelOpenFailure,onCHANNEL_CLOSE:onCHANNEL_CLOSE,isWritable:e=>e&&e.writable&&e._readableState&&e._readableState.ended===false}},4841:(e,t,n)=>{"use strict";var i=n(1867).Buffer;var s=i.isEncoding||function(e){e=""+e;switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function _normalizeEncoding(e){if(!e)return"utf8";var t;while(true){switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase();t=true}}}function normalizeEncoding(e){var t=_normalizeEncoding(e);if(typeof t!=="string"&&(i.isEncoding===s||!s(e)))throw new Error("Unknown encoding: "+e);return t||e}t.s=StringDecoder;function StringDecoder(e){this.encoding=normalizeEncoding(e);var t;switch(this.encoding){case"utf16le":this.text=utf16Text;this.end=utf16End;t=4;break;case"utf8":this.fillLast=utf8FillLast;t=4;break;case"base64":this.text=base64Text;this.end=base64End;t=3;break;default:this.write=simpleWrite;this.end=simpleEnd;return}this.lastNeed=0;this.lastTotal=0;this.lastChar=i.allocUnsafe(t)}StringDecoder.prototype.write=function(e){if(e.length===0)return"";var t;var n;if(this.lastNeed){t=this.fillLast(e);if(t===undefined)return"";n=this.lastNeed;this.lastNeed=0}else{n=0}if(n<e.length)return t?t+this.text(e,n):this.text(e,n);return t||""};StringDecoder.prototype.end=utf8End;StringDecoder.prototype.text=utf8Text;StringDecoder.prototype.fillLast=function(e){if(this.lastNeed<=e.length){e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length);this.lastNeed-=e.length};function utf8CheckByte(e){if(e<=127)return 0;else if(e>>5===6)return 2;else if(e>>4===14)return 3;else if(e>>3===30)return 4;return e>>6===2?-1:-2}function utf8CheckIncomplete(e,t,n){var i=t.length-1;if(i<n)return 0;var s=utf8CheckByte(t[i]);if(s>=0){if(s>0)e.lastNeed=s-1;return s}if(--i<n||s===-2)return 0;s=utf8CheckByte(t[i]);if(s>=0){if(s>0)e.lastNeed=s-2;return s}if(--i<n||s===-2)return 0;s=utf8CheckByte(t[i]);if(s>=0){if(s>0){if(s===2)s=0;else e.lastNeed=s-3}return s}return 0}function utf8CheckExtraBytes(e,t,n){if((t[0]&192)!==128){e.lastNeed=0;return""}if(e.lastNeed>1&&t.length>1){if((t[1]&192)!==128){e.lastNeed=1;return""}if(e.lastNeed>2&&t.length>2){if((t[2]&192)!==128){e.lastNeed=2;return""}}}}function utf8FillLast(e){var t=this.lastTotal-this.lastNeed;var n=utf8CheckExtraBytes(this,e,t);if(n!==undefined)return n;if(this.lastNeed<=e.length){e.copy(this.lastChar,t,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}e.copy(this.lastChar,t,0,e.length);this.lastNeed-=e.length}function utf8Text(e,t){var n=utf8CheckIncomplete(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var i=e.length-(n-this.lastNeed);e.copy(this.lastChar,0,i);return e.toString("utf8",t,i)}function utf8End(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed)return t+"";return t}function utf16Text(e,t){if((e.length-t)%2===0){var n=e.toString("utf16le",t);if(n){var i=n.charCodeAt(n.length-1);if(i>=55296&&i<=56319){this.lastNeed=2;this.lastTotal=4;this.lastChar[0]=e[e.length-2];this.lastChar[1]=e[e.length-1];return n.slice(0,-1)}}return n}this.lastNeed=1;this.lastTotal=2;this.lastChar[0]=e[e.length-1];return e.toString("utf16le",t,e.length-1)}function utf16End(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function base64Text(e,t){var n=(e.length-t)%3;if(n===0)return e.toString("base64",t);this.lastNeed=3-n;this.lastTotal=3;if(n===1){this.lastChar[0]=e[e.length-1]}else{this.lastChar[0]=e[e.length-2];this.lastChar[1]=e[e.length-1]}return e.toString("base64",t,e.length-n)}function base64End(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed)return t+this.lastChar.toString("base64",0,3-this.lastNeed);return t}function simpleWrite(e){return e.toString(this.encoding)}function simpleEnd(e){return e&&e.length?this.write(e):""}},4294:(e,t,n)=>{e.exports=n(4219)},4219:(e,t,n)=>{"use strict";var i=n(1808);var s=n(4404);var o=n(3685);var f=n(5687);var u=n(2361);var l=n(9491);var h=n(3837);t.httpOverHttp=httpOverHttp;t.httpsOverHttp=httpsOverHttp;t.httpOverHttps=httpOverHttps;t.httpsOverHttps=httpsOverHttps;function httpOverHttp(e){var t=new TunnelingAgent(e);t.request=o.request;return t}function httpsOverHttp(e){var t=new TunnelingAgent(e);t.request=o.request;t.createSocket=createSecureSocket;t.defaultPort=443;return t}function httpOverHttps(e){var t=new TunnelingAgent(e);t.request=f.request;return t}function httpsOverHttps(e){var t=new TunnelingAgent(e);t.request=f.request;t.createSocket=createSecureSocket;t.defaultPort=443;return t}function TunnelingAgent(e){var t=this;t.options=e||{};t.proxyOptions=t.options.proxy||{};t.maxSockets=t.options.maxSockets||o.Agent.defaultMaxSockets;t.requests=[];t.sockets=[];t.on("free",(function onFree(e,n,i,s){var o=toOptions(n,i,s);for(var f=0,u=t.requests.length;f<u;++f){var l=t.requests[f];if(l.host===o.host&&l.port===o.port){t.requests.splice(f,1);l.request.onSocket(e);return}}e.destroy();t.removeSocket(e)}))}h.inherits(TunnelingAgent,u.EventEmitter);TunnelingAgent.prototype.addRequest=function addRequest(e,t,n,i){var s=this;var o=mergeOptions({request:e},s.options,toOptions(t,n,i));if(s.sockets.length>=this.maxSockets){s.requests.push(o);return}s.createSocket(o,(function(t){t.on("free",onFree);t.on("close",onCloseOrRemove);t.on("agentRemove",onCloseOrRemove);e.onSocket(t);function onFree(){s.emit("free",t,o)}function onCloseOrRemove(e){s.removeSocket(t);t.removeListener("free",onFree);t.removeListener("close",onCloseOrRemove);t.removeListener("agentRemove",onCloseOrRemove)}}))};TunnelingAgent.prototype.createSocket=function createSocket(e,t){var n=this;var i={};n.sockets.push(i);var s=mergeOptions({},n.proxyOptions,{method:"CONNECT",path:e.host+":"+e.port,agent:false,headers:{host:e.host+":"+e.port}});if(e.localAddress){s.localAddress=e.localAddress}if(s.proxyAuth){s.headers=s.headers||{};s.headers["Proxy-Authorization"]="Basic "+new Buffer(s.proxyAuth).toString("base64")}p("making CONNECT request");var o=n.request(s);o.useChunkedEncodingByDefault=false;o.once("response",onResponse);o.once("upgrade",onUpgrade);o.once("connect",onConnect);o.once("error",onError);o.end();function onResponse(e){e.upgrade=true}function onUpgrade(e,t,n){process.nextTick((function(){onConnect(e,t,n)}))}function onConnect(s,f,u){o.removeAllListeners();f.removeAllListeners();if(s.statusCode!==200){p("tunneling socket could not be established, statusCode=%d",s.statusCode);f.destroy();var l=new Error("tunneling socket could not be established, "+"statusCode="+s.statusCode);l.code="ECONNRESET";e.request.emit("error",l);n.removeSocket(i);return}if(u.length>0){p("got illegal response body from proxy");f.destroy();var l=new Error("got illegal response body from proxy");l.code="ECONNRESET";e.request.emit("error",l);n.removeSocket(i);return}p("tunneling connection has established");n.sockets[n.sockets.indexOf(i)]=f;return t(f)}function onError(t){o.removeAllListeners();p("tunneling socket could not be established, cause=%s\n",t.message,t.stack);var s=new Error("tunneling socket could not be established, "+"cause="+t.message);s.code="ECONNRESET";e.request.emit("error",s);n.removeSocket(i)}};TunnelingAgent.prototype.removeSocket=function removeSocket(e){var t=this.sockets.indexOf(e);if(t===-1){return}this.sockets.splice(t,1);var n=this.requests.shift();if(n){this.createSocket(n,(function(e){n.request.onSocket(e)}))}};function createSecureSocket(e,t){var n=this;TunnelingAgent.prototype.createSocket.call(n,e,(function(i){var o=e.request.getHeader("host");var f=mergeOptions({},n.options,{socket:i,servername:o?o.replace(/:.*$/,""):e.host});var u=s.connect(0,f);n.sockets[n.sockets.indexOf(i)]=u;t(u)}))}function toOptions(e,t,n){if(typeof e==="string"){return{host:e,port:t,localAddress:n}}return e}function mergeOptions(e){for(var t=1,n=arguments.length;t<n;++t){var i=arguments[t];if(typeof i==="object"){var s=Object.keys(i);for(var o=0,f=s.length;o<f;++o){var u=s[o];if(i[u]!==undefined){e[u]=i[u]}}}}return e}var p;if(process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)){p=function(){var e=Array.prototype.slice.call(arguments);if(typeof e[0]==="string"){e[0]="TUNNEL: "+e[0]}else{e.unshift("TUNNEL:")}console.error.apply(console,e)}}else{p=function(){}}t.debug=p},8729:(e,t,n)=>{(function(e){"use strict";var gf=function(e){var t,n=new Float64Array(16);if(e)for(t=0;t<e.length;t++)n[t]=e[t];return n};var randombytes=function(){throw new Error("no PRNG")};var t=new Uint8Array(16);var i=new Uint8Array(32);i[0]=9;var s=gf(),o=gf([1]),f=gf([56129,1]),u=gf([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),h=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),p=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),g=gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ts64(e,t,n,i){e[t]=n>>24&255;e[t+1]=n>>16&255;e[t+2]=n>>8&255;e[t+3]=n&255;e[t+4]=i>>24&255;e[t+5]=i>>16&255;e[t+6]=i>>8&255;e[t+7]=i&255}function vn(e,t,n,i,s){var o,f=0;for(o=0;o<s;o++)f|=e[t+o]^n[i+o];return(1&f-1>>>8)-1}function crypto_verify_16(e,t,n,i){return vn(e,t,n,i,16)}function crypto_verify_32(e,t,n,i){return vn(e,t,n,i,32)}function core_salsa20(e,t,n,i){var s=i[0]&255|(i[1]&255)<<8|(i[2]&255)<<16|(i[3]&255)<<24,o=n[0]&255|(n[1]&255)<<8|(n[2]&255)<<16|(n[3]&255)<<24,f=n[4]&255|(n[5]&255)<<8|(n[6]&255)<<16|(n[7]&255)<<24,u=n[8]&255|(n[9]&255)<<8|(n[10]&255)<<16|(n[11]&255)<<24,l=n[12]&255|(n[13]&255)<<8|(n[14]&255)<<16|(n[15]&255)<<24,h=i[4]&255|(i[5]&255)<<8|(i[6]&255)<<16|(i[7]&255)<<24,p=t[0]&255|(t[1]&255)<<8|(t[2]&255)<<16|(t[3]&255)<<24,g=t[4]&255|(t[5]&255)<<8|(t[6]&255)<<16|(t[7]&255)<<24,_=t[8]&255|(t[9]&255)<<8|(t[10]&255)<<16|(t[11]&255)<<24,E=t[12]&255|(t[13]&255)<<8|(t[14]&255)<<16|(t[15]&255)<<24,y=i[8]&255|(i[9]&255)<<8|(i[10]&255)<<16|(i[11]&255)<<24,b=n[16]&255|(n[17]&255)<<8|(n[18]&255)<<16|(n[19]&255)<<24,w=n[20]&255|(n[21]&255)<<8|(n[22]&255)<<16|(n[23]&255)<<24,I=n[24]&255|(n[25]&255)<<8|(n[26]&255)<<16|(n[27]&255)<<24,C=n[28]&255|(n[29]&255)<<8|(n[30]&255)<<16|(n[31]&255)<<24,v=i[12]&255|(i[13]&255)<<8|(i[14]&255)<<16|(i[15]&255)<<24;var k=s,R=o,B=f,T=u,O=l,P=h,L=p,U=g,D=_,x=E,Q=y,W=b,$=w,q=I,G=C,j=v,Y;for(var V=0;V<20;V+=2){Y=k+$|0;O^=Y<<7|Y>>>32-7;Y=O+k|0;D^=Y<<9|Y>>>32-9;Y=D+O|0;$^=Y<<13|Y>>>32-13;Y=$+D|0;k^=Y<<18|Y>>>32-18;Y=P+R|0;x^=Y<<7|Y>>>32-7;Y=x+P|0;q^=Y<<9|Y>>>32-9;Y=q+x|0;R^=Y<<13|Y>>>32-13;Y=R+q|0;P^=Y<<18|Y>>>32-18;Y=Q+L|0;G^=Y<<7|Y>>>32-7;Y=G+Q|0;B^=Y<<9|Y>>>32-9;Y=B+G|0;L^=Y<<13|Y>>>32-13;Y=L+B|0;Q^=Y<<18|Y>>>32-18;Y=j+W|0;T^=Y<<7|Y>>>32-7;Y=T+j|0;U^=Y<<9|Y>>>32-9;Y=U+T|0;W^=Y<<13|Y>>>32-13;Y=W+U|0;j^=Y<<18|Y>>>32-18;Y=k+T|0;R^=Y<<7|Y>>>32-7;Y=R+k|0;B^=Y<<9|Y>>>32-9;Y=B+R|0;T^=Y<<13|Y>>>32-13;Y=T+B|0;k^=Y<<18|Y>>>32-18;Y=P+O|0;L^=Y<<7|Y>>>32-7;Y=L+P|0;U^=Y<<9|Y>>>32-9;Y=U+L|0;O^=Y<<13|Y>>>32-13;Y=O+U|0;P^=Y<<18|Y>>>32-18;Y=Q+x|0;W^=Y<<7|Y>>>32-7;Y=W+Q|0;D^=Y<<9|Y>>>32-9;Y=D+W|0;x^=Y<<13|Y>>>32-13;Y=x+D|0;Q^=Y<<18|Y>>>32-18;Y=j+G|0;$^=Y<<7|Y>>>32-7;Y=$+j|0;q^=Y<<9|Y>>>32-9;Y=q+$|0;G^=Y<<13|Y>>>32-13;Y=G+q|0;j^=Y<<18|Y>>>32-18}k=k+s|0;R=R+o|0;B=B+f|0;T=T+u|0;O=O+l|0;P=P+h|0;L=L+p|0;U=U+g|0;D=D+_|0;x=x+E|0;Q=Q+y|0;W=W+b|0;$=$+w|0;q=q+I|0;G=G+C|0;j=j+v|0;e[0]=k>>>0&255;e[1]=k>>>8&255;e[2]=k>>>16&255;e[3]=k>>>24&255;e[4]=R>>>0&255;e[5]=R>>>8&255;e[6]=R>>>16&255;e[7]=R>>>24&255;e[8]=B>>>0&255;e[9]=B>>>8&255;e[10]=B>>>16&255;e[11]=B>>>24&255;e[12]=T>>>0&255;e[13]=T>>>8&255;e[14]=T>>>16&255;e[15]=T>>>24&255;e[16]=O>>>0&255;e[17]=O>>>8&255;e[18]=O>>>16&255;e[19]=O>>>24&255;e[20]=P>>>0&255;e[21]=P>>>8&255;e[22]=P>>>16&255;e[23]=P>>>24&255;e[24]=L>>>0&255;e[25]=L>>>8&255;e[26]=L>>>16&255;e[27]=L>>>24&255;e[28]=U>>>0&255;e[29]=U>>>8&255;e[30]=U>>>16&255;e[31]=U>>>24&255;e[32]=D>>>0&255;e[33]=D>>>8&255;e[34]=D>>>16&255;e[35]=D>>>24&255;e[36]=x>>>0&255;e[37]=x>>>8&255;e[38]=x>>>16&255;e[39]=x>>>24&255;e[40]=Q>>>0&255;e[41]=Q>>>8&255;e[42]=Q>>>16&255;e[43]=Q>>>24&255;e[44]=W>>>0&255;e[45]=W>>>8&255;e[46]=W>>>16&255;e[47]=W>>>24&255;e[48]=$>>>0&255;e[49]=$>>>8&255;e[50]=$>>>16&255;e[51]=$>>>24&255;e[52]=q>>>0&255;e[53]=q>>>8&255;e[54]=q>>>16&255;e[55]=q>>>24&255;e[56]=G>>>0&255;e[57]=G>>>8&255;e[58]=G>>>16&255;e[59]=G>>>24&255;e[60]=j>>>0&255;e[61]=j>>>8&255;e[62]=j>>>16&255;e[63]=j>>>24&255}function core_hsalsa20(e,t,n,i){var s=i[0]&255|(i[1]&255)<<8|(i[2]&255)<<16|(i[3]&255)<<24,o=n[0]&255|(n[1]&255)<<8|(n[2]&255)<<16|(n[3]&255)<<24,f=n[4]&255|(n[5]&255)<<8|(n[6]&255)<<16|(n[7]&255)<<24,u=n[8]&255|(n[9]&255)<<8|(n[10]&255)<<16|(n[11]&255)<<24,l=n[12]&255|(n[13]&255)<<8|(n[14]&255)<<16|(n[15]&255)<<24,h=i[4]&255|(i[5]&255)<<8|(i[6]&255)<<16|(i[7]&255)<<24,p=t[0]&255|(t[1]&255)<<8|(t[2]&255)<<16|(t[3]&255)<<24,g=t[4]&255|(t[5]&255)<<8|(t[6]&255)<<16|(t[7]&255)<<24,_=t[8]&255|(t[9]&255)<<8|(t[10]&255)<<16|(t[11]&255)<<24,E=t[12]&255|(t[13]&255)<<8|(t[14]&255)<<16|(t[15]&255)<<24,y=i[8]&255|(i[9]&255)<<8|(i[10]&255)<<16|(i[11]&255)<<24,b=n[16]&255|(n[17]&255)<<8|(n[18]&255)<<16|(n[19]&255)<<24,w=n[20]&255|(n[21]&255)<<8|(n[22]&255)<<16|(n[23]&255)<<24,I=n[24]&255|(n[25]&255)<<8|(n[26]&255)<<16|(n[27]&255)<<24,C=n[28]&255|(n[29]&255)<<8|(n[30]&255)<<16|(n[31]&255)<<24,v=i[12]&255|(i[13]&255)<<8|(i[14]&255)<<16|(i[15]&255)<<24;var k=s,R=o,B=f,T=u,O=l,P=h,L=p,U=g,D=_,x=E,Q=y,W=b,$=w,q=I,G=C,j=v,Y;for(var V=0;V<20;V+=2){Y=k+$|0;O^=Y<<7|Y>>>32-7;Y=O+k|0;D^=Y<<9|Y>>>32-9;Y=D+O|0;$^=Y<<13|Y>>>32-13;Y=$+D|0;k^=Y<<18|Y>>>32-18;Y=P+R|0;x^=Y<<7|Y>>>32-7;Y=x+P|0;q^=Y<<9|Y>>>32-9;Y=q+x|0;R^=Y<<13|Y>>>32-13;Y=R+q|0;P^=Y<<18|Y>>>32-18;Y=Q+L|0;G^=Y<<7|Y>>>32-7;Y=G+Q|0;B^=Y<<9|Y>>>32-9;Y=B+G|0;L^=Y<<13|Y>>>32-13;Y=L+B|0;Q^=Y<<18|Y>>>32-18;Y=j+W|0;T^=Y<<7|Y>>>32-7;Y=T+j|0;U^=Y<<9|Y>>>32-9;Y=U+T|0;W^=Y<<13|Y>>>32-13;Y=W+U|0;j^=Y<<18|Y>>>32-18;Y=k+T|0;R^=Y<<7|Y>>>32-7;Y=R+k|0;B^=Y<<9|Y>>>32-9;Y=B+R|0;T^=Y<<13|Y>>>32-13;Y=T+B|0;k^=Y<<18|Y>>>32-18;Y=P+O|0;L^=Y<<7|Y>>>32-7;Y=L+P|0;U^=Y<<9|Y>>>32-9;Y=U+L|0;O^=Y<<13|Y>>>32-13;Y=O+U|0;P^=Y<<18|Y>>>32-18;Y=Q+x|0;W^=Y<<7|Y>>>32-7;Y=W+Q|0;D^=Y<<9|Y>>>32-9;Y=D+W|0;x^=Y<<13|Y>>>32-13;Y=x+D|0;Q^=Y<<18|Y>>>32-18;Y=j+G|0;$^=Y<<7|Y>>>32-7;Y=$+j|0;q^=Y<<9|Y>>>32-9;Y=q+$|0;G^=Y<<13|Y>>>32-13;Y=G+q|0;j^=Y<<18|Y>>>32-18}e[0]=k>>>0&255;e[1]=k>>>8&255;e[2]=k>>>16&255;e[3]=k>>>24&255;e[4]=P>>>0&255;e[5]=P>>>8&255;e[6]=P>>>16&255;e[7]=P>>>24&255;e[8]=Q>>>0&255;e[9]=Q>>>8&255;e[10]=Q>>>16&255;e[11]=Q>>>24&255;e[12]=j>>>0&255;e[13]=j>>>8&255;e[14]=j>>>16&255;e[15]=j>>>24&255;e[16]=L>>>0&255;e[17]=L>>>8&255;e[18]=L>>>16&255;e[19]=L>>>24&255;e[20]=U>>>0&255;e[21]=U>>>8&255;e[22]=U>>>16&255;e[23]=U>>>24&255;e[24]=D>>>0&255;e[25]=D>>>8&255;e[26]=D>>>16&255;e[27]=D>>>24&255;e[28]=x>>>0&255;e[29]=x>>>8&255;e[30]=x>>>16&255;e[31]=x>>>24&255}function crypto_core_salsa20(e,t,n,i){core_salsa20(e,t,n,i)}function crypto_core_hsalsa20(e,t,n,i){core_hsalsa20(e,t,n,i)}var _=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function crypto_stream_salsa20_xor(e,t,n,i,s,o,f){var u=new Uint8Array(16),l=new Uint8Array(64);var h,p;for(p=0;p<16;p++)u[p]=0;for(p=0;p<8;p++)u[p]=o[p];while(s>=64){crypto_core_salsa20(l,u,f,_);for(p=0;p<64;p++)e[t+p]=n[i+p]^l[p];h=1;for(p=8;p<16;p++){h=h+(u[p]&255)|0;u[p]=h&255;h>>>=8}s-=64;t+=64;i+=64}if(s>0){crypto_core_salsa20(l,u,f,_);for(p=0;p<s;p++)e[t+p]=n[i+p]^l[p]}return 0}function crypto_stream_salsa20(e,t,n,i,s){var o=new Uint8Array(16),f=new Uint8Array(64);var u,l;for(l=0;l<16;l++)o[l]=0;for(l=0;l<8;l++)o[l]=i[l];while(n>=64){crypto_core_salsa20(f,o,s,_);for(l=0;l<64;l++)e[t+l]=f[l];u=1;for(l=8;l<16;l++){u=u+(o[l]&255)|0;o[l]=u&255;u>>>=8}n-=64;t+=64}if(n>0){crypto_core_salsa20(f,o,s,_);for(l=0;l<n;l++)e[t+l]=f[l]}return 0}function crypto_stream(e,t,n,i,s){var o=new Uint8Array(32);crypto_core_hsalsa20(o,i,s,_);var f=new Uint8Array(8);for(var u=0;u<8;u++)f[u]=i[u+16];return crypto_stream_salsa20(e,t,n,f,o)}function crypto_stream_xor(e,t,n,i,s,o,f){var u=new Uint8Array(32);crypto_core_hsalsa20(u,o,f,_);var l=new Uint8Array(8);for(var h=0;h<8;h++)l[h]=o[h+16];return crypto_stream_salsa20_xor(e,t,n,i,s,l,u)}var poly1305=function(e){this.buffer=new Uint8Array(16);this.r=new Uint16Array(10);this.h=new Uint16Array(10);this.pad=new Uint16Array(8);this.leftover=0;this.fin=0;var t,n,i,s,o,f,u,l;t=e[0]&255|(e[1]&255)<<8;this.r[0]=t&8191;n=e[2]&255|(e[3]&255)<<8;this.r[1]=(t>>>13|n<<3)&8191;i=e[4]&255|(e[5]&255)<<8;this.r[2]=(n>>>10|i<<6)&7939;s=e[6]&255|(e[7]&255)<<8;this.r[3]=(i>>>7|s<<9)&8191;o=e[8]&255|(e[9]&255)<<8;this.r[4]=(s>>>4|o<<12)&255;this.r[5]=o>>>1&8190;f=e[10]&255|(e[11]&255)<<8;this.r[6]=(o>>>14|f<<2)&8191;u=e[12]&255|(e[13]&255)<<8;this.r[7]=(f>>>11|u<<5)&8065;l=e[14]&255|(e[15]&255)<<8;this.r[8]=(u>>>8|l<<8)&8191;this.r[9]=l>>>5&127;this.pad[0]=e[16]&255|(e[17]&255)<<8;this.pad[1]=e[18]&255|(e[19]&255)<<8;this.pad[2]=e[20]&255|(e[21]&255)<<8;this.pad[3]=e[22]&255|(e[23]&255)<<8;this.pad[4]=e[24]&255|(e[25]&255)<<8;this.pad[5]=e[26]&255|(e[27]&255)<<8;this.pad[6]=e[28]&255|(e[29]&255)<<8;this.pad[7]=e[30]&255|(e[31]&255)<<8};poly1305.prototype.blocks=function(e,t,n){var i=this.fin?0:1<<11;var s,o,f,u,l,h,p,g,_;var E,y,b,w,I,C,v,k,R,B;var T=this.h[0],O=this.h[1],P=this.h[2],L=this.h[3],U=this.h[4],D=this.h[5],x=this.h[6],Q=this.h[7],W=this.h[8],$=this.h[9];var q=this.r[0],G=this.r[1],j=this.r[2],Y=this.r[3],V=this.r[4],z=this.r[5],J=this.r[6],ee=this.r[7],te=this.r[8],re=this.r[9];while(n>=16){s=e[t+0]&255|(e[t+1]&255)<<8;T+=s&8191;o=e[t+2]&255|(e[t+3]&255)<<8;O+=(s>>>13|o<<3)&8191;f=e[t+4]&255|(e[t+5]&255)<<8;P+=(o>>>10|f<<6)&8191;u=e[t+6]&255|(e[t+7]&255)<<8;L+=(f>>>7|u<<9)&8191;l=e[t+8]&255|(e[t+9]&255)<<8;U+=(u>>>4|l<<12)&8191;D+=l>>>1&8191;h=e[t+10]&255|(e[t+11]&255)<<8;x+=(l>>>14|h<<2)&8191;p=e[t+12]&255|(e[t+13]&255)<<8;Q+=(h>>>11|p<<5)&8191;g=e[t+14]&255|(e[t+15]&255)<<8;W+=(p>>>8|g<<8)&8191;$+=g>>>5|i;_=0;E=_;E+=T*q;E+=O*(5*re);E+=P*(5*te);E+=L*(5*ee);E+=U*(5*J);_=E>>>13;E&=8191;E+=D*(5*z);E+=x*(5*V);E+=Q*(5*Y);E+=W*(5*j);E+=$*(5*G);_+=E>>>13;E&=8191;y=_;y+=T*G;y+=O*q;y+=P*(5*re);y+=L*(5*te);y+=U*(5*ee);_=y>>>13;y&=8191;y+=D*(5*J);y+=x*(5*z);y+=Q*(5*V);y+=W*(5*Y);y+=$*(5*j);_+=y>>>13;y&=8191;b=_;b+=T*j;b+=O*G;b+=P*q;b+=L*(5*re);b+=U*(5*te);_=b>>>13;b&=8191;b+=D*(5*ee);b+=x*(5*J);b+=Q*(5*z);b+=W*(5*V);b+=$*(5*Y);_+=b>>>13;b&=8191;w=_;w+=T*Y;w+=O*j;w+=P*G;w+=L*q;w+=U*(5*re);_=w>>>13;w&=8191;w+=D*(5*te);w+=x*(5*ee);w+=Q*(5*J);w+=W*(5*z);w+=$*(5*V);_+=w>>>13;w&=8191;I=_;I+=T*V;I+=O*Y;I+=P*j;I+=L*G;I+=U*q;_=I>>>13;I&=8191;I+=D*(5*re);I+=x*(5*te);I+=Q*(5*ee);I+=W*(5*J);I+=$*(5*z);_+=I>>>13;I&=8191;C=_;C+=T*z;C+=O*V;C+=P*Y;C+=L*j;C+=U*G;_=C>>>13;C&=8191;C+=D*q;C+=x*(5*re);C+=Q*(5*te);C+=W*(5*ee);C+=$*(5*J);_+=C>>>13;C&=8191;v=_;v+=T*J;v+=O*z;v+=P*V;v+=L*Y;v+=U*j;_=v>>>13;v&=8191;v+=D*G;v+=x*q;v+=Q*(5*re);v+=W*(5*te);v+=$*(5*ee);_+=v>>>13;v&=8191;k=_;k+=T*ee;k+=O*J;k+=P*z;k+=L*V;k+=U*Y;_=k>>>13;k&=8191;k+=D*j;k+=x*G;k+=Q*q;k+=W*(5*re);k+=$*(5*te);_+=k>>>13;k&=8191;R=_;R+=T*te;R+=O*ee;R+=P*J;R+=L*z;R+=U*V;_=R>>>13;R&=8191;R+=D*Y;R+=x*j;R+=Q*G;R+=W*q;R+=$*(5*re);_+=R>>>13;R&=8191;B=_;B+=T*re;B+=O*te;B+=P*ee;B+=L*J;B+=U*z;_=B>>>13;B&=8191;B+=D*V;B+=x*Y;B+=Q*j;B+=W*G;B+=$*q;_+=B>>>13;B&=8191;_=(_<<2)+_|0;_=_+E|0;E=_&8191;_=_>>>13;y+=_;T=E;O=y;P=b;L=w;U=I;D=C;x=v;Q=k;W=R;$=B;t+=16;n-=16}this.h[0]=T;this.h[1]=O;this.h[2]=P;this.h[3]=L;this.h[4]=U;this.h[5]=D;this.h[6]=x;this.h[7]=Q;this.h[8]=W;this.h[9]=$};poly1305.prototype.finish=function(e,t){var n=new Uint16Array(10);var i,s,o,f;if(this.leftover){f=this.leftover;this.buffer[f++]=1;for(;f<16;f++)this.buffer[f]=0;this.fin=1;this.blocks(this.buffer,0,16)}i=this.h[1]>>>13;this.h[1]&=8191;for(f=2;f<10;f++){this.h[f]+=i;i=this.h[f]>>>13;this.h[f]&=8191}this.h[0]+=i*5;i=this.h[0]>>>13;this.h[0]&=8191;this.h[1]+=i;i=this.h[1]>>>13;this.h[1]&=8191;this.h[2]+=i;n[0]=this.h[0]+5;i=n[0]>>>13;n[0]&=8191;for(f=1;f<10;f++){n[f]=this.h[f]+i;i=n[f]>>>13;n[f]&=8191}n[9]-=1<<13;s=(i^1)-1;for(f=0;f<10;f++)n[f]&=s;s=~s;for(f=0;f<10;f++)this.h[f]=this.h[f]&s|n[f];this.h[0]=(this.h[0]|this.h[1]<<13)&65535;this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535;this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535;this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535;this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535;this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535;this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535;this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535;o=this.h[0]+this.pad[0];this.h[0]=o&65535;for(f=1;f<8;f++){o=(this.h[f]+this.pad[f]|0)+(o>>>16)|0;this.h[f]=o&65535}e[t+0]=this.h[0]>>>0&255;e[t+1]=this.h[0]>>>8&255;e[t+2]=this.h[1]>>>0&255;e[t+3]=this.h[1]>>>8&255;e[t+4]=this.h[2]>>>0&255;e[t+5]=this.h[2]>>>8&255;e[t+6]=this.h[3]>>>0&255;e[t+7]=this.h[3]>>>8&255;e[t+8]=this.h[4]>>>0&255;e[t+9]=this.h[4]>>>8&255;e[t+10]=this.h[5]>>>0&255;e[t+11]=this.h[5]>>>8&255;e[t+12]=this.h[6]>>>0&255;e[t+13]=this.h[6]>>>8&255;e[t+14]=this.h[7]>>>0&255;e[t+15]=this.h[7]>>>8&255};poly1305.prototype.update=function(e,t,n){var i,s;if(this.leftover){s=16-this.leftover;if(s>n)s=n;for(i=0;i<s;i++)this.buffer[this.leftover+i]=e[t+i];n-=s;t+=s;this.leftover+=s;if(this.leftover<16)return;this.blocks(this.buffer,0,16);this.leftover=0}if(n>=16){s=n-n%16;this.blocks(e,t,s);t+=s;n-=s}if(n){for(i=0;i<n;i++)this.buffer[this.leftover+i]=e[t+i];this.leftover+=n}};function crypto_onetimeauth(e,t,n,i,s,o){var f=new poly1305(o);f.update(n,i,s);f.finish(e,t);return 0}function crypto_onetimeauth_verify(e,t,n,i,s,o){var f=new Uint8Array(16);crypto_onetimeauth(f,0,n,i,s,o);return crypto_verify_16(e,t,f,0)}function crypto_secretbox(e,t,n,i,s){var o;if(n<32)return-1;crypto_stream_xor(e,0,t,0,n,i,s);crypto_onetimeauth(e,16,e,32,n-32,e);for(o=0;o<16;o++)e[o]=0;return 0}function crypto_secretbox_open(e,t,n,i,s){var o;var f=new Uint8Array(32);if(n<32)return-1;crypto_stream(f,0,32,i,s);if(crypto_onetimeauth_verify(t,16,t,32,n-32,f)!==0)return-1;crypto_stream_xor(e,0,t,0,n,i,s);for(o=0;o<32;o++)e[o]=0;return 0}function set25519(e,t){var n;for(n=0;n<16;n++)e[n]=t[n]|0}function car25519(e){var t,n,i=1;for(t=0;t<16;t++){n=e[t]+i+65535;i=Math.floor(n/65536);e[t]=n-i*65536}e[0]+=i-1+37*(i-1)}function sel25519(e,t,n){var i,s=~(n-1);for(var o=0;o<16;o++){i=s&(e[o]^t[o]);e[o]^=i;t[o]^=i}}function pack25519(e,t){var n,i,s;var o=gf(),f=gf();for(n=0;n<16;n++)f[n]=t[n];car25519(f);car25519(f);car25519(f);for(i=0;i<2;i++){o[0]=f[0]-65517;for(n=1;n<15;n++){o[n]=f[n]-65535-(o[n-1]>>16&1);o[n-1]&=65535}o[15]=f[15]-32767-(o[14]>>16&1);s=o[15]>>16&1;o[14]&=65535;sel25519(f,o,1-s)}for(n=0;n<16;n++){e[2*n]=f[n]&255;e[2*n+1]=f[n]>>8}}function neq25519(e,t){var n=new Uint8Array(32),i=new Uint8Array(32);pack25519(n,e);pack25519(i,t);return crypto_verify_32(n,0,i,0)}function par25519(e){var t=new Uint8Array(32);pack25519(t,e);return t[0]&1}function unpack25519(e,t){var n;for(n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}function A(e,t,n){for(var i=0;i<16;i++)e[i]=t[i]+n[i]}function Z(e,t,n){for(var i=0;i<16;i++)e[i]=t[i]-n[i]}function M(e,t,n){var i,s,o=0,f=0,u=0,l=0,h=0,p=0,g=0,_=0,E=0,y=0,b=0,w=0,I=0,C=0,v=0,k=0,R=0,B=0,T=0,O=0,P=0,L=0,U=0,D=0,x=0,Q=0,W=0,$=0,q=0,G=0,j=0,Y=n[0],V=n[1],z=n[2],J=n[3],ee=n[4],te=n[5],re=n[6],ne=n[7],ie=n[8],se=n[9],oe=n[10],ae=n[11],ce=n[12],fe=n[13],ue=n[14],le=n[15];i=t[0];o+=i*Y;f+=i*V;u+=i*z;l+=i*J;h+=i*ee;p+=i*te;g+=i*re;_+=i*ne;E+=i*ie;y+=i*se;b+=i*oe;w+=i*ae;I+=i*ce;C+=i*fe;v+=i*ue;k+=i*le;i=t[1];f+=i*Y;u+=i*V;l+=i*z;h+=i*J;p+=i*ee;g+=i*te;_+=i*re;E+=i*ne;y+=i*ie;b+=i*se;w+=i*oe;I+=i*ae;C+=i*ce;v+=i*fe;k+=i*ue;R+=i*le;i=t[2];u+=i*Y;l+=i*V;h+=i*z;p+=i*J;g+=i*ee;_+=i*te;E+=i*re;y+=i*ne;b+=i*ie;w+=i*se;I+=i*oe;C+=i*ae;v+=i*ce;k+=i*fe;R+=i*ue;B+=i*le;i=t[3];l+=i*Y;h+=i*V;p+=i*z;g+=i*J;_+=i*ee;E+=i*te;y+=i*re;b+=i*ne;w+=i*ie;I+=i*se;C+=i*oe;v+=i*ae;k+=i*ce;R+=i*fe;B+=i*ue;T+=i*le;i=t[4];h+=i*Y;p+=i*V;g+=i*z;_+=i*J;E+=i*ee;y+=i*te;b+=i*re;w+=i*ne;I+=i*ie;C+=i*se;v+=i*oe;k+=i*ae;R+=i*ce;B+=i*fe;T+=i*ue;O+=i*le;i=t[5];p+=i*Y;g+=i*V;_+=i*z;E+=i*J;y+=i*ee;b+=i*te;w+=i*re;I+=i*ne;C+=i*ie;v+=i*se;k+=i*oe;R+=i*ae;B+=i*ce;T+=i*fe;O+=i*ue;P+=i*le;i=t[6];g+=i*Y;_+=i*V;E+=i*z;y+=i*J;b+=i*ee;w+=i*te;I+=i*re;C+=i*ne;v+=i*ie;k+=i*se;R+=i*oe;B+=i*ae;T+=i*ce;O+=i*fe;P+=i*ue;L+=i*le;i=t[7];_+=i*Y;E+=i*V;y+=i*z;b+=i*J;w+=i*ee;I+=i*te;C+=i*re;v+=i*ne;k+=i*ie;R+=i*se;B+=i*oe;T+=i*ae;O+=i*ce;P+=i*fe;L+=i*ue;U+=i*le;i=t[8];E+=i*Y;y+=i*V;b+=i*z;w+=i*J;I+=i*ee;C+=i*te;v+=i*re;k+=i*ne;R+=i*ie;B+=i*se;T+=i*oe;O+=i*ae;P+=i*ce;L+=i*fe;U+=i*ue;D+=i*le;i=t[9];y+=i*Y;b+=i*V;w+=i*z;I+=i*J;C+=i*ee;v+=i*te;k+=i*re;R+=i*ne;B+=i*ie;T+=i*se;O+=i*oe;P+=i*ae;L+=i*ce;U+=i*fe;D+=i*ue;x+=i*le;i=t[10];b+=i*Y;w+=i*V;I+=i*z;C+=i*J;v+=i*ee;k+=i*te;R+=i*re;B+=i*ne;T+=i*ie;O+=i*se;P+=i*oe;L+=i*ae;U+=i*ce;D+=i*fe;x+=i*ue;Q+=i*le;i=t[11];w+=i*Y;I+=i*V;C+=i*z;v+=i*J;k+=i*ee;R+=i*te;B+=i*re;T+=i*ne;O+=i*ie;P+=i*se;L+=i*oe;U+=i*ae;D+=i*ce;x+=i*fe;Q+=i*ue;W+=i*le;i=t[12];I+=i*Y;C+=i*V;v+=i*z;k+=i*J;R+=i*ee;B+=i*te;T+=i*re;O+=i*ne;P+=i*ie;L+=i*se;U+=i*oe;D+=i*ae;x+=i*ce;Q+=i*fe;W+=i*ue;$+=i*le;i=t[13];C+=i*Y;v+=i*V;k+=i*z;R+=i*J;B+=i*ee;T+=i*te;O+=i*re;P+=i*ne;L+=i*ie;U+=i*se;D+=i*oe;x+=i*ae;Q+=i*ce;W+=i*fe;$+=i*ue;q+=i*le;i=t[14];v+=i*Y;k+=i*V;R+=i*z;B+=i*J;T+=i*ee;O+=i*te;P+=i*re;L+=i*ne;U+=i*ie;D+=i*se;x+=i*oe;Q+=i*ae;W+=i*ce;$+=i*fe;q+=i*ue;G+=i*le;i=t[15];k+=i*Y;R+=i*V;B+=i*z;T+=i*J;O+=i*ee;P+=i*te;L+=i*re;U+=i*ne;D+=i*ie;x+=i*se;Q+=i*oe;W+=i*ae;$+=i*ce;q+=i*fe;G+=i*ue;j+=i*le;o+=38*R;f+=38*B;u+=38*T;l+=38*O;h+=38*P;p+=38*L;g+=38*U;_+=38*D;E+=38*x;y+=38*Q;b+=38*W;w+=38*$;I+=38*q;C+=38*G;v+=38*j;s=1;i=o+s+65535;s=Math.floor(i/65536);o=i-s*65536;i=f+s+65535;s=Math.floor(i/65536);f=i-s*65536;i=u+s+65535;s=Math.floor(i/65536);u=i-s*65536;i=l+s+65535;s=Math.floor(i/65536);l=i-s*65536;i=h+s+65535;s=Math.floor(i/65536);h=i-s*65536;i=p+s+65535;s=Math.floor(i/65536);p=i-s*65536;i=g+s+65535;s=Math.floor(i/65536);g=i-s*65536;i=_+s+65535;s=Math.floor(i/65536);_=i-s*65536;i=E+s+65535;s=Math.floor(i/65536);E=i-s*65536;i=y+s+65535;s=Math.floor(i/65536);y=i-s*65536;i=b+s+65535;s=Math.floor(i/65536);b=i-s*65536;i=w+s+65535;s=Math.floor(i/65536);w=i-s*65536;i=I+s+65535;s=Math.floor(i/65536);I=i-s*65536;i=C+s+65535;s=Math.floor(i/65536);C=i-s*65536;i=v+s+65535;s=Math.floor(i/65536);v=i-s*65536;i=k+s+65535;s=Math.floor(i/65536);k=i-s*65536;o+=s-1+37*(s-1);s=1;i=o+s+65535;s=Math.floor(i/65536);o=i-s*65536;i=f+s+65535;s=Math.floor(i/65536);f=i-s*65536;i=u+s+65535;s=Math.floor(i/65536);u=i-s*65536;i=l+s+65535;s=Math.floor(i/65536);l=i-s*65536;i=h+s+65535;s=Math.floor(i/65536);h=i-s*65536;i=p+s+65535;s=Math.floor(i/65536);p=i-s*65536;i=g+s+65535;s=Math.floor(i/65536);g=i-s*65536;i=_+s+65535;s=Math.floor(i/65536);_=i-s*65536;i=E+s+65535;s=Math.floor(i/65536);E=i-s*65536;i=y+s+65535;s=Math.floor(i/65536);y=i-s*65536;i=b+s+65535;s=Math.floor(i/65536);b=i-s*65536;i=w+s+65535;s=Math.floor(i/65536);w=i-s*65536;i=I+s+65535;s=Math.floor(i/65536);I=i-s*65536;i=C+s+65535;s=Math.floor(i/65536);C=i-s*65536;i=v+s+65535;s=Math.floor(i/65536);v=i-s*65536;i=k+s+65535;s=Math.floor(i/65536);k=i-s*65536;o+=s-1+37*(s-1);e[0]=o;e[1]=f;e[2]=u;e[3]=l;e[4]=h;e[5]=p;e[6]=g;e[7]=_;e[8]=E;e[9]=y;e[10]=b;e[11]=w;e[12]=I;e[13]=C;e[14]=v;e[15]=k}function S(e,t){M(e,t,t)}function inv25519(e,t){var n=gf();var i;for(i=0;i<16;i++)n[i]=t[i];for(i=253;i>=0;i--){S(n,n);if(i!==2&&i!==4)M(n,n,t)}for(i=0;i<16;i++)e[i]=n[i]}function pow2523(e,t){var n=gf();var i;for(i=0;i<16;i++)n[i]=t[i];for(i=250;i>=0;i--){S(n,n);if(i!==1)M(n,n,t)}for(i=0;i<16;i++)e[i]=n[i]}function crypto_scalarmult(e,t,n){var i=new Uint8Array(32);var s=new Float64Array(80),o,u;var l=gf(),h=gf(),p=gf(),g=gf(),_=gf(),E=gf();for(u=0;u<31;u++)i[u]=t[u];i[31]=t[31]&127|64;i[0]&=248;unpack25519(s,n);for(u=0;u<16;u++){h[u]=s[u];g[u]=l[u]=p[u]=0}l[0]=g[0]=1;for(u=254;u>=0;--u){o=i[u>>>3]>>>(u&7)&1;sel25519(l,h,o);sel25519(p,g,o);A(_,l,p);Z(l,l,p);A(p,h,g);Z(h,h,g);S(g,_);S(E,l);M(l,p,l);M(p,h,_);A(_,l,p);Z(l,l,p);S(h,l);Z(p,g,E);M(l,p,f);A(l,l,g);M(p,p,l);M(l,g,E);M(g,h,s);S(h,_);sel25519(l,h,o);sel25519(p,g,o)}for(u=0;u<16;u++){s[u+16]=l[u];s[u+32]=p[u];s[u+48]=h[u];s[u+64]=g[u]}var y=s.subarray(32);var b=s.subarray(16);inv25519(y,y);M(b,b,y);pack25519(e,b);return 0}function crypto_scalarmult_base(e,t){return crypto_scalarmult(e,t,i)}function crypto_box_keypair(e,t){randombytes(t,32);return crypto_scalarmult_base(e,t)}function crypto_box_beforenm(e,n,i){var s=new Uint8Array(32);crypto_scalarmult(s,i,n);return crypto_core_hsalsa20(e,t,s,_)}var E=crypto_secretbox;var y=crypto_secretbox_open;function crypto_box(e,t,n,i,s,o){var f=new Uint8Array(32);crypto_box_beforenm(f,s,o);return E(e,t,n,i,f)}function crypto_box_open(e,t,n,i,s,o){var f=new Uint8Array(32);crypto_box_beforenm(f,s,o);return y(e,t,n,i,f)}var b=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function crypto_hashblocks_hl(e,t,n,i){var s=new Int32Array(16),o=new Int32Array(16),f,u,l,h,p,g,_,E,y,w,I,C,v,k,R,B,T,O,P,L,U,D,x,Q,W,$;var q=e[0],G=e[1],j=e[2],Y=e[3],V=e[4],z=e[5],J=e[6],ee=e[7],te=t[0],re=t[1],ne=t[2],ie=t[3],se=t[4],oe=t[5],ae=t[6],ce=t[7];var fe=0;while(i>=128){for(P=0;P<16;P++){L=8*P+fe;s[P]=n[L+0]<<24|n[L+1]<<16|n[L+2]<<8|n[L+3];o[P]=n[L+4]<<24|n[L+5]<<16|n[L+6]<<8|n[L+7]}for(P=0;P<80;P++){f=q;u=G;l=j;h=Y;p=V;g=z;_=J;E=ee;y=te;w=re;I=ne;C=ie;v=se;k=oe;R=ae;B=ce;U=ee;D=ce;x=D&65535;Q=D>>>16;W=U&65535;$=U>>>16;U=(V>>>14|se<<32-14)^(V>>>18|se<<32-18)^(se>>>41-32|V<<32-(41-32));D=(se>>>14|V<<32-14)^(se>>>18|V<<32-18)^(V>>>41-32|se<<32-(41-32));x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;U=V&z^~V&J;D=se&oe^~se&ae;x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;U=b[P*2];D=b[P*2+1];x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;U=s[P%16];D=o[P%16];x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;Q+=x>>>16;W+=Q>>>16;$+=W>>>16;T=W&65535|$<<16;O=x&65535|Q<<16;U=T;D=O;x=D&65535;Q=D>>>16;W=U&65535;$=U>>>16;U=(q>>>28|te<<32-28)^(te>>>34-32|q<<32-(34-32))^(te>>>39-32|q<<32-(39-32));D=(te>>>28|q<<32-28)^(q>>>34-32|te<<32-(34-32))^(q>>>39-32|te<<32-(39-32));x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;U=q&G^q&j^G&j;D=te&re^te&ne^re&ne;x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;Q+=x>>>16;W+=Q>>>16;$+=W>>>16;E=W&65535|$<<16;B=x&65535|Q<<16;U=h;D=C;x=D&65535;Q=D>>>16;W=U&65535;$=U>>>16;U=T;D=O;x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;Q+=x>>>16;W+=Q>>>16;$+=W>>>16;h=W&65535|$<<16;C=x&65535|Q<<16;G=f;j=u;Y=l;V=h;z=p;J=g;ee=_;q=E;re=y;ne=w;ie=I;se=C;oe=v;ae=k;ce=R;te=B;if(P%16===15){for(L=0;L<16;L++){U=s[L];D=o[L];x=D&65535;Q=D>>>16;W=U&65535;$=U>>>16;U=s[(L+9)%16];D=o[(L+9)%16];x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;T=s[(L+1)%16];O=o[(L+1)%16];U=(T>>>1|O<<32-1)^(T>>>8|O<<32-8)^T>>>7;D=(O>>>1|T<<32-1)^(O>>>8|T<<32-8)^(O>>>7|T<<32-7);x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;T=s[(L+14)%16];O=o[(L+14)%16];U=(T>>>19|O<<32-19)^(O>>>61-32|T<<32-(61-32))^T>>>6;D=(O>>>19|T<<32-19)^(T>>>61-32|O<<32-(61-32))^(O>>>6|T<<32-6);x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;Q+=x>>>16;W+=Q>>>16;$+=W>>>16;s[L]=W&65535|$<<16;o[L]=x&65535|Q<<16}}}U=q;D=te;x=D&65535;Q=D>>>16;W=U&65535;$=U>>>16;U=e[0];D=t[0];x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;Q+=x>>>16;W+=Q>>>16;$+=W>>>16;e[0]=q=W&65535|$<<16;t[0]=te=x&65535|Q<<16;U=G;D=re;x=D&65535;Q=D>>>16;W=U&65535;$=U>>>16;U=e[1];D=t[1];x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;Q+=x>>>16;W+=Q>>>16;$+=W>>>16;e[1]=G=W&65535|$<<16;t[1]=re=x&65535|Q<<16;U=j;D=ne;x=D&65535;Q=D>>>16;W=U&65535;$=U>>>16;U=e[2];D=t[2];x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;Q+=x>>>16;W+=Q>>>16;$+=W>>>16;e[2]=j=W&65535|$<<16;t[2]=ne=x&65535|Q<<16;U=Y;D=ie;x=D&65535;Q=D>>>16;W=U&65535;$=U>>>16;U=e[3];D=t[3];x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;Q+=x>>>16;W+=Q>>>16;$+=W>>>16;e[3]=Y=W&65535|$<<16;t[3]=ie=x&65535|Q<<16;U=V;D=se;x=D&65535;Q=D>>>16;W=U&65535;$=U>>>16;U=e[4];D=t[4];x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;Q+=x>>>16;W+=Q>>>16;$+=W>>>16;e[4]=V=W&65535|$<<16;t[4]=se=x&65535|Q<<16;U=z;D=oe;x=D&65535;Q=D>>>16;W=U&65535;$=U>>>16;U=e[5];D=t[5];x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;Q+=x>>>16;W+=Q>>>16;$+=W>>>16;e[5]=z=W&65535|$<<16;t[5]=oe=x&65535|Q<<16;U=J;D=ae;x=D&65535;Q=D>>>16;W=U&65535;$=U>>>16;U=e[6];D=t[6];x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;Q+=x>>>16;W+=Q>>>16;$+=W>>>16;e[6]=J=W&65535|$<<16;t[6]=ae=x&65535|Q<<16;U=ee;D=ce;x=D&65535;Q=D>>>16;W=U&65535;$=U>>>16;U=e[7];D=t[7];x+=D&65535;Q+=D>>>16;W+=U&65535;$+=U>>>16;Q+=x>>>16;W+=Q>>>16;$+=W>>>16;e[7]=ee=W&65535|$<<16;t[7]=ce=x&65535|Q<<16;fe+=128;i-=128}return i}function crypto_hash(e,t,n){var i=new Int32Array(8),s=new Int32Array(8),o=new Uint8Array(256),f,u=n;i[0]=1779033703;i[1]=3144134277;i[2]=1013904242;i[3]=2773480762;i[4]=1359893119;i[5]=2600822924;i[6]=528734635;i[7]=1541459225;s[0]=4089235720;s[1]=2227873595;s[2]=4271175723;s[3]=1595750129;s[4]=2917565137;s[5]=725511199;s[6]=4215389547;s[7]=327033209;crypto_hashblocks_hl(i,s,t,n);n%=128;for(f=0;f<n;f++)o[f]=t[u-n+f];o[n]=128;n=256-128*(n<112?1:0);o[n-9]=0;ts64(o,n-8,u/536870912|0,u<<3);crypto_hashblocks_hl(i,s,o,n);for(f=0;f<8;f++)ts64(e,8*f,i[f],s[f]);return 0}function add(e,t){var n=gf(),i=gf(),s=gf(),o=gf(),f=gf(),u=gf(),h=gf(),p=gf(),g=gf();Z(n,e[1],e[0]);Z(g,t[1],t[0]);M(n,n,g);A(i,e[0],e[1]);A(g,t[0],t[1]);M(i,i,g);M(s,e[3],t[3]);M(s,s,l);M(o,e[2],t[2]);A(o,o,o);Z(f,i,n);Z(u,o,s);A(h,o,s);A(p,i,n);M(e[0],f,u);M(e[1],p,h);M(e[2],h,u);M(e[3],f,p)}function cswap(e,t,n){var i;for(i=0;i<4;i++){sel25519(e[i],t[i],n)}}function pack(e,t){var n=gf(),i=gf(),s=gf();inv25519(s,t[2]);M(n,t[0],s);M(i,t[1],s);pack25519(e,i);e[31]^=par25519(n)<<7}function scalarmult(e,t,n){var i,f;set25519(e[0],s);set25519(e[1],o);set25519(e[2],o);set25519(e[3],s);for(f=255;f>=0;--f){i=n[f/8|0]>>(f&7)&1;cswap(e,t,i);add(t,e);add(e,e);cswap(e,t,i)}}function scalarbase(e,t){var n=[gf(),gf(),gf(),gf()];set25519(n[0],h);set25519(n[1],p);set25519(n[2],o);M(n[3],h,p);scalarmult(e,n,t)}function crypto_sign_keypair(e,t,n){var i=new Uint8Array(64);var s=[gf(),gf(),gf(),gf()];var o;if(!n)randombytes(t,32);crypto_hash(i,t,32);i[0]&=248;i[31]&=127;i[31]|=64;scalarbase(s,i);pack(e,s);for(o=0;o<32;o++)t[o+32]=e[o];return 0}var w=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function modL(e,t){var n,i,s,o;for(i=63;i>=32;--i){n=0;for(s=i-32,o=i-12;s<o;++s){t[s]+=n-16*t[i]*w[s-(i-32)];n=t[s]+128>>8;t[s]-=n*256}t[s]+=n;t[i]=0}n=0;for(s=0;s<32;s++){t[s]+=n-(t[31]>>4)*w[s];n=t[s]>>8;t[s]&=255}for(s=0;s<32;s++)t[s]-=n*w[s];for(i=0;i<32;i++){t[i+1]+=t[i]>>8;e[i]=t[i]&255}}function reduce(e){var t=new Float64Array(64),n;for(n=0;n<64;n++)t[n]=e[n];for(n=0;n<64;n++)e[n]=0;modL(e,t)}function crypto_sign(e,t,n,i){var s=new Uint8Array(64),o=new Uint8Array(64),f=new Uint8Array(64);var u,l,h=new Float64Array(64);var p=[gf(),gf(),gf(),gf()];crypto_hash(s,i,32);s[0]&=248;s[31]&=127;s[31]|=64;var g=n+64;for(u=0;u<n;u++)e[64+u]=t[u];for(u=0;u<32;u++)e[32+u]=s[32+u];crypto_hash(f,e.subarray(32),n+32);reduce(f);scalarbase(p,f);pack(e,p);for(u=32;u<64;u++)e[u]=i[u];crypto_hash(o,e,n+64);reduce(o);for(u=0;u<64;u++)h[u]=0;for(u=0;u<32;u++)h[u]=f[u];for(u=0;u<32;u++){for(l=0;l<32;l++){h[u+l]+=o[u]*s[l]}}modL(e.subarray(32),h);return g}function unpackneg(e,t){var n=gf(),i=gf(),f=gf(),l=gf(),h=gf(),p=gf(),_=gf();set25519(e[2],o);unpack25519(e[1],t);S(f,e[1]);M(l,f,u);Z(f,f,e[2]);A(l,e[2],l);S(h,l);S(p,h);M(_,p,h);M(n,_,f);M(n,n,l);pow2523(n,n);M(n,n,f);M(n,n,l);M(n,n,l);M(e[0],n,l);S(i,e[0]);M(i,i,l);if(neq25519(i,f))M(e[0],e[0],g);S(i,e[0]);M(i,i,l);if(neq25519(i,f))return-1;if(par25519(e[0])===t[31]>>7)Z(e[0],s,e[0]);M(e[3],e[0],e[1]);return 0}function crypto_sign_open(e,t,n,i){var s,o;var f=new Uint8Array(32),u=new Uint8Array(64);var l=[gf(),gf(),gf(),gf()],h=[gf(),gf(),gf(),gf()];o=-1;if(n<64)return-1;if(unpackneg(h,i))return-1;for(s=0;s<n;s++)e[s]=t[s];for(s=0;s<32;s++)e[s+32]=i[s];crypto_hash(u,e,n);reduce(u);scalarmult(l,h,u);scalarbase(h,t.subarray(32));add(l,h);pack(f,l);n-=64;if(crypto_verify_32(t,0,f,0)){for(s=0;s<n;s++)e[s]=0;return-1}for(s=0;s<n;s++)e[s]=t[s+64];o=n;return o}var I=32,C=24,v=32,k=16,R=32,B=32,T=32,O=32,P=32,L=C,U=v,D=k,x=64,Q=32,W=64,$=32,q=64;e.lowlevel={crypto_core_hsalsa20:crypto_core_hsalsa20,crypto_stream_xor:crypto_stream_xor,crypto_stream:crypto_stream,crypto_stream_salsa20_xor:crypto_stream_salsa20_xor,crypto_stream_salsa20:crypto_stream_salsa20,crypto_onetimeauth:crypto_onetimeauth,crypto_onetimeauth_verify:crypto_onetimeauth_verify,crypto_verify_16:crypto_verify_16,crypto_verify_32:crypto_verify_32,crypto_secretbox:crypto_secretbox,crypto_secretbox_open:crypto_secretbox_open,crypto_scalarmult:crypto_scalarmult,crypto_scalarmult_base:crypto_scalarmult_base,crypto_box_beforenm:crypto_box_beforenm,crypto_box_afternm:E,crypto_box:crypto_box,crypto_box_open:crypto_box_open,crypto_box_keypair:crypto_box_keypair,crypto_hash:crypto_hash,crypto_sign:crypto_sign,crypto_sign_keypair:crypto_sign_keypair,crypto_sign_open:crypto_sign_open,crypto_secretbox_KEYBYTES:I,crypto_secretbox_NONCEBYTES:C,crypto_secretbox_ZEROBYTES:v,crypto_secretbox_BOXZEROBYTES:k,crypto_scalarmult_BYTES:R,crypto_scalarmult_SCALARBYTES:B,crypto_box_PUBLICKEYBYTES:T,crypto_box_SECRETKEYBYTES:O,crypto_box_BEFORENMBYTES:P,crypto_box_NONCEBYTES:L,crypto_box_ZEROBYTES:U,crypto_box_BOXZEROBYTES:D,crypto_sign_BYTES:x,crypto_sign_PUBLICKEYBYTES:Q,crypto_sign_SECRETKEYBYTES:W,crypto_sign_SEEDBYTES:$,crypto_hash_BYTES:q};function checkLengths(e,t){if(e.length!==I)throw new Error("bad key size");if(t.length!==C)throw new Error("bad nonce size")}function checkBoxLengths(e,t){if(e.length!==T)throw new Error("bad public key size");if(t.length!==O)throw new Error("bad secret key size")}function checkArrayTypes(){var e,t;for(t=0;t<arguments.length;t++){if((e=Object.prototype.toString.call(arguments[t]))!=="[object Uint8Array]")throw new TypeError("unexpected type "+e+", use Uint8Array")}}function cleanup(e){for(var t=0;t<e.length;t++)e[t]=0}if(!e.util){e.util={};e.util.decodeUTF8=e.util.encodeUTF8=e.util.encodeBase64=e.util.decodeBase64=function(){throw new Error("nacl.util moved into separate package: https://github.com/dchest/tweetnacl-util-js")}}e.randomBytes=function(e){var t=new Uint8Array(e);randombytes(t,e);return t};e.secretbox=function(e,t,n){checkArrayTypes(e,t,n);checkLengths(n,t);var i=new Uint8Array(v+e.length);var s=new Uint8Array(i.length);for(var o=0;o<e.length;o++)i[o+v]=e[o];crypto_secretbox(s,i,i.length,t,n);return s.subarray(k)};e.secretbox.open=function(e,t,n){checkArrayTypes(e,t,n);checkLengths(n,t);var i=new Uint8Array(k+e.length);var s=new Uint8Array(i.length);for(var o=0;o<e.length;o++)i[o+k]=e[o];if(i.length<32)return false;if(crypto_secretbox_open(s,i,i.length,t,n)!==0)return false;return s.subarray(v)};e.secretbox.keyLength=I;e.secretbox.nonceLength=C;e.secretbox.overheadLength=k;e.scalarMult=function(e,t){checkArrayTypes(e,t);if(e.length!==B)throw new Error("bad n size");if(t.length!==R)throw new Error("bad p size");var n=new Uint8Array(R);crypto_scalarmult(n,e,t);return n};e.scalarMult.base=function(e){checkArrayTypes(e);if(e.length!==B)throw new Error("bad n size");var t=new Uint8Array(R);crypto_scalarmult_base(t,e);return t};e.scalarMult.scalarLength=B;e.scalarMult.groupElementLength=R;e.box=function(t,n,i,s){var o=e.box.before(i,s);return e.secretbox(t,n,o)};e.box.before=function(e,t){checkArrayTypes(e,t);checkBoxLengths(e,t);var n=new Uint8Array(P);crypto_box_beforenm(n,e,t);return n};e.box.after=e.secretbox;e.box.open=function(t,n,i,s){var o=e.box.before(i,s);return e.secretbox.open(t,n,o)};e.box.open.after=e.secretbox.open;e.box.keyPair=function(){var e=new Uint8Array(T);var t=new Uint8Array(O);crypto_box_keypair(e,t);return{publicKey:e,secretKey:t}};e.box.keyPair.fromSecretKey=function(e){checkArrayTypes(e);if(e.length!==O)throw new Error("bad secret key size");var t=new Uint8Array(T);crypto_scalarmult_base(t,e);return{publicKey:t,secretKey:new Uint8Array(e)}};e.box.publicKeyLength=T;e.box.secretKeyLength=O;e.box.sharedKeyLength=P;e.box.nonceLength=L;e.box.overheadLength=e.secretbox.overheadLength;e.sign=function(e,t){checkArrayTypes(e,t);if(t.length!==W)throw new Error("bad secret key size");var n=new Uint8Array(x+e.length);crypto_sign(n,e,e.length,t);return n};e.sign.open=function(e,t){if(arguments.length!==2)throw new Error("nacl.sign.open accepts 2 arguments; did you mean to use nacl.sign.detached.verify?");checkArrayTypes(e,t);if(t.length!==Q)throw new Error("bad public key size");var n=new Uint8Array(e.length);var i=crypto_sign_open(n,e,e.length,t);if(i<0)return null;var s=new Uint8Array(i);for(var o=0;o<s.length;o++)s[o]=n[o];return s};e.sign.detached=function(t,n){var i=e.sign(t,n);var s=new Uint8Array(x);for(var o=0;o<s.length;o++)s[o]=i[o];return s};e.sign.detached.verify=function(e,t,n){checkArrayTypes(e,t,n);if(t.length!==x)throw new Error("bad signature size");if(n.length!==Q)throw new Error("bad public key size");var i=new Uint8Array(x+e.length);var s=new Uint8Array(x+e.length);var o;for(o=0;o<x;o++)i[o]=t[o];for(o=0;o<e.length;o++)i[o+x]=e[o];return crypto_sign_open(s,i,i.length,n)>=0};e.sign.keyPair=function(){var e=new Uint8Array(Q);var t=new Uint8Array(W);crypto_sign_keypair(e,t);return{publicKey:e,secretKey:t}};e.sign.keyPair.fromSecretKey=function(e){checkArrayTypes(e);if(e.length!==W)throw new Error("bad secret key size");var t=new Uint8Array(Q);for(var n=0;n<t.length;n++)t[n]=e[32+n];return{publicKey:t,secretKey:new Uint8Array(e)}};e.sign.keyPair.fromSeed=function(e){checkArrayTypes(e);if(e.length!==$)throw new Error("bad seed size");var t=new Uint8Array(Q);var n=new Uint8Array(W);for(var i=0;i<32;i++)n[i]=e[i];crypto_sign_keypair(t,n,true);return{publicKey:t,secretKey:n}};e.sign.publicKeyLength=Q;e.sign.secretKeyLength=W;e.sign.seedLength=$;e.sign.signatureLength=x;e.hash=function(e){checkArrayTypes(e);var t=new Uint8Array(q);crypto_hash(t,e,e.length);return t};e.hash.hashLength=q;e.verify=function(e,t){checkArrayTypes(e,t);if(e.length===0||t.length===0)return false;if(e.length!==t.length)return false;return vn(e,0,t,0,e.length)===0?true:false};e.setPRNG=function(e){randombytes=e};(function(){var t=typeof self!=="undefined"?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues){var i=65536;e.setPRNG((function(e,n){var s,o=new Uint8Array(n);for(s=0;s<n;s+=i){t.getRandomValues(o.subarray(s,s+Math.min(n-s,i)))}for(s=0;s<n;s++)e[s]=o[s];cleanup(o)}))}else if(true){t=n(6113);if(t&&t.randomBytes){e.setPRNG((function(e,n){var i,s=t.randomBytes(n);for(i=0;i<n;i++)e[i]=s[i];cleanup(s)}))}}})()})(true&&e.exports?e.exports:self.nacl=self.nacl||{})},5027:(e,t)=>{var n=void 0;var i=1e5;var s=function(){var e=Object.prototype.toString,t=Object.prototype.hasOwnProperty;return{Class:function(t){return e.call(t).replace(/^\[object *|\]$/g,"")},HasProperty:function(e,t){return t in e},HasOwnProperty:function(e,n){return t.call(e,n)},IsCallable:function(e){return typeof e==="function"},ToInt32:function(e){return e>>0},ToUint32:function(e){return e>>>0}}}();var o=Math.LN2,f=Math.abs,u=Math.floor,l=Math.log,h=Math.min,p=Math.pow,g=Math.round;function configureProperties(e){if(E&&_){var t=E(e),n;for(n=0;n<t.length;n+=1){_(e,t[n],{value:e[t[n]],writable:false,enumerable:false,configurable:false})}}}var _;if(Object.defineProperty&&function(){try{Object.defineProperty({},"x",{});return true}catch(e){return false}}()){_=Object.defineProperty}else{_=function(e,t,n){if(!e===Object(e))throw new TypeError("Object.defineProperty called on non-object");if(s.HasProperty(n,"get")&&Object.prototype.__defineGetter__){Object.prototype.__defineGetter__.call(e,t,n.get)}if(s.HasProperty(n,"set")&&Object.prototype.__defineSetter__){Object.prototype.__defineSetter__.call(e,t,n.set)}if(s.HasProperty(n,"value")){e[t]=n.value}return e}}var E=Object.getOwnPropertyNames||function(e){if(e!==Object(e))throw new TypeError("Object.getOwnPropertyNames called on non-object");var t=[],n;for(n in e){if(s.HasOwnProperty(e,n)){t.push(n)}}return t};function makeArrayAccessors(e){if(!_){return}if(e.length>i)throw new RangeError("Array too large for polyfill");function makeArrayAccessor(t){_(e,t,{get:function(){return e._getter(t)},set:function(n){e._setter(t,n)},enumerable:true,configurable:false})}var t;for(t=0;t<e.length;t+=1){makeArrayAccessor(t)}}function as_signed(e,t){var n=32-t;return e<<n>>n}function as_unsigned(e,t){var n=32-t;return e<<n>>>n}function packI8(e){return[e&255]}function unpackI8(e){return as_signed(e[0],8)}function packU8(e){return[e&255]}function unpackU8(e){return as_unsigned(e[0],8)}function packU8Clamped(e){e=g(Number(e));return[e<0?0:e>255?255:e&255]}function packI16(e){return[e>>8&255,e&255]}function unpackI16(e){return as_signed(e[0]<<8|e[1],16)}function packU16(e){return[e>>8&255,e&255]}function unpackU16(e){return as_unsigned(e[0]<<8|e[1],16)}function packI32(e){return[e>>24&255,e>>16&255,e>>8&255,e&255]}function unpackI32(e){return as_signed(e[0]<<24|e[1]<<16|e[2]<<8|e[3],32)}function packU32(e){return[e>>24&255,e>>16&255,e>>8&255,e&255]}function unpackU32(e){return as_unsigned(e[0]<<24|e[1]<<16|e[2]<<8|e[3],32)}function packIEEE754(e,t,n){var i=(1<<t-1)-1,s,g,_,E,y,b,w,I;function roundToEven(e){var t=u(e),n=e-t;if(n<.5)return t;if(n>.5)return t+1;return t%2?t+1:t}if(e!==e){g=(1<<t)-1;_=p(2,n-1);s=0}else if(e===Infinity||e===-Infinity){g=(1<<t)-1;_=0;s=e<0?1:0}else if(e===0){g=0;_=0;s=1/e===-Infinity?1:0}else{s=e<0;e=f(e);if(e>=p(2,1-i)){g=h(u(l(e)/o),1023);_=roundToEven(e/p(2,g)*p(2,n));if(_/p(2,n)>=2){g=g+1;_=1}if(g>i){g=(1<<t)-1;_=0}else{g=g+i;_=_-p(2,n)}}else{g=0;_=roundToEven(e/p(2,1-i-n))}}b=[];for(y=n;y;y-=1){b.push(_%2?1:0);_=u(_/2)}for(y=t;y;y-=1){b.push(g%2?1:0);g=u(g/2)}b.push(s?1:0);b.reverse();w=b.join("");I=[];while(w.length){I.push(parseInt(w.substring(0,8),2));w=w.substring(8)}return I}function unpackIEEE754(e,t,n){var i=[],s,o,f,u,l,h,g,_;for(s=e.length;s;s-=1){f=e[s-1];for(o=8;o;o-=1){i.push(f%2?1:0);f=f>>1}}i.reverse();u=i.join("");l=(1<<t-1)-1;h=parseInt(u.substring(0,1),2)?-1:1;g=parseInt(u.substring(1,1+t),2);_=parseInt(u.substring(1+t),2);if(g===(1<<t)-1){return _!==0?NaN:h*Infinity}else if(g>0){return h*p(2,g-l)*(1+_/p(2,n))}else if(_!==0){return h*p(2,-(l-1))*(_/p(2,n))}else{return h<0?-0:0}}function unpackF64(e){return unpackIEEE754(e,11,52)}function packF64(e){return packIEEE754(e,11,52)}function unpackF32(e){return unpackIEEE754(e,8,23)}function packF32(e){return packIEEE754(e,8,23)}(function(){var e=function ArrayBuffer(e){e=s.ToInt32(e);if(e<0)throw new RangeError("ArrayBuffer size is not a small enough positive integer");this.byteLength=e;this._bytes=[];this._bytes.length=e;var t;for(t=0;t<this.byteLength;t+=1){this._bytes[t]=0}configureProperties(this)};t.eT=t.eT||e;var i=function ArrayBufferView(){};function makeConstructor(t,o,f){var u;u=function(t,n,i){var o,f,l,h;if(!arguments.length||typeof arguments[0]==="number"){this.length=s.ToInt32(arguments[0]);if(i<0)throw new RangeError("ArrayBufferView size is not a small enough positive integer");this.byteLength=this.length*this.BYTES_PER_ELEMENT;this.buffer=new e(this.byteLength);this.byteOffset=0}else if(typeof arguments[0]==="object"&&arguments[0].constructor===u){o=arguments[0];this.length=o.length;this.byteLength=this.length*this.BYTES_PER_ELEMENT;this.buffer=new e(this.byteLength);this.byteOffset=0;for(l=0;l<this.length;l+=1){this._setter(l,o._getter(l))}}else if(typeof arguments[0]==="object"&&!(arguments[0]instanceof e||s.Class(arguments[0])==="ArrayBuffer")){f=arguments[0];this.length=s.ToUint32(f.length);this.byteLength=this.length*this.BYTES_PER_ELEMENT;this.buffer=new e(this.byteLength);this.byteOffset=0;for(l=0;l<this.length;l+=1){h=f[l];this._setter(l,Number(h))}}else if(typeof arguments[0]==="object"&&(arguments[0]instanceof e||s.Class(arguments[0])==="ArrayBuffer")){this.buffer=t;this.byteOffset=s.ToUint32(n);if(this.byteOffset>this.buffer.byteLength){throw new RangeError("byteOffset out of range")}if(this.byteOffset%this.BYTES_PER_ELEMENT){throw new RangeError("ArrayBuffer length minus the byteOffset is not a multiple of the element size.")}if(arguments.length<3){this.byteLength=this.buffer.byteLength-this.byteOffset;if(this.byteLength%this.BYTES_PER_ELEMENT){throw new RangeError("length of buffer minus byteOffset not a multiple of the element size")}this.length=this.byteLength/this.BYTES_PER_ELEMENT}else{this.length=s.ToUint32(i);this.byteLength=this.length*this.BYTES_PER_ELEMENT}if(this.byteOffset+this.byteLength>this.buffer.byteLength){throw new RangeError("byteOffset and length reference an area beyond the end of the buffer")}}else{throw new TypeError("Unexpected argument type(s)")}this.constructor=u;configureProperties(this);makeArrayAccessors(this)};u.prototype=new i;u.prototype.BYTES_PER_ELEMENT=t;u.prototype._pack=o;u.prototype._unpack=f;u.BYTES_PER_ELEMENT=t;u.prototype._getter=function(e){if(arguments.length<1)throw new SyntaxError("Not enough arguments");e=s.ToUint32(e);if(e>=this.length){return n}var t=[],i,o;for(i=0,o=this.byteOffset+e*this.BYTES_PER_ELEMENT;i<this.BYTES_PER_ELEMENT;i+=1,o+=1){t.push(this.buffer._bytes[o])}return this._unpack(t)};u.prototype.get=u.prototype._getter;u.prototype._setter=function(e,t){if(arguments.length<2)throw new SyntaxError("Not enough arguments");e=s.ToUint32(e);if(e>=this.length){return n}var i=this._pack(t),o,f;for(o=0,f=this.byteOffset+e*this.BYTES_PER_ELEMENT;o<this.BYTES_PER_ELEMENT;o+=1,f+=1){this.buffer._bytes[f]=i[o]}};u.prototype.set=function(e,t){if(arguments.length<1)throw new SyntaxError("Not enough arguments");var n,i,o,f,u,l,h,p,g,_;if(typeof arguments[0]==="object"&&arguments[0].constructor===this.constructor){n=arguments[0];o=s.ToUint32(arguments[1]);if(o+n.length>this.length){throw new RangeError("Offset plus length of array is out of range")}p=this.byteOffset+o*this.BYTES_PER_ELEMENT;g=n.length*this.BYTES_PER_ELEMENT;if(n.buffer===this.buffer){_=[];for(u=0,l=n.byteOffset;u<g;u+=1,l+=1){_[u]=n.buffer._bytes[l]}for(u=0,h=p;u<g;u+=1,h+=1){this.buffer._bytes[h]=_[u]}}else{for(u=0,l=n.byteOffset,h=p;u<g;u+=1,l+=1,h+=1){this.buffer._bytes[h]=n.buffer._bytes[l]}}}else if(typeof arguments[0]==="object"&&typeof arguments[0].length!=="undefined"){i=arguments[0];f=s.ToUint32(i.length);o=s.ToUint32(arguments[1]);if(o+f>this.length){throw new RangeError("Offset plus length of array is out of range")}for(u=0;u<f;u+=1){l=i[u];this._setter(o+u,Number(l))}}else{throw new TypeError("Unexpected argument type(s)")}};u.prototype.subarray=function(e,t){function clamp(e,t,n){return e<t?t:e>n?n:e}e=s.ToInt32(e);t=s.ToInt32(t);if(arguments.length<1){e=0}if(arguments.length<2){t=this.length}if(e<0){e=this.length+e}if(t<0){t=this.length+t}e=clamp(e,0,this.length);t=clamp(t,0,this.length);var n=t-e;if(n<0){n=0}return new this.constructor(this.buffer,this.byteOffset+e*this.BYTES_PER_ELEMENT,n)};return u}var o=makeConstructor(1,packI8,unpackI8);var f=makeConstructor(1,packU8,unpackU8);var u=makeConstructor(1,packU8Clamped,unpackU8);var l=makeConstructor(2,packI16,unpackI16);var h=makeConstructor(2,packU16,unpackU16);var p=makeConstructor(4,packI32,unpackI32);var g=makeConstructor(4,packU32,unpackU32);var _=makeConstructor(4,packF32,unpackF32);var E=makeConstructor(8,packF64,unpackF64);t.iq=t.iq||o;t.U2=t.U2||f;t.we=t.we||u;t.M2=t.M2||l;t.HA=t.HA||h;t.ZV=t.ZV||p;t._R=t._R||g;t.$L=t.$L||_;t.I=t.I||E})();(function(){function r(e,t){return s.IsCallable(e.get)?e.get(t):e[t]}var e=function(){var e=new t.HA([4660]),n=new t.U2(e.buffer);return r(n,0)===18}();var n=function DataView(e,n,i){if(arguments.length===0){e=new t.eT(0)}else if(!(e instanceof t.eT||s.Class(e)==="ArrayBuffer")){throw new TypeError("TypeError")}this.buffer=e||new t.eT(0);this.byteOffset=s.ToUint32(n);if(this.byteOffset>this.buffer.byteLength){throw new RangeError("byteOffset out of range")}if(arguments.length<3){this.byteLength=this.buffer.byteLength-this.byteOffset}else{this.byteLength=s.ToUint32(i)}if(this.byteOffset+this.byteLength>this.buffer.byteLength){throw new RangeError("byteOffset and length reference an area beyond the end of the buffer")}configureProperties(this)};function makeGetter(n){return function(i,o){i=s.ToUint32(i);if(i+n.BYTES_PER_ELEMENT>this.byteLength){throw new RangeError("Array index out of range")}i+=this.byteOffset;var f=new t.U2(this.buffer,i,n.BYTES_PER_ELEMENT),u=[],l;for(l=0;l<n.BYTES_PER_ELEMENT;l+=1){u.push(r(f,l))}if(Boolean(o)===Boolean(e)){u.reverse()}return r(new n(new t.U2(u).buffer),0)}}n.prototype.getUint8=makeGetter(t.U2);n.prototype.getInt8=makeGetter(t.iq);n.prototype.getUint16=makeGetter(t.HA);n.prototype.getInt16=makeGetter(t.M2);n.prototype.getUint32=makeGetter(t._R);n.prototype.getInt32=makeGetter(t.ZV);n.prototype.getFloat32=makeGetter(t.$L);n.prototype.getFloat64=makeGetter(t.I);function makeSetter(n){return function(i,o,f){i=s.ToUint32(i);if(i+n.BYTES_PER_ELEMENT>this.byteLength){throw new RangeError("Array index out of range")}var u=new n([o]),l=new t.U2(u.buffer),h=[],p,g;for(p=0;p<n.BYTES_PER_ELEMENT;p+=1){h.push(r(l,p))}if(Boolean(f)===Boolean(e)){h.reverse()}g=new t.U2(this.buffer,i,n.BYTES_PER_ELEMENT);g.set(h)}}n.prototype.setUint8=makeSetter(t.U2);n.prototype.setInt8=makeSetter(t.iq);n.prototype.setUint16=makeSetter(t.HA);n.prototype.setInt16=makeSetter(t.M2);n.prototype.setUint32=makeSetter(t._R);n.prototype.setInt32=makeSetter(t.ZV);n.prototype.setFloat32=makeSetter(t.$L);n.prototype.setFloat64=makeSetter(t.I);t.VO=t.VO||n})()},7127:(e,t,n)=>{e.exports=n(3837).deprecate},5840:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});Object.defineProperty(t,"v1",{enumerable:true,get:function(){return i.default}});Object.defineProperty(t,"v3",{enumerable:true,get:function(){return s.default}});Object.defineProperty(t,"v4",{enumerable:true,get:function(){return o.default}});Object.defineProperty(t,"v5",{enumerable:true,get:function(){return f.default}});Object.defineProperty(t,"NIL",{enumerable:true,get:function(){return u.default}});Object.defineProperty(t,"version",{enumerable:true,get:function(){return l.default}});Object.defineProperty(t,"validate",{enumerable:true,get:function(){return h.default}});Object.defineProperty(t,"stringify",{enumerable:true,get:function(){return p.default}});Object.defineProperty(t,"parse",{enumerable:true,get:function(){return g.default}});var i=_interopRequireDefault(n(8628));var s=_interopRequireDefault(n(6409));var o=_interopRequireDefault(n(5122));var f=_interopRequireDefault(n(9120));var u=_interopRequireDefault(n(5332));var l=_interopRequireDefault(n(1595));var h=_interopRequireDefault(n(6900));var p=_interopRequireDefault(n(8950));var g=_interopRequireDefault(n(2746));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}},4569:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=void 0;var i=_interopRequireDefault(n(6113));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function md5(e){if(Array.isArray(e)){e=Buffer.from(e)}else if(typeof e==="string"){e=Buffer.from(e,"utf8")}return i.default.createHash("md5").update(e).digest()}var s=md5;t["default"]=s},5332:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=void 0;var n="00000000-0000-0000-0000-000000000000";t["default"]=n},2746:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=void 0;var i=_interopRequireDefault(n(6900));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function parse(e){if(!(0,i.default)(e)){throw TypeError("Invalid UUID")}let t;const n=new Uint8Array(16);n[0]=(t=parseInt(e.slice(0,8),16))>>>24;n[1]=t>>>16&255;n[2]=t>>>8&255;n[3]=t&255;n[4]=(t=parseInt(e.slice(9,13),16))>>>8;n[5]=t&255;n[6]=(t=parseInt(e.slice(14,18),16))>>>8;n[7]=t&255;n[8]=(t=parseInt(e.slice(19,23),16))>>>8;n[9]=t&255;n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255;n[11]=t/4294967296&255;n[12]=t>>>24&255;n[13]=t>>>16&255;n[14]=t>>>8&255;n[15]=t&255;return n}var s=parse;t["default"]=s},814:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=void 0;var n=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;t["default"]=n},807:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=rng;var i=_interopRequireDefault(n(6113));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const s=new Uint8Array(256);let o=s.length;function rng(){if(o>s.length-16){i.default.randomFillSync(s);o=0}return s.slice(o,o+=16)}},5274:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=void 0;var i=_interopRequireDefault(n(6113));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function sha1(e){if(Array.isArray(e)){e=Buffer.from(e)}else if(typeof e==="string"){e=Buffer.from(e,"utf8")}return i.default.createHash("sha1").update(e).digest()}var s=sha1;t["default"]=s},8950:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=void 0;var i=_interopRequireDefault(n(6900));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const s=[];for(let e=0;e<256;++e){s.push((e+256).toString(16).substr(1))}function stringify(e,t=0){const n=(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase();if(!(0,i.default)(n)){throw TypeError("Stringified UUID is invalid")}return n}var o=stringify;t["default"]=o},8628:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=void 0;var i=_interopRequireDefault(n(807));var s=_interopRequireDefault(n(8950));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}let o;let f;let u=0;let l=0;function v1(e,t,n){let h=t&&n||0;const p=t||new Array(16);e=e||{};let g=e.node||o;let _=e.clockseq!==undefined?e.clockseq:f;if(g==null||_==null){const t=e.random||(e.rng||i.default)();if(g==null){g=o=[t[0]|1,t[1],t[2],t[3],t[4],t[5]]}if(_==null){_=f=(t[6]<<8|t[7])&16383}}let E=e.msecs!==undefined?e.msecs:Date.now();let y=e.nsecs!==undefined?e.nsecs:l+1;const b=E-u+(y-l)/1e4;if(b<0&&e.clockseq===undefined){_=_+1&16383}if((b<0||E>u)&&e.nsecs===undefined){y=0}if(y>=1e4){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}u=E;l=y;f=_;E+=122192928e5;const w=((E&268435455)*1e4+y)%4294967296;p[h++]=w>>>24&255;p[h++]=w>>>16&255;p[h++]=w>>>8&255;p[h++]=w&255;const I=E/4294967296*1e4&268435455;p[h++]=I>>>8&255;p[h++]=I&255;p[h++]=I>>>24&15|16;p[h++]=I>>>16&255;p[h++]=_>>>8|128;p[h++]=_&255;for(let e=0;e<6;++e){p[h+e]=g[e]}return t||(0,s.default)(p)}var h=v1;t["default"]=h},6409:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=void 0;var i=_interopRequireDefault(n(5998));var s=_interopRequireDefault(n(4569));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const o=(0,i.default)("v3",48,s.default);var f=o;t["default"]=f},5998:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=_default;t.URL=t.DNS=void 0;var i=_interopRequireDefault(n(8950));var s=_interopRequireDefault(n(2746));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function stringToBytes(e){e=unescape(encodeURIComponent(e));const t=[];for(let n=0;n<e.length;++n){t.push(e.charCodeAt(n))}return t}const o="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=o;const f="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=f;function _default(e,t,n){function generateUUID(e,o,f,u){if(typeof e==="string"){e=stringToBytes(e)}if(typeof o==="string"){o=(0,s.default)(o)}if(o.length!==16){throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)")}let l=new Uint8Array(16+e.length);l.set(o);l.set(e,o.length);l=n(l);l[6]=l[6]&15|t;l[8]=l[8]&63|128;if(f){u=u||0;for(let e=0;e<16;++e){f[u+e]=l[e]}return f}return(0,i.default)(l)}try{generateUUID.name=e}catch(e){}generateUUID.DNS=o;generateUUID.URL=f;return generateUUID}},5122:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=void 0;var i=_interopRequireDefault(n(807));var s=_interopRequireDefault(n(8950));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function v4(e,t,n){e=e||{};const o=e.random||(e.rng||i.default)();o[6]=o[6]&15|64;o[8]=o[8]&63|128;if(t){n=n||0;for(let e=0;e<16;++e){t[n+e]=o[e]}return t}return(0,s.default)(o)}var o=v4;t["default"]=o},9120:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=void 0;var i=_interopRequireDefault(n(5998));var s=_interopRequireDefault(n(5274));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const o=(0,i.default)("v5",80,s.default);var f=o;t["default"]=f},6900:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=void 0;var i=_interopRequireDefault(n(814));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function validate(e){return typeof e==="string"&&i.default.test(e)}var s=validate;t["default"]=s},1595:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=void 0;var i=_interopRequireDefault(n(6900));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function version(e){if(!(0,i.default)(e)){throw TypeError("Invalid UUID")}return parseInt(e.substr(14,1),16)}var s=version;t["default"]=s},5185:e=>{class Node{constructor(e){this.value=e;this.next=undefined}}class Queue{constructor(){this.clear()}enqueue(e){const t=new Node(e);if(this._head){this._tail.next=t;this._tail=t}else{this._head=t;this._tail=t}this._size++}dequeue(){const e=this._head;if(!e){return}this._head=this._head.next;this._size--;return e.value}clear(){this._head=undefined;this._tail=undefined;this._size=0}get size(){return this._size}*[Symbol.iterator](){let e=this._head;while(e){yield e.value;e=e.next}}}e.exports=Queue},4240:(e,t,n)=>{e.exports=require(n.ab+"build/Release/cpufeatures.node")},9041:(e,t,n)=>{e.exports=require(n.ab+"lib/protocol/crypto/build/Release/sshcrypto.node")},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},1953:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.Minimatch=t.match=t.makeRe=t.braceExpand=t.defaults=t.filter=t.GLOBSTAR=t.sep=t.minimatch=void 0;const minimatch=(e,t,n={})=>{assertValidPattern(t);if(!n.nocomment&&t.charAt(0)==="#"){return false}return new Minimatch(t,n).match(e)};t.minimatch=minimatch;t["default"]=t.minimatch;const s=typeof process==="object"&&process?typeof process.env==="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix";const o=s==="win32";const f=o?{sep:"\\"}:{sep:"/"};t.sep=f.sep;t.minimatch.sep=t.sep;t.GLOBSTAR=Symbol("globstar **");t.minimatch.GLOBSTAR=t.GLOBSTAR;const u=i(n(3717));const l={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}};const h="[^/]";const p=h+"*?";const g="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?";const _="(?:(?!(?:\\/|^)\\.).)*?";const charSet=e=>e.split("").reduce(((e,t)=>{e[t]=true;return e}),{});const E=charSet("().*{}+?[]^$\\!");const y=charSet("[.(");const filter=(e,n={})=>i=>(0,t.minimatch)(i,e,n);t.filter=filter;t.minimatch.filter=t.filter;const ext=(e,t={})=>Object.assign({},e,t);const defaults=e=>{if(!e||typeof e!=="object"||!Object.keys(e).length){return t.minimatch}const n=t.minimatch;const m=(t,i,s={})=>n(t,i,ext(e,s));return Object.assign(m,{Minimatch:class Minimatch extends n.Minimatch{constructor(t,n={}){super(t,ext(e,n))}static defaults(t){return n.defaults(ext(e,t)).Minimatch}},filter:(t,i={})=>n.filter(t,ext(e,i)),defaults:t=>n.defaults(ext(e,t)),makeRe:(t,i={})=>n.makeRe(t,ext(e,i)),braceExpand:(t,i={})=>n.braceExpand(t,ext(e,i)),match:(t,i,s={})=>n.match(t,i,ext(e,s)),sep:n.sep,GLOBSTAR:t.GLOBSTAR})};t.defaults=defaults;t.minimatch.defaults=t.defaults;const braceExpand=(e,t={})=>{assertValidPattern(e);if(t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)){return[e]}return(0,u.default)(e)};t.braceExpand=braceExpand;t.minimatch.braceExpand=t.braceExpand;const b=1024*64;const assertValidPattern=e=>{if(typeof e!=="string"){throw new TypeError("invalid pattern")}if(e.length>b){throw new TypeError("pattern is too long")}};const w=Symbol("subparse");const makeRe=(e,t={})=>new Minimatch(e,t).makeRe();t.makeRe=makeRe;t.minimatch.makeRe=t.makeRe;const match=(e,t,n={})=>{const i=new Minimatch(t,n);e=e.filter((e=>i.match(e)));if(i.options.nonull&&!e.length){e.push(t)}return e};t.match=match;t.minimatch.match=t.match;const globUnescape=e=>e.replace(/\\(.)/g,"$1");const charUnescape=e=>e.replace(/\\([^-\]])/g,"$1");const regExpEscape=e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");const braExpEscape=e=>e.replace(/[[\]\\]/g,"\\$&");class Minimatch{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;regexp;constructor(e,t={}){assertValidPattern(e);t=t||{};this.options=t;this.pattern=e;this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===false;if(this.windowsPathsNoEscape){this.pattern=this.pattern.replace(/\\/g,"/")}this.preserveMultipleSlashes=!!t.preserveMultipleSlashes;this.regexp=null;this.negate=false;this.nonegate=!!t.nonegate;this.comment=false;this.empty=false;this.partial=!!t.partial;this.globSet=[];this.globParts=[];this.set=[];this.make()}debug(...e){}make(){const e=this.pattern;const t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=true;return}if(!e){this.empty=true;return}this.parseNegate();this.globSet=this.braceExpand();if(t.debug){this.debug=(...e)=>console.error(...e)}this.debug(this.pattern,this.globSet);const n=this.globSet.map((e=>this.slashSplit(e)));this.globParts=this.options.noglobstar?n:n.map((e=>e.reduce(((e,t)=>{if(t!=="**"||e[e.length-1]!=="**"){e.push(t)}return e}),[])));this.debug(this.pattern,this.globParts);let i=this.globParts.map(((e,t,n)=>e.map((e=>this.parse(e)))));this.debug(this.pattern,i);this.set=i.filter((e=>e.indexOf(false)===-1));if(o){for(let e=0;e<this.set.length;e++){const t=this.set[e];if(t[0]===""&&t[1]===""&&this.globParts[e][2]==="?"&&typeof t[3]==="string"&&/^[a-z]:$/i.test(t[3])){t[2]="?"}}}this.debug(this.pattern,this.set)}parseNegate(){if(this.nonegate)return;const e=this.pattern;let t=false;let n=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++){t=!t;n++}if(n)this.pattern=e.slice(n);this.negate=t}matchOne(e,n,i=false){const s=this.options;if(o){const t=e[0]===""&&e[1]===""&&e[2]==="?"&&typeof e[3]==="string"&&/^[a-z]:$/i.test(e[3]);const i=n[0]===""&&n[1]===""&&n[2]==="?"&&typeof n[3]==="string"&&/^[a-z]:$/i.test(n[3]);if(t&&i){const t=e[3];const i=n[3];if(t.toLowerCase()===i.toLowerCase()){e[3]=i}}else if(i&&typeof e[0]==="string"){const t=n[3];const i=e[0];if(t.toLowerCase()===i.toLowerCase()){n[3]=i;n=n.slice(3)}}else if(t&&typeof n[0]==="string"){const t=e[3];if(t.toLowerCase()===n[0].toLowerCase()){n[0]=t;e=e.slice(3)}}}this.debug("matchOne",this,{file:e,pattern:n});this.debug("matchOne",e.length,n.length);for(var f=0,u=0,l=e.length,h=n.length;f<l&&u<h;f++,u++){this.debug("matchOne loop");var p=n[u];var g=e[f];this.debug(n,p,g);if(p===false){return false}if(p===t.GLOBSTAR){this.debug("GLOBSTAR",[n,p,g]);var _=f;var E=u+1;if(E===h){this.debug("** at the end");for(;f<l;f++){if(e[f]==="."||e[f]===".."||!s.dot&&e[f].charAt(0)===".")return false}return true}while(_<l){var y=e[_];this.debug("\nglobstar while",e,_,n,E,y);if(this.matchOne(e.slice(_),n.slice(E),i)){this.debug("globstar found match!",_,l,y);return true}else{if(y==="."||y===".."||!s.dot&&y.charAt(0)==="."){this.debug("dot detected!",e,_,n,E);break}this.debug("globstar swallow a segment, and continue");_++}}if(i){this.debug("\n>>> no match, partial?",e,_,n,E);if(_===l){return true}}return false}let o;if(typeof p==="string"){o=g===p;this.debug("string match",p,g,o)}else{o=p.test(g);this.debug("pattern match",p,g,o)}if(!o)return false}if(f===l&&u===h){return true}else if(f===l){return i}else if(u===h){return f===l-1&&e[f]===""}else{throw new Error("wtf?")}}braceExpand(){return(0,t.braceExpand)(this.pattern,this.options)}parse(e,n){assertValidPattern(e);const i=this.options;if(e==="**"){if(!i.noglobstar)return t.GLOBSTAR;else e="*"}if(e==="")return"";let s="";let o=false;let f=false;const u=[];const g=[];let _=false;let b=false;let I=-1;let C=-1;let v;let k;let R;let B=e.charAt(0)===".";let T=i.dot||B;const patternStart=()=>B?"":T?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)";const subPatternStart=e=>e.charAt(0)==="."?"":i.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)";const clearStateChar=()=>{if(_){switch(_){case"*":s+=p;o=true;break;case"?":s+=h;o=true;break;default:s+="\\"+_;break}this.debug("clearStateChar %j %j",_,s);_=false}};for(let t=0,n;t<e.length&&(n=e.charAt(t));t++){this.debug("%s\t%s %s %j",e,t,s,n);if(f){if(n==="/"){return false}if(E[n]){s+="\\"}s+=n;f=false;continue}switch(n){case"/":{return false}case"\\":if(b&&e.charAt(t+1)==="-"){s+=n;continue}clearStateChar();f=true;continue;case"?":case"*":case"+":case"@":case"!":this.debug("%s\t%s %s %j <-- stateChar",e,t,s,n);if(b){this.debug("  in class");if(n==="!"&&t===C+1)n="^";s+=n;continue}this.debug("call clearStateChar %j",_);clearStateChar();_=n;if(i.noext)clearStateChar();continue;case"(":{if(b){s+="(";continue}if(!_){s+="\\(";continue}const n={type:_,start:t-1,reStart:s.length,open:l[_].open,close:l[_].close};this.debug(this.pattern,"\t",n);u.push(n);s+=n.open;if(n.start===0&&n.type!=="!"){B=true;s+=subPatternStart(e.slice(t+1))}this.debug("plType %j %j",_,s);_=false;continue}case")":{const e=u[u.length-1];if(b||!e){s+="\\)";continue}u.pop();clearStateChar();o=true;k=e;s+=k.close;if(k.type==="!"){g.push(Object.assign(k,{reEnd:s.length}))}continue}case"|":{const n=u[u.length-1];if(b||!n){s+="\\|";continue}clearStateChar();s+="|";if(n.start===0&&n.type!=="!"){B=true;s+=subPatternStart(e.slice(t+1))}continue}case"[":clearStateChar();if(b){s+="\\"+n;continue}b=true;C=t;I=s.length;s+=n;continue;case"]":if(t===C+1||!b){s+="\\"+n;continue}v=e.substring(C+1,t);try{RegExp("["+braExpEscape(charUnescape(v))+"]");s+=n}catch(e){s=s.substring(0,I)+"(?:$.)"}o=true;b=false;continue;default:clearStateChar();if(E[n]&&!(n==="^"&&b)){s+="\\"}s+=n;break}}if(b){v=e.slice(C+1);R=this.parse(v,w);s=s.substring(0,I)+"\\["+R[0];o=o||R[1]}for(k=u.pop();k;k=u.pop()){let e;e=s.slice(k.reStart+k.open.length);this.debug(this.pattern,"setting tail",s,k);e=e.replace(/((?:\\{2}){0,64})(\\?)\|/g,((e,t,n)=>{if(!n){n="\\"}return t+t+n+"|"}));this.debug("tail=%j\n   %s",e,e,k,s);const t=k.type==="*"?p:k.type==="?"?h:"\\"+k.type;o=true;s=s.slice(0,k.reStart)+t+"\\("+e}clearStateChar();if(f){s+="\\\\"}const O=y[s.charAt(0)];for(let e=g.length-1;e>-1;e--){const t=g[e];const i=s.slice(0,t.reStart);const o=s.slice(t.reStart,t.reEnd-8);let f=s.slice(t.reEnd);const u=s.slice(t.reEnd-8,t.reEnd)+f;const l=i.split(")").length;const h=i.split("(").length-l;let p=f;for(let e=0;e<h;e++){p=p.replace(/\)[+*?]?/,"")}f=p;const _=f===""&&n!==w?"(?:$|\\/)":"";s=i+o+f+_+u}if(s!==""&&o){s="(?=.)"+s}if(O){s=patternStart()+s}if(n===w){return[s,o]}if(i.nocase&&!o){o=e.toUpperCase()!==e.toLowerCase()}if(!o){return globUnescape(e)}const P=i.nocase?"i":"";try{return Object.assign(new RegExp("^"+s+"$",P),{_glob:e,_src:s})}catch(e){this.debug("invalid regexp",e);return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===false)return this.regexp;const e=this.set;if(!e.length){this.regexp=false;return this.regexp}const n=this.options;const i=n.noglobstar?p:n.dot?g:_;const s=n.nocase?"i":"";let o=e.map((e=>{const n=e.map((e=>typeof e==="string"?regExpEscape(e):e===t.GLOBSTAR?t.GLOBSTAR:e._src));n.forEach(((e,s)=>{const o=n[s+1];const f=n[s-1];if(e!==t.GLOBSTAR||f===t.GLOBSTAR){return}if(f===undefined){if(o!==undefined&&o!==t.GLOBSTAR){n[s+1]="(?:\\/|"+i+"\\/)?"+o}else{n[s]=i}}else if(o===undefined){n[s-1]=f+"(?:\\/|"+i+")?"}else if(o!==t.GLOBSTAR){n[s-1]=f+"(?:\\/|\\/"+i+"\\/)"+o;n[s+1]=t.GLOBSTAR}}));return n.filter((e=>e!==t.GLOBSTAR)).join("/")})).join("|");o="^(?:"+o+")$";if(this.negate)o="^(?!"+o+").*$";try{this.regexp=new RegExp(o,s)}catch(e){this.regexp=false}return this.regexp}slashSplit(e){if(this.preserveMultipleSlashes){return e.split("/")}else if(o&&/^\/\/[^\/]+/.test(e)){return["",...e.split(/\/+/)]}else{return e.split(/\/+/)}}match(e,t=this.partial){this.debug("match",e,this.pattern);if(this.comment){return false}if(this.empty){return e===""}if(e==="/"&&t){return true}const n=this.options;if(f.sep!=="/"){e=e.split(f.sep).join("/")}const i=this.slashSplit(e);this.debug(this.pattern,"split",i);const s=this.set;this.debug(this.pattern,"set",s);let o=i[i.length-1];if(!o){for(let e=i.length-2;!o&&e>=0;e--){o=i[e]}}for(let e=0;e<s.length;e++){const f=s[e];let u=i;if(n.matchBase&&f.length===1){u=[o]}const l=this.matchOne(u,f,t);if(l){if(n.flipNegate){return true}return!this.negate}}if(n.flipNegate){return false}return this.negate}static defaults(e){return t.minimatch.defaults(e).Minimatch}}t.Minimatch=Minimatch;t.minimatch.Minimatch=Minimatch},6674:e=>{"use strict";e.exports={i8:"1.11.0"}}};var t={};function __nccwpck_require__(n){var i=t[n];if(i!==undefined){return i.exports}var s=t[n]={exports:{}};var o=true;try{e[n].call(s.exports,s,s.exports,__nccwpck_require__);o=false}finally{if(o)delete t[n]}return s.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var n={};(()=>{"use strict";var e=n;Object.defineProperty(e,"__esModule",{value:true});const t=__nccwpck_require__(9538);const i=__nccwpck_require__(7551);(0,t.main)(new i)})();module.exports=n})();